(self.webpackChunkh2oc=self.webpackChunkh2oc||[]).push([[3721],{93721:(e,t,i)=>{var r,a;r=[i(58797),i(11285),i(74637),i(73462),i(67059),i(26475),i(99752),i(4037),i(51916),i(18377),i(9720),i(69788),i(28187),i(75885),i(82849),i(46351),i(40934),i(46685)],void 0===(a=function(e,t,i,r,a,n,s,o,p,l,u,c,h,d,y,m,g,v){"use strict";let w=function(t){function i(){var e;return(e=t.apply(this,arguments)||this)._exportImageVersion=-1,e}e._inheritsLoose(i,t);var r=i.prototype;return r.hitTest=function(e,t){return this.suspended||!this.subview?u.resolve(null):this.subview.hitTest(e,t)},r.update=function(e){var t;null==(t=this.subview)||t.update(e)},r.attach=function(){this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.handles.add([c.init(this,"layer.exportImageServiceParameters.version",(e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())})),this.watch("timeExtent",(()=>{this.subview.timeExtent=this.timeExtent,this.requestUpdate()})),this.layer.on("redraw",(()=>this.subview.redraw())),c.watch(this.layer,"renderer",(()=>this._setSubView()))],"imagerylayerview-update")},r.detach=function(){this.layer.decreaseRasterJobHandlerUsage(),this.subview.destroy(),this.handles.remove("imagerylayerview-update"),this._exportImageVersion=-1},r.moveStart=function(){},r.viewChange=function(){},r.moveEnd=function(){this.requestUpdate()},r.doRefresh=async function(){this.requestUpdate()},r.isUpdating=function(){return!this.subview||this.subview.isUpdating()},r._setSubView=function(){var e;let t="Imagery";var i,r;"vector-field"===(null==(e=this.layer.renderer)?void 0:e.type)&&"lerc"===this.layer.format&&(t="Graphics"),this.subview&&this.subview.type===t||(null==(i=this.subview)||i.uninstall(this.container),null==(r=this.subview)||r.destroy(),this.subview="Imagery"===t?new v({layer:this.layer,view:this.view}):new g({layer:this.layer,view:this.view}),this.subview.attach(),this.subview.install(this.container)),this.requestUpdate()},e._createClass(i,[{key:"pixelData",get:function(){return this.updating?null:this.subview.getPixelData()}},{key:"updating",get:function(){return!(this.subview&&!this.subview.updating)}}]),i}(y.ImageryLayerView(h.RefreshableLayerView(m.LayerView2DMixin(d))));return t.__decorate([n.property({dependsOn:["updating"]})],w.prototype,"pixelData",null),t.__decorate([n.property({readOnly:!0,dependsOn:["subview.updating"]})],w.prototype,"updating",null),t.__decorate([n.property()],w.prototype,"subview",void 0),w=t.__decorate([s.subclass("esri.views.2d.layers.ImageryLayerView2D")],w),w}.apply(t,r))||(e.exports=a)},40934:(e,t,i)=>{var r,a;r=[i(58797),i(11285),i(74637),i(73462),i(67059),i(26475),i(12187),i(99752),i(4037),i(51916),i(18377),i(9720),i(12997),i(90920),i(31099),i(56998),i(75885),i(57042),i(54186),i(46351)],void 0===(a=function(e,t,i,r,a,n,s,o,p,l,u,c,h,d,y,m,g,v,w,f){"use strict";const x=r.getLogger("esri.views.2d.layers.imagery.ImageryGraphicsView2D");let _=function(t){function i(){var e;return(e=t.apply(this,arguments)||this).container=new v.Container,e._graphicsView=null,e.type="Graphics",e._graphics=new m.default,e._updateGraphics=c.debounce((async(t,i)=>{if(!t.stationary)return;const r=t.state,a=new h({xmin:r.extent.xmin,ymin:r.extent.ymin,xmax:r.extent.xmax,ymax:r.extent.ymax,spatialReference:r.spatialReference}),n=t.state.size[0],s=t.state.size[1],o={};o.timeExtent=e.timeExtent,o.requestAsImageElement=!1,o.signal=i;const p=e._getVectorFieldExportParams({extent:a,width:n,height:s}),l=await e.layer.fetchImage(p.extent,p.width,p.height,o),u=e.layer.renderer;if("vector-field"===u.type){e._pixelData={extent:p.extent,pixelBlock:l.pixelData.pixelBlock};const i=await u.getGraphicsFromPixelData(l.pixelData,"vector-uv"===e.layer.rasterInfo.dataType);e._graphicsView.update(t),await c.after(0).then((()=>{e._graphics.set("items",i)}))}})),e}e._inheritsLoose(i,t);var r=i.prototype;return r.update=function(e){this._updateGraphics(e).catch((e=>{c.isAbortError(e)||x.error(e)}))},r.hitTest=function(e,t){if(this.suspended)return c.resolve(null);const i=this.view.toMap(d.createScreenPoint(e,t));return c.resolve(new y({attributes:{},geometry:i,layer:this.layer}))},r.attach=function(){this._graphicsView=new w({view:this.view,graphics:this._graphics,requestUpdateCallback:()=>this.requestUpdate()})},r.detach=function(){this._graphics.destroy(),this._graphicsView.destroy(),this.container.removeChild(this._graphicsView.container),this._graphicsView=null},r.moveStart=function(){},r.viewChange=function(){},r.moveEnd=function(){},r.install=function(e){this.container.addChild(this._graphicsView.container),e.addChild(this.container)},r.uninstall=function(e){this.container.removeChild(this._graphicsView.container),e.removeChild(this.container)},r.isUpdating=function(){return this._graphicsView.updating||this.updateRequested},r.getPixelData=function(){return this.updating?null:this._pixelData},r.redraw=function(){},r._getVectorFieldExportParams=function(e){var t,i;let{extent:r,width:a,height:n}=e;const s=this.layer,o=null==(t=s.fullExtent)?void 0:t.xmin,p=null==(i=s.fullExtent)?void 0:i.ymax;let l;"vector-field"===s.renderer.type&&(l=s.renderer.symbolTileSize),l=Math.max(l||0,30),a=Math.ceil(a*(1/l)),n=Math.ceil(n*(1/l));const u=(r.xmax-r.xmin)/a,c=(r.ymax-r.ymin)/n;return r.xmin=o+Math.floor((r.xmin-o)/u)*u,r.xmax=o+Math.ceil((r.xmax-o)/u)*u,r.ymin=p+Math.floor((r.ymin-p)/c)*c,r.ymax=p+Math.ceil((r.ymax-p)/c)*c,{extent:r,width:a,height:n}},e._createClass(i,[{key:"updating",get:function(){var e;return null==(e=this._graphicsView)?void 0:e.updating}}]),i}(f.LayerView2DMixin(g));return t.__decorate([n.property()],_.prototype,"container",void 0),t.__decorate([n.property()],_.prototype,"layer",void 0),t.__decorate([n.property()],_.prototype,"timeExtent",void 0),t.__decorate([n.property({dependsOn:["_graphicsView.updating"]})],_.prototype,"updating",null),t.__decorate([n.property()],_.prototype,"_graphicsView",void 0),t.__decorate([s.enumeration({graphics:"Graphics"})],_.prototype,"type",void 0),_=t.__decorate([o.subclass("esri.views.2d.layers.imagery.ImageryGraphicsView2D")],_),_}.apply(t,r))||(e.exports=a)},46685:(e,t,i)=>{var r,a;r=[i(58797),i(11285),i(74637),i(73462),i(67059),i(26475),i(12187),i(99752),i(4037),i(51916),i(18377),i(9720),i(90920),i(31099),i(56117),i(75885),i(57042),i(31561),i(19048),i(46351),i(58329)],void 0===(a=function(e,t,i,r,a,n,s,o,p,l,u,c,h,d,y,m,g,v,w,f,x){"use strict";const _=r.getLogger("esri.views.2d.layers.imagery.ImageryView2D");let b=function(t){function i(){var e;return(e=t.apply(this,arguments)||this).container=new g.Container,e.type="Imagery",e._bitmapView=null,e}e._inheritsLoose(i,t);var r=i.prototype;return r.update=function(e){this.strategy.update(e).catch((e=>{c.isAbortError(e)||_.error(e)}))},r.detach=function(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren()},r.hitTest=function(e,t){if(this.suspended)return c.resolve(null);const i=this.view.toMap(h.createScreenPoint(e,t));return c.resolve(new d({attributes:{},geometry:i,layer:this.layer}))},r.attach=function(){const e=this.layer.version>=10,t=this.layer.version>=10.1?this.layer.imageMaxHeight:2048,i=this.layer.version>=10.1?this.layer.imageMaxWidth:2048;this._bitmapView=new w.BitmapContainer,this.strategy=new x({container:this._bitmapView,imageNormalizationSupported:e,imageMaxHeight:t,imageMaxWidth:i,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()})},r.moveStart=function(){},r.viewChange=function(){},r.moveEnd=function(){},r.install=function(e){this.container.addChild(this._bitmapView),e.addChild(this.container)},r.uninstall=function(e){this.container.removeChild(this._bitmapView),e.removeChild(this.container)},r.redraw=function(){this.strategy.updateExports((e=>{e.source instanceof HTMLImageElement?e.requestRender():this.layer.applyRenderer({pixelBlock:e.source.pixelBlock}).then((t=>{const i=e.source;i.pixelBlock=t.pixelBlock,i.filter=e=>this.layer.applyFilter(e),this.container.requestRender()}))}))},r.isUpdating=function(){return this.strategy.updating||this.updateRequested},r.getPixelData=function(){if(this.updating)return null;const e=this.strategy.container.children;if(1===e.length&&e[0].source)return{extent:e[0].source.extent,pixelBlock:e[0].source.originalPixelBlock};if(e.length>1){const t=this.view.extent,i=e.map((e=>e.source)).filter((e=>e.extent&&e.extent.intersects(t))).map((e=>({extent:e.extent,pixelBlock:e.originalPixelBlock}))),r=y.mosaicPixelData(i,t);return r?{extent:r.extent,pixelBlock:r.pixelBlock}:null}return null},r._fetchImage=function(e,t,i,r){return(r=r||{}).timeExtent=this.timeExtent,r.requestAsImageElement=!0,this.layer.fetchImage(e,t,i,r).then((e=>e.imageElement?e.imageElement:this.layer.applyRenderer(e.pixelData,{signal:r.signal}).then((t=>{const i=new v(t.pixelBlock,t.extent.clone(),e.pixelData.pixelBlock);return i.filter=e=>this.layer.applyFilter(e),i}))))},e._createClass(i,[{key:"updating",get:function(){var e;return null==(e=this.strategy)?void 0:e.updating}}]),i}(f.LayerView2DMixin(m));return t.__decorate([n.property()],b.prototype,"container",void 0),t.__decorate([n.property()],b.prototype,"layer",void 0),t.__decorate([n.property()],b.prototype,"strategy",void 0),t.__decorate([n.property()],b.prototype,"timeExtent",void 0),t.__decorate([n.property({dependsOn:["strategy.updating"]})],b.prototype,"updating",null),t.__decorate([s.enumeration({imagery:"Imagery"})],b.prototype,"type",void 0),b=t.__decorate([o.subclass("esri.views.2d.layers.imagery.ImageryView2D")],b),b}.apply(t,r))||(e.exports=a)},82849:(e,t,i)=>{var r,a;r=[t,i(58797),i(11285),i(74637),i(3718),i(73462),i(67059),i(26475),i(99752),i(49359),i(4037),i(51916),i(18377),i(9720),i(35558),i(8336),i(909),i(28575)],void 0===(a=function(e,i,r,a,n,s,o,p,l,u,c,h,d,y,m,g,v,w){"use strict";t.ImageryLayerView=e=>{let t=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).view=null,t}i._inheritsLoose(t,e);var r=t.prototype;return r.fetchPopupFeatures=async function(e,t){const{layer:i}=this;if(!e)return y.reject(new u("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:i}));const{popupEnabled:r}=i,a=w.getFetchPopupTemplate(i,t);if(!r||!n.isSome(a))throw new u("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:r,popupTemplate:a});const s=await a.getRequiredFields(),o=new v;o.geometry=e,o.outFields=s,o.outSpatialReference=e.spatialReference;const p=this.view.resolution,l="2d"===this.view.type?new m(p,p,this.view.spatialReference):new m(.5*p,.5*p,this.view.spatialReference),{returnTopmostRaster:c,showNoDataRecords:h}=a.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},d={returnDomainValues:!0,returnTopmostRaster:c,pixelSize:l,showNoDataRecords:h};return i.queryVisibleRasters(o,d).then((e=>e))},r.canResume=function(){var t;return!(!e.prototype.canResume.call(this)||null!=(t=this.timeExtent)&&t.isEmpty)},t}(e);return r.__decorate([p.property()],t.prototype,"layer",void 0),r.__decorate([p.property({dependsOn:["timeExtent"]})],t.prototype,"suspended",void 0),r.__decorate([p.property(g.combinedViewLayerTimeExtentProperty)],t.prototype,"timeExtent",void 0),r.__decorate([p.property()],t.prototype,"view",void 0),t=r.__decorate([l.subclass("esri.views.layers.ImageryLayerView")],t),t},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,r))||(e.exports=a)},28575:(e,t,i)=>{var r,a;r=[t,i(3718),i(12808)],void 0===(a=function(e,i,r){"use strict";t.getFetchPopupTemplate=function(e,t){return e.popupTemplate?e.popupTemplate:i.isSome(t)&&t.defaultPopupTemplateEnabled&&i.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null},t.getRequiredFields=async function(e,t=e.popupTemplate){if(!i.isSome(t))return[];const a=await t.getRequiredFields(e.fields),{lastEditInfoEnabled:n}=t,{objectIdField:s,typeIdField:o,globalIdField:p,relationships:l}=e;if(a.includes("*"))return["*"];const u=n?await r.getFeatureEditFields(e):[],c=r.fixFields(e.fields,[...a,...u]);return o&&c.push(o),c&&s&&r.hasField(e.fields,s)&&-1===c.indexOf(s)&&c.push(s),c&&p&&r.hasField(e.fields,p)&&-1===c.indexOf(p)&&c.push(p),l&&l.forEach((t=>{const{keyField:i}=t;c&&i&&r.hasField(e.fields,i)&&-1===c.indexOf(i)&&c.push(i)})),c},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,r))||(e.exports=a)}}]);