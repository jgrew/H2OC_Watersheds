(self.webpackChunkh2oc=self.webpackChunkh2oc||[]).push([[7739],{57575:(e,t,i)=>{var n,r;n=[t,i(70792),i(3438)],void 0===(r=function(e,i,n){"use strict";const r=(()=>{if(!("document"in i))return()=>null;const e=document.createElement("canvas"),t=e.getContext("2d");return e.height=512,e.width=1,i=>{t.clearRect(0,0,1,e.height);const n=t.createLinearGradient(0,0,0,e.height);for(const{ratio:e,color:t}of i.colorStops)n.addColorStop(Math.max(e,.001),`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`);return t.fillStyle=n,t.fillRect(0,0,1,e.height),t.getImageData(0,0,1,e.height).data}})();function s(e,t,i,r,s){const o=new Uint32Array(e*e),a="buffer"in t?t:new Float64Array(t),l="buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer),u=l.length/(s-r);for(let e=0;e<a.length;e++){const t=a[e],i=Math.floor((t-r)*u);o[e]=l[n.clamp(i,0,l.length-1)]}return o.buffer}function o(e){const t=Math.round(3*e),i=2*e*e,n=new Float64Array(2*t+1);for(let r=0;r<=n.length;r++)n[r]=Math.exp(-Math.pow(r-t,2)/i)/Math.sqrt(2*Math.PI)*(e/2);return n}function a(e,t){return"function"==typeof e?e:e?"string"==typeof t?t=>-1*+t[e]:i=>+i[e]+t:()=>1}function l(e,t){return null!=e?"string"==typeof t?t=>-1*+t.readAttribute(e):i=>+i.readAttribute(e)+t:e=>1}t.calculateHeatmapIntensityInfo=function(e,t,i,n){const{blurRadius:r,fieldOffset:s,field:l}=t,u=new Float64Array(i*n),c=o(r),h=Math.round(3*r);let d,f=Number.NEGATIVE_INFINITY;const p=a(l,s);for(const{geometry:t,attributes:r}of e){const e=t.x-h,s=t.y-h,o=Math.max(0,e),a=Math.max(0,s),l=Math.min(n,t.y+h),y=Math.min(i,t.x+h),m=+p(r);for(let t=a;t<l;t++){const n=c[t-s];for(let r=o;r<y;r++){const s=c[r-e];d=u[t*i+r]+=n*s*m,d>f&&(f=d)}}}return{matrix:u.buffer,max:f}},t.calculateHeatmapIntensityInfoReaders=function(e,t,i,n){const{blurRadius:r,fieldOffset:s,field:a}=t,u=new Float64Array(i*n),c=o(r),h=Math.round(3*r);let d,f=Number.NEGATIVE_INFINITY;const p=l(a,s),y=new Set;for(const t of e){const e=t.getCursor();for(;e.next();){const t=e.getObjectId();if(y.has(t))continue;y.add(t);const r=e.readLegacyPointGeometry(),s=+p(e),o=r.x-h,a=r.y-h,l=Math.max(0,o),m=Math.max(0,a),g=Math.min(n,r.y+h),x=Math.min(i,r.x+h);for(let e=m;e<g;e++){const t=c[e-a];for(let n=l;n<x;n++){const r=c[n-o];d=u[e*i+n]+=t*r*s,d>f&&(f=d)}}}}return{matrix:u.buffer,max:f}},t.createHeatmapImageData=s,t.createKernel=o,t.createValueFunction=a,t.createValueFunctionCursor=l,t.drawHeatmap=function(e,t,i,n,r,o){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);const a=e.getImageData(0,0,t,t);i&&n&&a.data.set(new Uint8ClampedArray(s(t,i,n,r,o))),e.putImageData(a,0,0)},t.generateGradient=r,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,n))||(e.exports=r)},3093:(e,t,i)=>{var n,r;n=[t,i(58797),i(74637),i(12525),i(83334),i(1422),i(80593),i(27975),i(48188),i(98043),i(93681),i(31561)],void 0===(r=function(e,i,n,r,s,o,a,l,u,c,h,d){"use strict";function f(e,t,i){const n={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return t&&i&&(n.width=t,n.height=i),new l(e,n)}let p=function(e){function t(t=null,n=!0){var r;return(r=e.call(this)||this).requestRenderOnSourceChangedEnabled=n,r._textureInvalidated=!0,r.stencilRef=0,r.coordScale=[1,1],r._height=void 0,r.pixelRatio=1,r.resolution=0,r.rotation=0,r._source=null,r._width=void 0,r.x=0,r.y=0,r.transforms={dvs:s.create()},r.source=t,r.requestRender=r.requestRender.bind(i._assertThisInitialized(r)),r}i._inheritsLoose(t,e);var n=t.prototype;return n.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)},n.beforeRender=function(t){e.prototype.beforeRender.call(this,t),this.updateTexture(t)},n.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())},n.setTransform=function(e){const t=r.identity(this.transforms.dvs),[i,n]=e.toScreenNoRotation([0,0],this.x,this.y),s=this.resolution/this.pixelRatio/e.resolution,a=s*this.width,l=s*this.height,u=Math.PI*this.rotation/180;r.translate(t,t,o.fromValues(i,n)),r.translate(t,t,o.fromValues(a/2,l/2)),r.rotate(t,t,-u),r.translate(t,t,o.fromValues(-a/2,-l/2)),r.scaleByVec2(t,t,o.fromValues(a,l)),r.multiply(this.transforms.dvs,e.displayViewMat3,t)},n.setSamplingProfile=function(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))},n.bind=function({context:e},t){this._texture&&e.bindTexture(this._texture,t)},n.updateTexture=function({context:e}){var t;if(!this.stage)return null==(t=this._texture)||t.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=f(e,this.sourceWidth,this.sourceHeight):this._texture=f(e));const i=this.source;if(i){if(this._texture.resize(this.sourceWidth,this.sourceHeight),function(e){return e&&"render"in e}(i))if(i instanceof d){const e=i.getRenderedRasterPixels();this._texture.setData(e.renderedRasterPixels)}else this._texture.setData(function(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}(i));else(function(e){return e&&!("render"in e)})(i)&&this._texture.setData(i);this.ready()}else this._texture.setData(null)},n.onAttach=function(){this.invalidateTexture()},n.onDetach=function(){this.invalidateTexture()},i._createClass(t,[{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(e){this._height=e}},{key:"source",get:function(){return this._source},set:function(e){this._source=e,this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(e){this._width=e}}]),t}(h.DisplayObject);t.Bitmap=p,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,n))||(e.exports=r)},48361:(e,t,i)=>{var n,r;n=[t,i(58797),i(5702),i(3093)],void 0===(r=function(e,i,n,r){"use strict";let s=function(e){function t(t,i,n,s=null){var o;return(o=e.call(this,t,i,n,n)||this).bitmap=new r.Bitmap(s),o.bitmap.coordScale=n,o.bitmap.once("isReady",(()=>o.ready())),o}i._inheritsLoose(t,e);var n=t.prototype;return n.destroy=function(){e.prototype.destroy.call(this),this.bitmap.destroy()},n.beforeRender=function(t){e.prototype.beforeRender.call(this,t),this.bitmap.beforeRender(t)},n.afterRender=function(t){e.prototype.afterRender.call(this,t),this.bitmap.afterRender(t)},n.setTransform=function(t,i){e.prototype.setTransform.call(this,t,i),this.bitmap.transforms.dvs=this.transforms.dvs},n.onAttach=function(){this.bitmap.stage=this.stage},n.onDetach=function(){this.bitmap.stage=null},i._createClass(t,[{key:"stencilRef",set:function(e){this.bitmap.stencilRef=e},get:function(){return this.bitmap.stencilRef}}]),t}(n.TiledDisplayObject);t.BitmapTile=s,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,n))||(e.exports=r)},87361:(e,t,i)=>{var n,r;n=[t,i(58797),i(18167),i(53183),i(41706),i(79140),i(48361)],void 0===(r=function(e,i,n,r,s,o,a){"use strict";let l=function(e){function t(){return e.apply(this,arguments)||this}i._inheritsLoose(t,e);var o=t.prototype;return o.createTile=function(e){const t=this._tileInfoView.getTileBounds(n.create(),e);return new a.BitmapTile(e,t,this._tileInfoView.tileInfo.size)},o.destroyTile=function(){},o.prepareRenderPasses=function(t){const i=t.registerRenderPass({name:"bitmap (tile)",brushes:[s.brushes.bitmap],target:()=>this.children.map((e=>e.bitmap)),drawPhase:r.WGLDrawPhase.MAP});return[...e.prototype.prepareRenderPasses.call(this,t),i]},o.doRender=function(t){this.visible&&t.drawPhase===r.WGLDrawPhase.MAP&&e.prototype.doRender.call(this,t)},t}(o.default);t.BitmapTileContainer=l,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,n))||(e.exports=r)},31561:(e,t,i)=>{var n,r;n=[i(58797)],void 0===(r=function(e){"use strict";return function(){function t(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}var i=t.prototype;return i.render=function(e){const t=this.pixelBlock;if(!t)return;const i=this.filter({pixelBlock:t}),n=i.pixelBlock.getAsRGBA(),r=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);r.data.set(n),e.putImageData(r,0,0)},i.getRenderedRasterPixels=function(){const e=this.filter({pixelBlock:this.pixelBlock});return{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}},e._createClass(t,[{key:"width",get:function(){return this.pixelBlock?this.pixelBlock.width:0}},{key:"height",get:function(){return this.pixelBlock?this.pixelBlock.height:0}}]),t}()}.apply(t,n))||(e.exports=r)},79140:(e,t,i)=>{var n,r;n=[t,i(58797),i(53183),i(83534),i(40910),i(98520)],void 0===(r=function(e,i,n,r,s,o){"use strict";const a=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;let l=function(e){function t(t){var i;return(i=e.call(this)||this)._tileInfoView=t,i}i._inheritsLoose(t,e);var o=t.prototype;return o.renderChildren=function(t){this.sortChildren(a),this.setStencilReference(),e.prototype.renderChildren.call(this,t)},o.createRenderParams=function(t){const{state:i}=t;return{...e.prototype.createRenderParams.call(this,t),requiredLevel:this._tileInfoView.getClosestInfoForScale(i.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(i.scale)}},o.prepareRenderPasses=function(t){const i=t.registerRenderPass({name:"stencil",brushes:[s],drawPhase:n.WGLDrawPhase.DEBUG|n.WGLDrawPhase.MAP|n.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}),o=t.registerRenderPass({name:"tileInfo",brushes:[r],drawPhase:n.WGLDrawPhase.DEBUG,target:()=>this.children,has:"esri-tiles-debug"});return[...e.prototype.prepareRenderPasses.call(this,t),i,o]},o.getStencilTarget=function(){return this.children},o.updateTransforms=function(e){for(const t of this.children){const i=this._tileInfoView.getTileResolution(t.key);t.setTransform(e,i)}},o.setStencilReference=function(){let e=1;for(const t of this.children)t.stencilRef=e++},t}(o);t.default=l,t.sortByLevel=a,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,n))||(e.exports=r)},5702:(e,t,i)=>{var n,r;n=[t,i(58797),i(74637),i(12525),i(11286),i(83334),i(93681)],void 0===(r=function(e,i,n,r,s,o,a){"use strict";let l=function(e){function t(t,i,n,r=n){var a;return(a=e.call(this)||this).triangleCountReportedInDebug=0,a.transforms={dvs:o.create(),tileMat3:o.create()},a.triangleCount=0,a.key=new s(t),a.bounds=i,a.size=n,a.coordRange=r,a}i._inheritsLoose(t,e);var n=t.prototype;return n.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)},n.setTransform=function(e,t){const i=t/(e.resolution*e.pixelRatio),n=this.transforms.tileMat3,[s,o]=e.toScreenNoRotation([0,0],this.coords),a=this.size[0]/this.coordRange[0]*i,l=this.size[1]/this.coordRange[1]*i;r.set(n,a,0,0,0,l,0,s,o,1),r.multiply(this.transforms.dvs,e.displayViewMat3,n)},i._createClass(t,[{key:"coords",get:function(){return this._coords}},{key:"bounds",get:function(){return this._bounds},set:function(e){this._coords=[e[0],e[3]],this._bounds=e}}]),t}(a.DisplayObject);t.TiledDisplayObject=l,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,n))||(e.exports=r)},93770:(e,t,i)=>{var n,r;n=[i(58797),i(11285),i(74637),i(73462),i(67059),i(26475),i(99752),i(4037),i(51916),i(18377),i(74474)],void 0===(r=function(e,t,i,n,r,s,o,a,l,u,c){"use strict";let h=function(t){function i(e){var i;return(i=t.call(this,e)||this).tiles=new Map,i}e._inheritsLoose(i,t);var n=i.prototype;return n.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null},n.acquireTile=function(e){const t=this.createTile(e);return t.once("isReady",(()=>this.notifyChange("updating"))),this.tiles.set(e.id,t),t},n.forceAttributeTextureUpload=function(){},n.forEachTile=function(e){this.tiles.forEach(e)},n.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},n.isUpdating=function(){let e=!0;return this.tiles.forEach((t=>{e=e&&t.isReady})),!e},n.setHighlight=function(){},n.invalidateLabels=function(){},n.requestUpdate=function(){this.layerView.requestUpdate()},e._createClass(i,[{key:"updating",get:function(){return this.isUpdating()}}]),i}(c.HandleOwner);return t.__decorate([s.property()],h.prototype,"layer",void 0),t.__decorate([s.property()],h.prototype,"layerView",void 0),t.__decorate([s.property()],h.prototype,"tileInfoView",void 0),t.__decorate([s.property()],h.prototype,"updating",null),h=t.__decorate([o.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],h),h}.apply(t,n))||(e.exports=r)},77739:(e,t,i)=>{var n,r;n=[i(58797),i(11285),i(74637),i(73462),i(67059),i(26475),i(99752),i(4037),i(51916),i(18377),i(9720),i(57575),i(87361),i(93770),i(3032)],void 0===(r=function(e,t,i,n,r,s,o,a,l,u,c,h,d,f,p){"use strict";let y=function(t){function i(e){var i;return(i=t.call(this,e)||this)._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0},i.featuresView={attributeView:{initialize:()=>{},requestUpdate:()=>{}},requestRender:()=>{}},i._container=new d.BitmapTileContainer(e.tileInfoView),i}e._inheritsLoose(i,t);var n=i.prototype;return n.createTile=function(e){const t=this._container.createTile(e);return this.tileInfoView.getTileCoords(t.bitmap,e),t.bitmap.resolution=this.tileInfoView.getTileResolution(e),t},n.onConfigUpdate=function(){const e=this.layer.renderer;if("heatmap"===e.type){const{minPixelIntensity:t,maxPixelIntensity:i}=e;this._intensityInfo.minPixelIntensity=t,this._intensityInfo.maxPixelIntensity=i,this._gradient=h.generateGradient(e.toJSON()),this.tiles.forEach((e=>{const n=e.bitmap.source;n&&(n.minPixelIntensity=t,n.maxPixelIntensity=i,n.gradient=this._gradient,e.bitmap.invalidateTexture())}))}},n.hitTest=function(){return c.resolve([])},n.install=function(e){e.addChild(this._container)},n.uninstall=function(e){this._container.removeAllChildren(),e.removeChild(this._container)},n.disposeTile=function(e){this._container.removeChild(e),e.destroy()},n.supportsRenderer=function(e){return e&&"heatmap"===e.type},n.onTileData=function(e){const t=this.tiles.get(e.tileKey);if(!t)return;const i=e.intensityInfo,{minPixelIntensity:n,maxPixelIntensity:r}=this._intensityInfo,s=t.bitmap.source||new p.HeatmapSource;s.intensities=i&&i.matrix||null,s.minPixelIntensity=n,s.maxPixelIntensity=r,s.gradient=this._gradient,t.bitmap.source=s,this._container.addChild(t),this.requestUpdate()},n.onTileError=function(e){console.error(e)},n.lockGPUUploads=function(){},n.unlockGPUUploads=function(){},i}(f);return y=t.__decorate([o.subclass("esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer")],y),y}.apply(t,n))||(e.exports=r)},3032:(e,t,i)=>{var n,r;n=[t,i(57575)],void 0===(r=function(e,i){"use strict";let n=function(){function e(){this.gradient=null,this.height=512,this.width=512}return e.prototype.render=function(e){i.drawHeatmap(e,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)},e}();t.HeatmapSource=n,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,n))||(e.exports=r)}}]);