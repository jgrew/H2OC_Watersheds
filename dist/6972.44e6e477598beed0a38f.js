(self.webpackChunkh2oc=self.webpackChunkh2oc||[]).push([[6972],{61789:(t,e)=>{var n;void 0===(n=function(t){"use strict";function n(t,e,n,r,i){let o;if(i===f(t,e,n,r)>0)for(let i=e;i<n;i+=r)o=a(i,t[i],t[i+1],o);else for(let i=n-r;i>=e;i-=r)o=a(i,t[i],t[i+1],o);return o&&g(o,o.next)&&(u(o),o=o.next),o}function r(t,e=t){if(!t)return t;let n,r=t;do{if(n=!1,r.steiner||!g(r,r.next)&&0!==p(r.prev,r,r.next))r=r.next;else{if(u(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,a,c,l,p=0){if(!t)return;!p&&l&&(t=h(t,a,c,l));let y=t;for(;t.prev!==t.next;){const h=t.prev,f=t.next;if(l?s(t,a,c,l):o(t))e.push(h.index/n),e.push(t.index/n),e.push(f.index/n),u(t),t=f.next,y=f.next;else if((t=f)===y){p?1===p?i(t=V(t,e,n),e,n,a,c,l,2):2===p&&S(t,e,n,a,c,l):i(r(t),e,n,a,c,l,1);break}}}function o(t){const e=t.prev,n=t,r=t.next;if(p(e,n,r)>=0)return!1;let i=t.next.next;const o=i;let s=0;for(;i!==t.prev&&(0===s||i!==o);){if(s++,v(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&p(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,n,r){const i=t.prev,o=t,s=t.next;if(p(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=x(a,u,e,n,r),y=x(c,l,e,n,r);let f=t.prevZ,d=t.nextZ;for(;f&&f.z>=h&&d&&d.z<=y;){if(f!==t.prev&&f!==t.next&&v(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&p(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,d!==t.prev&&d!==t.next&&v(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&p(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&v(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&p(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;d&&d.z<=y;){if(d!==t.prev&&d!==t.next&&v(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&p(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function a(t,e,n,r){const i=new T(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function u(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function c(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function l(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s){if(s=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o.prev;const a=o,u=o.x,c=o.y;let l,h=1/0;for(n=o.next;n!==a;)r>=n.x&&n.x>=u&&r!==n.x&&v(i<c?r:s,i,u,c,i<c?s:r,i,n.x,n.y)&&(l=Math.abs(i-n.y)/(r-n.x),(l<h||l===h&&n.x>o.x)&&d(n,t)&&(o=n,h=l)),n=n.next;return o}(t,e)){const n=m(e,t);r(n,n.next)}}function h(t,e,n,r){for(let i;i!==t;i=i.next){if(i=i||t,null===i.z&&(i.z=x(i.x,i.y,e,n,r)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,h(t,e,n,r);i.prevZ=i.prev,i.nextZ=i.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,n=1;for(;;){let r,i=t;t=null,e=null;let o=0;for(;i;){o++,r=i;let s=0;for(;s<n&&r;s++)r=r.nextZ;let a=n;for(;s>0||a>0&&r;){let n;0===s?(n=r,r=r.nextZ,a--):0!==a&&r?i.z<=r.z?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,s--),e?e.nextZ=n:t=n,n.prevZ=e,e=n}i=r}if(e.nextZ=null,n*=2,o<2)return t}}(t)}function p(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e,n,r){return!!(g(t,e)&&g(n,r)||g(t,r)&&g(n,e))||p(t,e,n)>0!=p(t,e,r)>0&&p(n,r,t)>0!=p(n,r,e)>0}function f(t,e,n,r){let i=0;for(let o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}function v(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function d(t,e){return p(t.prev,t,t.next)<0?p(t,e,t.next)>=0&&p(t,t.prev,e)>=0:p(t,e,t.prev)<0||p(t,t.next,e)<0}function x(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t,e){return t.x===e.x&&t.y===e.y}function _(t,e){return t.x-e.x}function V(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!g(i,o)&&y(i,r,r.next,o)&&d(i,o)&&d(o,i)&&(e.push(i.index/n),e.push(r.index/n),e.push(o.index/n),u(r),u(r.next),r=t=o),r=r.next}while(r!==t);return r}function S(t,e,n,o,s,a){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.index!==t.index&&L(u,t)){let c=m(u,t);return u=r(u,u.next),c=r(c,c.next),i(u,e,n,o,s,a),void i(c,e,n,o,s,a)}t=t.next}u=u.next}while(u!==t)}function L(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let n=t;do{if(n.index!==t.index&&n.next.index!==t.index&&n.index!==e.index&&n.next.index!==e.index&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&d(t,e)&&d(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}function m(t,e){const n=new T(t.index,t.x,t.y),r=new T(e.index,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}let T=function(t,e,n){this.index=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1};e.deviation=function(t,e,n,r){const i=e&&e.length,o=i?e[0]*n:t.length;let s=Math.abs(f(t,0,o,n));if(i)for(let r=0,i=e.length;r<i;r++){const o=e[r]*n,a=r<i-1?e[r+1]*n:t.length;s-=Math.abs(f(t,o,a,n))}let a=0;for(let e=0;e<r.length;e+=3){const i=r[e]*n,o=r[e+1]*n,s=r[e+2]*n;a+=Math.abs((t[i]-t[s])*(t[o+1]-t[i+1])-(t[i]-t[o])*(t[s+1]-t[i+1]))}return 0===s&&0===a?0:Math.abs((a-s)/s)},e.earcut=function(t,e,o){const s=e&&e.length,a=s?e[0]*o:t.length;let u=n(t,0,a,o,!0);const h=new Array;if(!u||u.next===u.prev)return h;let p,y,f,v,d;if(s&&(u=function(t,e,i,o){const s=new Array;for(let r=0,i=e.length;r<i;r++){const a=n(t,e[r]*o,r<i-1?e[r+1]*o:t.length,o,!1);a===a.next&&(a.steiner=!0),s.push(c(a))}s.sort(_);for(const t of s)l(t,i),i=r(i,i.next);return i}(t,e,u,o)),t.length>80*o){p=f=t[0],y=v=t[1];for(let e=o;e<a;e+=o){const n=t[e],r=t[e+1];p=Math.min(p,n),y=Math.min(y,r),f=Math.max(f,n),v=Math.max(v,r)}d=Math.max(f-p,v-y),d=0!==d?1/d:0}return i(u,h,o,p,y,d),h},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,[e]))||(t.exports=n)},6578:(t,e)=>{var n;void 0===(n=function(t){"use strict";const n=Number.POSITIVE_INFINITY,r=Math.PI,i=2*r,o=r/2,s=128/r,a=r/128,u=256/360,c=r/180,l=1/Math.LN2;function h(t,e){return(t%=e)>=0?t:t+e}e.C_256_TO_RAD=a,e.C_2PI=i,e.C_DEG_TO_256=u,e.C_DEG_TO_RAD=c,e.C_INFINITY=n,e.C_PI=r,e.C_PI_BY_2=o,e.C_RAD_TO_256=s,e.C_SQRT2=1.414213562,e.C_SQRT2_INV=.707106781373095,e.between=function(t,e,n){return t>=e&&t<=n||t>=n&&t<=e},e.degToByte=function(t){return h(t*u,256)},e.interpolate=function(t,e,n){return t*(1-n)+e*n},e.log2=function(t){return Math.log(t)*l},e.positiveMod=h,e.radToByte=function(t){return h(t*s,256)},e.sqr=function(t){return t*t},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,[e]))||(t.exports=n)},67005:(t,e,n)=>{var r,i;r=[e,n(39241)],void 0===(i=function(t,n){"use strict";let r=function(){function t(t,e=2){this._bucketSize=t,this._rowsLength=n.TILE_SIZE/t,this._colsLength=n.TILE_SIZE/t,this._elementsPerBucket=e,this._grid=this._initGrid()}var e=t.prototype;return e.checkOverlap=function(t,e){const n=Math.floor(t/this._bucketSize),r=Math.floor(e/this._bucketSize);return n<0||n>=this._rowsLength||r<0||r>=this._colsLength||this._grid[r*this._colsLength+n]>=this._elementsPerBucket},e.markUsed=function(t,e){const n=Math.floor(t/this._bucketSize),r=Math.floor(e/this._bucketSize);this._grid[r*this._colsLength+n]+=1},e.reset=function(){this._grid=this._initGrid()},e._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)},t}();e.CollisionGrid=r,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=i)},26653:(t,e,n)=>{var r,i;r=[e,n(58797),n(49359),n(53183),n(1291)],void 0===(i=function(t,n,r,i,o){"use strict";function s(t,e=!1){const n=i.WGLVVFlag.SIZE_FIELD_STOPS|i.WGLVVFlag.SIZE_MINMAX_VALUE|i.WGLVVFlag.SIZE_SCALE_STOPS|i.WGLVVFlag.SIZE_UNIT_VALUE,r=(t&(i.WGLVVTarget.FIELD_TARGETS_OUTLINE|i.WGLVVTarget.MINMAX_TARGETS_OUTLINE|i.WGLVVTarget.SCALE_TARGETS_OUTLINE|i.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return e?n&r:n&~r}function a(t){const e=s(t,!1);return t&(i.WGLVVFlag.COLOR|i.WGLVVFlag.OPACITY|i.WGLVVFlag.ROTATION|e)}let u=function(){function t(t){this._data=0,this._data=t}t.load=function(t){const e=this.shared;return e.data=t,e};var e=t.prototype;return e.setBit=function(t,e){const n=1<<t;e?this._data|=n:this._data&=~n},e.bit=function(t){return(this._data&1<<t)>>t},e.setBits=function(t,e,n){for(let r=e,i=0;r<n;r++,i++)this.setBit(r,0!=(t&1<<i))},e.bits=function(t,e){let n=0;for(let r=t,i=0;r<e;r++,i++)n|=this.bit(r)<<i;return n},e.hasVV=function(){return!1},e.setVV=function(t,e){},e.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}},e.getVariationHash=function(){return this._data&~(7&this.textureBinding)},n._createClass(t,[{key:"data",set:function(t){this._data=t},get:function(){return this._data}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(t){this.setBits(t,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(t){this.setBit(20,t)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(t){this.setBit(11,t)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(t){this.setBit(12,t)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(t){this.setBits(t,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case i.WGLGeometryType.FILL:return"fill";case i.WGLGeometryType.MARKER:return"marker";case i.WGLGeometryType.LINE:return"line";case i.WGLGeometryType.TEXT:return"text";case i.WGLGeometryType.LABEL:return"label";default:throw new r(`Unable to handle unknown geometryType: ${this.geometryType}`)}}}]),t}();u.shared=new u(0);const c=t=>function(t){function e(){return t.apply(this,arguments)||this}n._inheritsLoose(e,t);var r=e.prototype;return r.hasVV=function(){return t.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue},r.setVV=function(e,n){t.prototype.setVV.call(this,e,n);const r=s(e,n)&e;this.vvSizeMinMaxValue=!!(r&i.WGLVVFlag.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(r&i.WGLVVFlag.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(r&i.WGLVVFlag.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(r&i.WGLVVFlag.SIZE_SCALE_STOPS)},n._createClass(e,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(t){this.setBit(16,t)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(t){this.setBit(17,t)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(t){this.setBit(18,t)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(t){this.setBit(19,t)}}]),e}(t),l=t=>function(t){function e(){return t.apply(this,arguments)||this}n._inheritsLoose(e,t);var r=e.prototype;return r.hasVV=function(){return t.prototype.hasVV.call(this)||this.vvRotation},r.setVV=function(e,n){t.prototype.setVV.call(this,e,n),this.vvRotation=!n&&!!(e&i.WGLVVFlag.ROTATION)},n._createClass(e,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(t){this.setBit(15,t)}}]),e}(t),h=t=>function(t){function e(){return t.apply(this,arguments)||this}n._inheritsLoose(e,t);var r=e.prototype;return r.hasVV=function(){return t.prototype.hasVV.call(this)||this.vvColor},r.setVV=function(e,n){t.prototype.setVV.call(this,e,n),this.vvColor=!n&&!!(e&i.WGLVVFlag.COLOR)},n._createClass(e,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(t){this.setBit(13,t)}}]),e}(t),p=t=>function(t){function e(){return t.apply(this,arguments)||this}n._inheritsLoose(e,t);var r=e.prototype;return r.hasVV=function(){return t.prototype.hasVV.call(this)||this.vvOpacity},r.setVV=function(e,n){t.prototype.setVV.call(this,e,n),this.vvOpacity=!n&&!!(e&i.WGLVVFlag.OPACITY)},n._createClass(e,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(t){this.setBit(14,t)}}]),e}(t);let y=function(t){function e(){return t.apply(this,arguments)||this}return n._inheritsLoose(e,t),e.load=function(t){const e=this.shared;return e.data=t,e},e.from=function(t,e){const n=this.load(0);return n.geometryType=i.WGLGeometryType.FILL,e?n.dotDensity=!0:n.setVV(t,!1),n.data},e.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity}},n._createClass(e,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(t){this.setBit(15,t)}}]),e}(h(p(u)));y.shared=new y(0);let f=function(t){function e(){return t.apply(this,arguments)||this}return n._inheritsLoose(e,t),e.load=function(t){const e=this.shared;return e.data=t,e},e.from=function(t){const e=this.load(0);return e.geometryType=i.WGLGeometryType.MARKER,e.setVV(t,!1),e.data},e.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}},e}(h(p(l(c(u)))));f.shared=new f(0);let v=function(t){function e(){return t.apply(this,arguments)||this}return n._inheritsLoose(e,t),e.load=function(t){const e=this.shared;return e.data=t,e},e.from=function(t,e){const n=this.load(0);return n.geometryType=i.WGLGeometryType.LINE,n.setVV(t,e),n.data},e.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}},e}(h(p(c(u))));v.shared=new v(0);let d=function(t){function e(){return t.apply(this,arguments)||this}return n._inheritsLoose(e,t),e.load=function(t){const e=this.shared;return e.data=t,e},e.from=function(t){const e=this.load(t);return e.geometryType=i.WGLGeometryType.TEXT,e.setVV(t,!1),e.data},e.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}},e}(h(p(l(c(u)))));d.shared=new d(0);let x=function(t){function e(){return t.apply(this,arguments)||this}return n._inheritsLoose(e,t),e.load=function(t){const e=this.shared;return e.data=t,e},e.from=function(t,e){const n=this.load(0);return n.geometryType=i.WGLGeometryType.LABEL,n.setVV(t,!1),n.mapAligned=!!o.isMapAligned(e),n.data},e.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}},e}(c(u));x.shared=new x(0),e.FillMaterialKey=y,e.LabelMaterialKey=x,e.LineMaterialKey=v,e.MarkerMaterialKey=f,e.MaterialKeyBase=u,e.TextMaterialKey=d,e.createMaterialKey=function(t,e,n,r,o){switch(t){case i.WGLGeometryType.FILL:return y.from(e,r);case i.WGLGeometryType.LINE:return v.from(e,n);case i.WGLGeometryType.MARKER:return f.from(e);case i.WGLGeometryType.TEXT:return d.from(e);case i.WGLGeometryType.LABEL:return x.from(e,o);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${t}`)}},e.getFillVVFlags=function(t){return t&(i.WGLVVFlag.COLOR|i.WGLVVFlag.OPACITY)},e.getLabelVVFlags=function(t){return t&s(t,!1)},e.getLineVVFlags=function(t,e){if(e)return t&s(t,!0);const n=s(t,!1);return t&(i.WGLVVFlag.COLOR|i.WGLVVFlag.OPACITY|n)},e.getMarkerVVFlags=a,e.getSizeFlagsMask=s,e.getTextVVFlags=function(t){return a(t)},e.hydrateMaterialKey=function(t){switch(u.load(t).geometryType){case i.WGLGeometryType.MARKER:return new f(t);case i.WGLGeometryType.FILL:return new y(t);case i.WGLGeometryType.LINE:return new v(t);case i.WGLGeometryType.TEXT:return new d(t);case i.WGLGeometryType.LABEL:return new x(t)}},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=i)},1291:(t,e)=>{var n;void 0===(n=function(t){"use strict";e.isMapAligned=function(t){switch(t){case"above-along":case"below-along":case"center-along":return 1;default:return 0}},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,[e]))||(t.exports=n)},13123:(t,e,n)=>{var r,i;r=[n(58797),n(11285),n(74637),n(73462),n(67059),n(26475),n(99752),n(4037),n(51916),n(18377),n(74474)],void 0===(i=function(t,e,n,r,i,o,s,a,u,c,l){"use strict";let h=function(e){function n(){return e.apply(this,arguments)||this}t._inheritsLoose(n,e);var r=n.prototype;return r.initialize=function(){},r.destroy=function(){},t._createClass(n,[{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){const t=this.get("tileStore.tileScheme.spatialReference");return t&&t.toJSON()||null}}]),n}(l.HandleOwner);return e.__decorate([o.property({readOnly:!0})],h.prototype,"supportsTileUpdates",null),e.__decorate([o.property({constructOnly:!0})],h.prototype,"remoteClient",void 0),e.__decorate([o.property({constructOnly:!0})],h.prototype,"service",void 0),e.__decorate([o.property({dependsOn:["tileStore.tileScheme.spatialReference"]})],h.prototype,"spatialReference",null),e.__decorate([o.property({constructOnly:!0})],h.prototype,"tileInfo",void 0),e.__decorate([o.property({constructOnly:!0})],h.prototype,"tileStore",void 0),h=e.__decorate([s.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],h),h}.apply(e,r))||(t.exports=i)},19363:(t,e,n)=>{var r,i;r=[n(58797),n(11285),n(74637),n(3718),n(73462),n(67059),n(26475),n(99752),n(49359),n(4037),n(51916),n(18377),n(9720),n(23084),n(63940),n(39241),n(69911),n(96899),n(35872),n(85294),n(92131),n(74549),n(67005),n(13123)],void 0===(i=function(t,e,n,r,i,o,s,a,u,c,l,h,p,y,f,v,d,x,g,_,V,S,L,m){"use strict";i.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");let T=function(e){function i(){var t;return(t=e.apply(this,arguments)||this).type="symbol",t}t._inheritsLoose(i,e);var o=i.prototype;return o.destroy=function(){},o.update=async function(t,e){const r=e.schema.processors[0];if("symbol"!==r.type)return;const i=f.diff(this._schema,r);f.hasDiff(i,"mesh")&&(n("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",i),t.mesh=!0,t.why.mesh.push("Symbology changed"),this._schema=r,this._factory=this._createFactory(r),this._factory.update(r,this.tileStore.tileScheme.tileInfo))},o.onTileData=function(t,e,n){return p.throwIfAborted(n),this._onTileData(t,e,n)},o.onTileError=function(t,e,n){const r=n.signal,i={tileKey:t.id,error:e};return this.remoteClient.invoke("tileRenderer.onTileError",i,{signal:r})},o._createFactory=function(t){const{geometryType:e,objectIdField:n,fields:r}=this.service,i={geometryType:e,fields:r,spatialReference:y.fromJSON(this.spatialReference)},o=new _.WGLTemplateStore(((t,e)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",t,e)),!1);return this._store=o,this._matcher=x.createMatcher(t.mesh.matcher,o,i),new V.WGLMeshFactory(e,n,o)},o._onTileData=async function(t,e,n){const{type:i,addOrUpdate:o,remove:s,end:a}=e;if(!o){const e={type:i,addOrUpdate:null,remove:s,clear:!1,end:a};return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:e},n)}const u=this._processFeatures(t,o,n),c=n.signal;try{const e=await u,n=r.andThen(e,(t=>t.message)),o=r.andThen(e,(t=>t.transferList))||[],l={type:i,addOrUpdate:n,remove:s,clear:!1,end:a},h={transferList:r.unwrap(o)||[],signal:c};return p.throwIfAborted(h),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:l},h)}catch(e){this._handleError(t,e,n)}},o._processFeatures=async function(t,e,n){if(r.isNone(e)||!e.hasFeatures)return null;const i={transform:t.transform,hasZ:!1,hasM:!1},o=this._factory,s={viewingMode:"",scale:t.scale},a=await this._matcher;p.throwIfAborted(n);const u=this._getLabelInfos(t,e);return await o.analyze(e.getCursor(),a,i,s),p.throwIfAborted(n),this._writeFeatureSet(t,e,i,u,o)},o._writeFeatureSet=function(t,e,n,i,o){const s=o.createMeshData(e.getApproximateSize()),a={viewingMode:"",scale:t.scale},u=e.getCursor();for(;u.next();)try{const e=u.getDisplayId(),c=r.isSome(i)?i.get(e):null;o.writeCursor(s,u,n,a,t.level,c)}catch(t){}return this._encodeDisplayData(s)},o._encodeDisplayData=function(t){const e={},n=new Array;return t.encode(e,n),{message:e,transferList:n}},o._handleError=function(t,e,n){if(!p.isAbortError(e)){const r={tileKey:t.id,error:e.message};return this.remoteClient.invoke("tileRenderer.onTileError",r,{signal:n.signal})}},o._shouldDiscard=function(t,e){switch(this.service.geometryType){case"esriGeometryPoint":{const n=e.readLegacyPointGeometry();return!n||t.checkOverlap(n.x,n.y)}case"esriGeometryPolygon":{const n=e.readLegacyCentroid();return!n||t.checkOverlap(n.x,n.y)}default:return!1}},o._markUsed=function(t,e){switch(this.service.geometryType){case"esriGeometryPoint":{const{x:n,y:r}=e.readLegacyPointGeometry();return t.markUsed(n,r)}case"esriGeometryPolygon":{const{x:n,y:r}=e.readLegacyCentroid();return t.markUsed(n,r)}}},o._getLabelInfos=function(t,e){const n=this._schema.mesh.labels,i=r.andThen(n,(e=>e.filter((e=>function(t,e){return(!t.minScale||t.minScale>=e)&&(!t.maxScale||t.maxScale<=e)}(e,t.scale)))));if(r.isNone(i)||0===i.length)return null;const o=new Map,s=new L.CollisionGrid(v.COLLISION_EARLY_REJECT_BUCKET_SIZE),a=e.getCursor();for(;a.next();){const t=a.getDisplayId();if(this._shouldDiscard(s,a)){o.has(t)||o.set(t,null);continue}let e=!1;const n=[],r=S.isAggregateId(t),u=r&&1!==a.readAttribute("cluster_count")?"aggregate":"feature";for(const o of i){if(o.target!==u)continue;const i=a.getStorage(),s=r&&"feature"===u?i.getComputedStringAtIndex(a.readAttribute("referenceId"),o.fieldIndex):i.getComputedStringAtIndex(t,o.fieldIndex);if(!s)continue;const c=d.bidiText(s.toString()),l=c[0],h=c[1];this._store.getMosaicItem(o.symbol,g.codepoints(l)).then((t=>{n[o.index]={glyphs:t.glyphMosaicItems,rtl:h,index:o.index}})),e=!0}o.set(t,n),e&&this._markUsed(s,a)}return o},t._createClass(i,[{key:"supportsTileUpdates",get:function(){return!0}}]),i}(m);return T=e.__decorate([a.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],T),T}.apply(e,r))||(t.exports=i)}}]);