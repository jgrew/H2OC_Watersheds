(self.webpackChunkh2oc=self.webpackChunkh2oc||[]).push([[2942],{12279:(t,e,i)=>{var r,n;r=[e,i(58797),i(53183),i(26653)],void 0===(n=function(t,i,r,n){"use strict";const o={marker:r.WGLGeometryType.MARKER,fill:r.WGLGeometryType.FILL,line:r.WGLGeometryType.LINE,text:r.WGLGeometryType.TEXT};let s=function(){function t(t,e,i){this.layers=t,this.data=e,this.hash=this._createHash(),this.rendererKey=i;for(const e of t){const t=o[e.type];e.materialKey=n.createMaterialKey(t,this.rendererKey,!1,!1)}}return t.prototype._createHash=function(){let t="";for(const e of this.layers)t+=e.templateHash;return t},i._createClass(t,[{key:"type",get:function(){return"expanded-cim"}}]),t}();e.ExpandedCIM=s,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},29305:(t,e,i)=>{var r,n;r=[e,i(57167),i(29282),i(58597)],void 0===(n=function(t,i,r,n){"use strict";function o(t){let e=1/0,i=-1/0,r=1/0,n=-1/0;for(const o of t)for(const t of o)t[0]<e&&(e=t[0]),t[0]>i&&(i=t[0]),t[1]<r&&(r=t[1]),t[1]>n&&(n=t[1]);return[e,r,i,n]}function s(t,e){const i=2*e,r=t.length,o=new Uint8Array(4*r);for(let e=0;e<r;++e){const r=.5-t[e]/i;n.packFloatRGBA(r,o,4*e)}return o}e.buildSDF=function(t){const e=(i=t.geom)?i.rings?i.rings:i.paths?i.paths:void 0!==i.xmin&&void 0!==i.ymin&&void 0!==i.xmax&&void 0!==i.ymax?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:null:null;var i;const n=function(t){let e=1/0,i=-1/0,n=1/0,o=-1/0;for(const r of t)for(const t of r)t[0]<e&&(e=t[0]),t[0]>i&&(i=t[0]),t[1]<n&&(n=t[1]),t[1]>o&&(o=t[1]);return new r(e,n,i-e,o-n)}(e),o=Math.floor(31.5),a=(128-2*(o+1))/Math.max(n.width,n.height),l=Math.round(n.width*a)+2*o,c=Math.round(n.height*a)+2*o,h=[];for(const i of e)if(i&&i.length>1){const e=[];for(const t of i){let[i,r]=t;i-=n.x,r-=n.y,i*=a,r*=a,i+=o-.5,r+=o-.5,e.push([i,r])}if(t.asFill){const t=e.length-1;e[0][0]===e[t][0]&&e[0][1]===e[t][1]||e.push(e[0])}h.push(e)}const u=function(t,e,i,r){const n=e*i,o=new Array(n),s=r*r+1;for(let t=0;t<n;++t)o[t]=s;for(const n of t){const t=n.length;for(let s=1;s<t;++s){const t=n[s-1],a=n[s];let l,c,h,u;t[0]<a[0]?(l=t[0],c=a[0]):(l=a[0],c=t[0]),t[1]<a[1]?(h=t[1],u=a[1]):(h=a[1],u=t[1]);let f=Math.floor(l)-r,p=Math.floor(c)+r,m=Math.floor(h)-r,d=Math.floor(u)+r;f<0&&(f=0),p>e&&(p=e),m<0&&(m=0),d>i&&(d=i);const y=a[0]-t[0],_=a[1]-t[1],x=y*y+_*_;for(let r=f;r<p;r++)for(let n=m;n<d;n++){let s,l,c=(r-t[0])*y+(n-t[1])*_;c<0?(s=t[0],l=t[1]):c>x?(s=a[0],l=a[1]):(c/=x,s=t[0]+c*y,l=t[1]+c*_);const h=(r-s)*(r-s)+(n-l)*(n-l),u=(i-n-1)*e+r;h<o[u]&&(o[u]=h)}}}for(let t=0;t<n;++t)o[t]=Math.sqrt(o[t]);return o}(h,l,c,o);return t.asFill&&function(t,e,i,r,n){for(const o of t){const t=o.length;for(let s=1;s<t;++s){const t=o[s-1],a=o[s];let l,c,h,u;t[0]<a[0]?(l=t[0],c=a[0]):(l=a[0],c=t[0]),t[1]<a[1]?(h=t[1],u=a[1]):(h=a[1],u=t[1]);let f=Math.floor(l),p=Math.floor(c)+1,m=Math.floor(h),d=Math.floor(u)+1;f<r&&(f=r),p>e-r&&(p=e-r),m<r&&(m=r),d>i-r&&(d=i-r);for(let o=m;o<d;++o){if(t[1]>o==a[1]>o)continue;const s=(i-o-1)*e;for(let e=f;e<p;++e)e<(a[0]-t[0])*(o-t[1])/(a[1]-t[1])+t[0]&&(n[s+e]=-n[s+e]);for(let t=r;t<f;++t)n[s+t]=-n[s+t]}}}}(h,l,c,o,u),[s(u,o),l,c]},e.getExtent=function(t){return t?t.rings?o(t.rings):t.paths?o(t.paths):i.isExtent(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null},e.getSDFInfo=function t(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":{const i=e.symbolLayers;return i&&1===i.length?t(i[0]):null}case"CIMVectorMarker":{const t=e.markerGraphics;if(!t||1!==t.length)return null;const i=t[0];if(!i)return null;const r=i.geometry;if(!r)return null;const n=i.symbol;return!n||"CIMPolygonSymbol"!==n.type&&"CIMLineSymbol"!==n.type?null:{geom:r,asFill:"CIMPolygonSymbol"===n.type}}case"sdf":return{geom:e.geom,asFill:e.asFill}}return null},e.getSDFMetrics=function(t,e,i,r,n){const[o,s,a,l]=t;if(a<o||l<s)return[0,0,0];const c=a-o,h=l-s,u=Math.floor(31.5),f=(128-2*(u+1))/Math.max(c,h),p=Math.round(c*f)+2*u,m=Math.round(h*f)+2*u;let d=1;e&&(d=m/f/(e.ymax-e.ymin));let y=0,_=0;if(r)if(n){if(e&&i&&e.ymax-e.ymin>0){const t=(e.xmax-e.xmin)/(e.ymax-e.ymin);y=r.x/(i*t),_=r.y/i}}else y=r.x,_=r.y;return y=.5*(e.xmax+e.xmin)+y*(e.xmax-e.xmin),_=.5*(e.ymax+e.ymin)+_*(e.ymax-e.ymin),y-=o,_-=s,y*=f,_*=f,y+=u,_+=u,[d,y/p-.5,-(_/m-.5)]},e.getSDFSymbol=function(t){const e=t.markerGraphics;if(!e||1!==e.length)return null;const i=e[0];if(!i)return null;const r=i.symbol;return!r||"CIMPolygonSymbol"!==r.type&&"CIMLineSymbol"!==r.type?null:r},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},30453:(t,e,i)=>{var r,n;r=[e,i(73227),i(73462),i(9720),i(27006),i(46674),i(90920),i(80476),i(53391),i(51361),i(29305)],void 0===(n=function(t,i,r,n,o,s,a,l,c,h,u){"use strict";const f=r.getLogger("esri.symbols.cim.cimAnalyzer");function p(t){switch(t){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function m(t){switch(t){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function d(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function y(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function _(t,e,i,r){let n;t[e]?n=t[e]:(n={},t[e]=n),n[i]=r}function x(t){const e=t.markerPlacement;return e&&e.angleToLine?1:0}function g(t,e,r,n,o){const s=t.primitiveName,a=l.fromCIMColor(t.color),c=i.numericHash(JSON.stringify(t)).toString();o.push({type:"fill",templateHash:c,materialHash:0===r.length?c:()=>c,cim:t,materialOverrides:null,colorLocked:t.colorLocked,color:z(s,e,"Color",n,a,A),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t.effects})}function M(t,e,r,n,o){const s=t.primitiveName,a=t.tintColor?l.fromCIMColor(t.tintColor):{r:255,g:255,b:255,a:1},c=i.numericHash(JSON.stringify(t)).toString(),h=i.numericHash(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();o.push({type:"fill",templateHash:c,materialHash:0===r.length?h:()=>h,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,color:z(s,e,"TintColor",n,a,A),height:z(s,e,"Height",n,t.height),scaleX:z(s,e,"ScaleX",n,t.scaleX),angle:z(s,e,"Rotation",n,t.rotation),offsetX:z(s,e,"OffsetX",n,t.offsetX),offsetY:z(s,e,"OffsetY",n,t.offsetY)})}function b(t,e,r,n,o){const s=["Rotation","OffsetX","OffsetY"],a=r.filter((e=>e.primitiveName!==t.primitiveName&&-1===s.indexOf(e.propertyName))),l=t.primitiveName,c=i.numericHash(JSON.stringify(t)).toString(),h=i.numericHash(`${t.separation}${JSON.stringify(t.lineSymbol)}`).toString();o.push({type:"fill",templateHash:c,materialHash:0===r.length?h:R(h,e,a,n),cim:t,materialOverrides:a,colorLocked:t.colorLocked,effects:t.effects,color:{r:255,g:255,b:255,a:1},height:z(l,e,"Separation",n,t.separation),scaleX:1,angle:z(l,e,"Rotation",n,t.rotation),offsetX:z(l,e,"OffsetX",n,t.offsetX),offsetY:z(l,e,"OffsetY",n,t.offsetY)})}function v(t,e,r,n,o){const s=i.numericHash(JSON.stringify(t)).toString();o.push({type:"fill",templateHash:s,materialHash:0===r.length?s:R(s,e,r,n),cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function w(t,e,r,n,o,s,a){const c=i.numericHash(JSON.stringify(t)).toString(),h=t.primitiveName,u=l.fromCIMColor(t.color),f=void 0!==t.width?t.width:4,d=p(t.capStyle),y=m(t.joinStyle),_=t.miterLimit;o.push({type:"line",templateHash:c,materialHash:0===r.length?c:()=>c,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:t.effects,color:z(h,e,"Color",n,u,A),width:z(h,e,"Width",n,f),cap:z(h,e,"CapStyle",n,d),join:z(h,e,"JoinStyle",n,y),miterLimit:z(h,e,"MiterLimit",n,_),referenceWidth:a,zOrder:D(t.name),isDashed:!1})}function S(t,e,r,n,o,s,a){const c=i.numericHash(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString(),h=t.primitiveName,u=l.fromCIMColor(t.tintColor),f=void 0!==t.width?t.width:4,d=p(t.capStyle),y=m(t.joinStyle),_=t.miterLimit,x=i.numericHash(JSON.stringify(t)).toString();o.push({type:"line",templateHash:x,materialHash:0===r.length?c:()=>c,cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:t.effects,color:z(h,e,"TintColor",n,u,A),width:z(h,e,"Width",n,f),cap:z(h,e,"CapStyle",n,d),join:z(h,e,"JoinStyle",n,y),miterLimit:z(h,e,"MiterLimit",n,_),referenceWidth:a,zOrder:D(t.name),isDashed:!1})}function C(t,e,r,n,o,s,a){const l=t.primitiveName,c=void 0!==t.width?t.width:4,h=p(t.capStyle),u=m(t.joinStyle),f=t.miterLimit,d=i.numericHash(JSON.stringify(t)).toString();o.push({type:"line",templateHash:d,materialHash:0===r.length?d:R(d,e,r,n),cim:t,materialOverrides:null,isOutline:s,colorLocked:t.colorLocked,effects:t.effects,color:{r:128,g:128,b:128,a:1},width:z(l,e,"Width",n,c),cap:z(l,e,"CapStyle",n,h),join:z(l,e,"JoinStyle",n,u),miterLimit:z(l,e,"MiterLimit",n,f),referenceWidth:a,zOrder:D(t.name),isDashed:!1})}function I(t,e,r,n,o){const s=t.markerPlacement;if(!s||"CIMMarkerPlacementInsidePolygon"!==s.type)return!1;const a=s,l=["Rotation","OffsetX","OffsetY"],c=r.filter((e=>e.primitiveName!==t.primitiveName&&-1===l.indexOf(e.propertyName))),h=i.numericHash(JSON.stringify(t)).toString();return o.push({type:"fill",templateHash:h,materialHash:0===r.length?h:R(h,e,c,n),cim:t,materialOverrides:c,colorLocked:t.colorLocked,effects:t.effects,color:{r:255,g:255,b:255,a:1},height:z(a.primitiveName,e,"StepY",n,a.stepY),scaleX:1,angle:z(a.primitiveName,e,"GridAngle",n,a.gridAngle),offsetX:z(a.primitiveName,e,"OffsetX",n,a.offsetX),offsetY:z(a.primitiveName,e,"OffsetY",n,a.offsetY)}),!0}function L(t,e,r,n,o,s,a){const c=t.primitiveName,h=t.size,u=t.scaleX,f=t.rotation,p=t.offsetX,m=t.offsetY,d=l.fromCIMColor(t.tintColor),y=i.numericHash(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();let _=!1,x="";for(const t of r)t.primitiveName===c&&(void 0!==t.value?x+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`:t.valueExpressionInfo&&(_=!0));o.push({type:"marker",templateHash:i.numericHash(JSON.stringify(t)+x).toString(),materialHash:_?()=>y:y,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:!1,alignment:s,size:z(c,e,"Size",n,h),scaleX:z(c,e,"ScaleX",n,u),rotation:z(c,e,"Rotation",n,f),offsetX:z(c,e,"OffsetX",n,p),offsetY:z(c,e,"OffsetY",n,m),color:z(c,e,"TintColor",n,d,A),anchorPoint:t.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:t.rotateClockwise,referenceSize:a,sizeRatio:1,markerPlacement:t.markerPlacement})}function P(t,e,i,r,n,o,s,a){const l=t.markerGraphics;if(!l)return;let c=0;if(t.scaleSymbolsProportionally){const e=t.frame;e&&(c=e.ymax-e.ymin)}for(const h of l)if(h){const l=h.symbol;if(!l)continue;switch(l.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":O(t,h,i,e,r,n,o,s,c,a);break;case"CIMTextSymbol":T(t,h,e,i,r,n,o,s,c)}}}function T(t,e,r,n,o,s,a,c,u){h.OverrideHelper.findApplicableOverrides(e,n,[]);const f=e.geometry;if(!("x"in f)||!("y"in f))return;const p=e.symbol,m=(_=p).underline?"underline":_.strikethrough?"line-through":"none";var _;const x=function(t){let e="normal",i="normal";if(t){const r=t.toLowerCase();-1!==r.indexOf("italic")?e="italic":-1!==r.indexOf("oblique")&&(e="oblique"),-1!==r.indexOf("bold")?i="bold":-1!==r.indexOf("light")&&(i="lighter")}return{style:e,weight:i}}(p.fontStyleName);p.font={family:p.fontFamilyName,decoration:m,...x};const g=t.frame,M=f.x-.5*(g.xmin+g.xmax),b=f.y-.5*(g.ymin+g.ymax),v=t.size/u,w=t.primitiveName,S=(p.height||0)*v,C=p.angle||0,I=((p.offsetX||0)+M)*v,L=((p.offsetY||0)+b)*v,P=l.fromCIMColor(h.CIMSymbolHelper.getFillColor(p));let T=l.fromCIMColor(h.CIMSymbolHelper.getStrokeColor(p)),O=h.CIMSymbolHelper.getStrokeWidth(p);O||(T=l.fromCIMColor(h.CIMSymbolHelper.getFillColor(p.haloSymbol)),O=p.haloSize*v);let k="";for(const t of n)t.primitiveName===w&&void 0!==t.value&&(k+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`);const D=JSON.stringify(t.effects)+Number(t.colorLocked)+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement),A=i.numericHash(JSON.stringify(e)+D+k).toString();s.push({type:"text",templateHash:A,materialHash:()=>i.numericHash(JSON.stringify(p.font)).toString(),cim:p,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,alignment:a,anchorPoint:{x:t.anchorPoint?t.anchorPoint.x:0,y:t.anchorPoint?t.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:p.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:z(w,r,"Size",o,S),angle:z(w,r,"Rotation",o,C),offsetX:z(w,r,"OffsetX",o,I),offsetY:z(w,r,"OffsetY",o,L),horizontalAlignment:d(p.horizontalAlignment),verticalAlignment:y(p.verticalAlignment),text:z(e.primitiveName,r,"TextString",o,e.textString,l._adjustTextCase,p.textCase),color:P,outlineColor:T,outlineSize:O,referenceSize:c,sizeRatio:1,markerPlacement:t.markerPlacement})}function O(t,e,r,n,o,s,a,c,f,p){const m=e.symbol,d=e.geometry;if(!d)return;const y=m.symbolLayers;if(!y)return;if(p)return void k(t,e,n,r,o,s,a,c,f);let _=y.length;for(;_--;){const p=y[_];if(p&&!1!==p.enable)switch(p.type){case"CIMSolidFill":case"CIMSolidStroke":{const m=u.getExtent(d);if(!m)continue;const[y,_,x]=u.getSDFMetrics(m,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),g="CIMSolidFill"===p.type,M={type:"sdf",geom:d,asFill:g},b=t.primitiveName,v=t.size,w=t.rotation||0,S=t.offsetX,C=t.offsetY,I=p.primitiveName,L=g?l.fromCIMColor(h.CIMSymbolHelper.getFillColor(p)):l.fromCIMColor(h.CIMSymbolHelper.getStrokeColor(p)),P=g?{r:0,g:0,b:0,a:0}:l.fromCIMColor(h.CIMSymbolHelper.getStrokeColor(p)),T=h.CIMSymbolHelper.getStrokeWidth(p);if(!g&&!T)break;let O=!1,k="";for(const t of r)t.primitiveName!==I&&t.primitiveName!==b||(void 0!==t.value?k+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`:t.valueExpressionInfo&&(O=!0));const D=JSON.stringify({...t,markerGraphics:null}),R=i.numericHash(JSON.stringify(M)).toString(),F={type:"marker",templateHash:i.numericHash(JSON.stringify(e)+JSON.stringify(p)+D+k).toString(),materialHash:O?()=>R:R,cim:M,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:a,anchorPoint:{x:_,y:x},isAbsoluteAnchorPoint:!1,size:z(t.primitiveName,n,"Size",o,v),rotation:z(t.primitiveName,n,"Rotation",o,w),offsetX:z(t.primitiveName,n,"OffsetX",o,S),offsetY:z(t.primitiveName,n,"OffsetY",o,C),scaleX:1,frameHeight:f,rotateClockwise:t.rotateClockwise,referenceSize:c,sizeRatio:y,color:z(I,n,"Color",o,L,A),outlineColor:z(I,n,"Color",o,P,A),outlineWidth:z(I,n,"Width",o,T),markerPlacement:t.markerPlacement};s.push(F);break}default:k(t,e,n,r,o,s,a,c,f)}}}function k(t,e,r,n,o,s,l,c,u){const f=function(t,e){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[e],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath,effects:t.effects}}(t,e);let p=[];const m=["Rotation","OffsetX","OffsetY"];p=n.filter((e=>e.primitiveName!==t.primitiveName||-1===m.indexOf(e.propertyName)));let d="";for(const t of n)void 0!==t.value&&(d+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`);const[y,_,x]=h.CIMSymbolHelper.getTextureAnchor(f),g=t.primitiveName,M=t.rotation||0,b=t.offsetX||0,v=t.offsetY||0,w=i.numericHash(JSON.stringify(f)+d).toString(),S={type:"marker",templateHash:w,materialHash:0===p.length?w:R(w,r,p,o),cim:f,materialOverrides:p,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:y,y:_},isAbsoluteAnchorPoint:!1,size:t.size,rotation:z(g,r,"Rotation",o,M),offsetX:z(g,r,"OffsetX",o,b),offsetY:z(g,r,"OffsetY",o,v),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:u,rotateClockwise:t.rotateClockwise,referenceSize:c,sizeRatio:x/a.pt2px(t.size),markerPlacement:t.markerPlacement};s.push(S)}function D(t){if(t&&0===t.indexOf("Level_")){const e=parseInt(t.substr(6),10);if(NaN!==e)return e}return 0}function A(t){if(!t||0===t.length)return null;const e=new s(t).toRgba();return{r:e[0],g:e[1],b:e[2],a:e[3]}}function z(t,e,i,r,n,s,a){const l=e[t];if(l){const t=l[i];if("string"==typeof t||"number"==typeof t||t instanceof Array)return s?s.call(null,t,a):t;if(null!=t&&t instanceof o.ArcadeExpression)return(e,i,o)=>{let l=c(t,e,{$view:o},r.geometryType,i);return null!==l&&s&&(l=s.call(null,l,a)),null!==l?l:n}}return n}function R(t,e,r,n){for(const t of r)if(t.valueExpressionInfo){const i=e[t.primitiveName]&&e[t.primitiveName][t.propertyName];i instanceof o.ArcadeExpression&&(t.fn=(t,e,r)=>c(i,t,{$view:r},n.geometryType,e))}return(e,n,o)=>{for(const t of r)t.fn&&(t.value=t.fn(e,n,o));return i.numericHash(t+h.OverrideHelper.buildOverrideKey(r)).toString()}}e.analyzeCIMResource=function(t,e){if(!e||0===e.length)return t;const i=JSON.parse(JSON.stringify(t));return h.OverrideHelper.applyOverrides(i,e),i},e.analyzeCIMSymbol=async function(t,e,i,r){const s=i||[];if(!t)return s;let a,l;const c={};if("CIMSymbolReference"!==t.type)return f.error("Expect cim type to be 'CIMSymbolReference'"),s;if(a=t.symbol,l=t.primitiveOverrides,l){const t=[];for(const i of l){const r=i.valueExpressionInfo;if(r&&e){const n=r.expression,s=o.createRendererExpression(n,e.spatialReference,e.fields).then((t=>{t&&_(c,i.primitiveName,i.propertyName,t)}));t.push(s)}else null!=i.value&&_(c,i.primitiveName,i.propertyName,i.value)}await n.all(t)}switch(a.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(t,e,i,r,n,o){if(!t)return;const s=t.symbolLayers;if(!s)return;let a;const l=h.CIMSymbolHelper.getSize(t);"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(a=1);let c=s.length;for(;c--;){const u=s[c];if(!u||!1===u.enable)continue;const p=[];switch(h.OverrideHelper.findApplicableOverrides(u,e,p),u.type){case"CIMSolidFill":g(u,i,p,r,n);break;case"CIMPictureFill":M(u,i,p,r,n);break;case"CIMHatchFill":b(u,i,p,r,n);break;case"CIMGradientFill":v(u,i,p,r,n);break;case"CIMSolidStroke":w(u,i,p,r,n,"CIMPolygonSymbol"===t.type,l);break;case"CIMPictureStroke":S(u,i,p,r,n,"CIMPolygonSymbol"===t.type,l);break;case"CIMGradientStroke":C(u,i,p,r,n,"CIMPolygonSymbol"===t.type,l);break;case"CIMCharacterMarker":if(I(u,i,p,r,n))break;break;case"CIMPictureMarker":if(I(u,i,p,r,n))break;"CIMLineSymbol"===t.type&&(a=x(u)),L(u,i,p,r,n,a,l);break;case"CIMVectorMarker":if(I(u,i,p,r,n))break;"CIMLineSymbol"===t.type&&(a=x(u)),P(u,i,p,r,n,a,l,o);break;default:f.error("Cannot analyze CIM layer",u.type)}}}(a,l,c,e,s,r)}return s},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},88309:(t,e,i)=>{var r,n;r=[e,i(9720),i(9397),i(40125),i(30453),i(12279)],void 0===(n=function(t,i,r,n,o,s){"use strict";const a=async(t,e)=>new s.ExpandedCIM(await o.analyzeCIMSymbol(t.data,e),t.data,t.rendererKey),l=async(t,e,i)=>{if(!t)return null;if("cim"===t.type)return a(t,e);if("web-style"===t.type){const n=r.fromJSON(t),o={type:"cim",data:(await n.fetchCIMSymbol(i)).data,rendererKey:t.rendererKey};return a(o,e)}return t};e.expandSymbol=l,e.expandSymbols=async(t,e,r)=>i.all(t.map((t=>l(t,e,r)))),Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},88479:(t,e,i)=>{var r,n;r=[e,i(5258),i(26597),i(21270)],void 0===(n=function(t,i,r,n){"use strict";let o=function(){function t(){}return t.executeEffects=function(t,e){const o=i.cloneAndDecodeGeometry(e);let s=new r.SimpleGeometryCursor(o);for(const e of t){const t=n.getEffectOperator(e);t&&(s=t.execute(s,e,1.3333333333333333))}return s},t.next=function(t){const e=t.next();return i.deltaEncodeGeometry(e),e},t}();e.CIMEffectHelper=o,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},85558:(t,e,i)=>{var r,n;r=[e,i(5258),i(21270)],void 0===(n=function(t,i,r){"use strict";let n=function(){function t(){}return t.getPlacement=function(t,e,n){const o=r.getPlacementOperator(e);if(!o)return null;const s=i.cloneAndDecodeGeometry(t);return o.execute(s,e,n)},t}();e.CIMMarkerPlacementHelper=n,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},53391:(t,e,i)=>{var r,n;r=[i(73462),i(49359),i(5999)],void 0===(n=function(t,e,i){"use strict";const r=new Map;return function(n,o,s,a,l){const c=n.referencesGeometry()&&l?function(n,o,s){const{transform:a,hasZ:l,hasM:c}=s;r.has(o)||r.set(o,function(r){const n={};switch(r){case"esriGeometryPoint":return(t,e,r,o)=>i.unquantizePoint(e,n,t,r,o);case"esriGeometryPolygon":return(t,e,r,o)=>i.unquantizePolygon(e,n,t,r,o);case"esriGeometryPolyline":return(t,e,r,o)=>i.unquantizePolyline(e,n,t,r,o);case"esriGeometryMultipoint":return(t,e,r,o)=>i.unquantizeMultipoint(e,n,t,r,o);default:return t.getLogger("esri.views.2d.support.arcadeOnDemand").error(new e("mapview-arcade",`Unable to handle geometryType: ${r}`)),t=>t}}(o));const h=r.get(o)(n.geometry,a,l,c);return{...n,geometry:h}}(o,a,l):o,h=n.repurposeFeature(c);try{return n.evaluate({...s,$feature:h})}catch(e){return t.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}}.apply(e,r))||(t.exports=n)},99227:(t,e,i)=>{var r;void 0===(r=function(){"use strict";return function(){function t(){this.vertexData=new Map,this.vertexCount=0,this.indexData=[]}var e=t.prototype;return e.clear=function(){this.vertexData.clear(),this.vertexCount=0,this.indexData=[]},e.update=function(t,e,i){for(const e in t)this.vertexData.set(e,t[e]);for(const e in this.vertexData)null===t[e]&&this.vertexData.delete(e);this.vertexCount=e,this.indexData=i},t}()}.call(e,i,e,t))||(t.exports=r)},55534:(t,e,i)=>{var r,n;r=[i(74125),i(29726),i(51722)],void 0===(n=function(t,e,i){"use strict";return function(){function r(t){this.insertAfter=null,this.id=t,this.displayRecords=[],this.metrics=[]}var n=r.prototype;return n.copy=function(){const t=new r(this.id);return t.set(this),t},n.clone=function(){const t=new r(this.id);return t.displayRecords=this.displayRecords.map((t=>t.clone())),t.metrics=this.metrics.map((t=>t.clone())),t.insertAfter=this.insertAfter,t},n.set=function(t){this.id=t.id,this.displayRecords=t.displayRecords,this.metrics=t.metrics,this.insertAfter=t.insertAfter},n.serialize=function(t){return t.push(this.id),e.serializeList(t,this.metrics),e.serializeList(t,this.displayRecords),t},r.deserialize=function(n){const o=n.readInt32(),s=new r(o),a={id:o},l=e.deserializeList(n,i);return l.length&&(s.metrics=l),s.displayRecords=e.deserializeList(n,t,a),s},r}()}.apply(e,r))||(t.exports=n)},74125:(t,e,i)=>{var r,n;r=[i(58797),i(20780),i(99227)],void 0===(n=function(t,e,i){"use strict";return function(){function r(t,e,i,r=0,n=0){this.id=t,this.geometryType=e,this.materialKey=i,this.minZoom=r,this.maxZoom=n,this.meshData=null,this.symbolLevel=0,this.zOrder=0,this.vertexFrom=0,this.vertexCount=0,this.indexFrom=0,this.indexCount=0}var n=r.prototype;return n.clone=function(){return this.copy()},n.copy=function(){const t=new r(this.id,this.geometryType,this.materialKey);return t.vertexFrom=this.vertexFrom,t.vertexCount=this.vertexCount,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t.zOrder=this.zOrder,t.symbolLevel=this.symbolLevel,t.meshData=this.meshData,t.minZoom=this.minZoom,t.maxZoom=this.maxZoom,t},n.setMeshDataFromBuffers=function(t,r,n){const o=new i;for(const i in r){const n=r[i].stride,s=r[i].data,a=[],l=e.strideToPackingFactor(n);for(let e=0;e<n*t.vertexCount/l;++e)a[e]=s[e+n*t.vertexFrom/l];o.vertexData.set(i,a)}o.indexData.length=0;for(let e=0;e<t.indexCount;++e)o.indexData[e]=n[e+t.indexFrom]-t.vertexFrom;o.vertexCount=t.vertexCount,this.meshData=o},n.readMeshDataFromBuffers=function(t,r){this.meshData?this.meshData.clear():this.meshData=new i;for(const i in t){const r=t[i].stride,n=t[i].data,o=[],s=e.strideToPackingFactor(r);for(let t=0;t<r*this.vertexCount/s;++t)o[t]=n[t+r*this.vertexFrom/s];this.meshData.vertexData.set(i,o)}this.meshData.indexData.length=0;for(let t=0;t<this.indexCount;++t)this.meshData.indexData[t]=r[t+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount},n.writeMeshDataToBuffers=function(t,i,r,n){for(const r in i){const n=i[r].stride,o=this.meshData.vertexData.get(r),s=i[r].data,a=e.strideToPackingFactor(n);for(let e=0;e<n*this.meshData.vertexCount/a;++e)s[e+n*t/a]=o[e]}for(let e=0;e<this.meshData.indexData.length;++e)n[e+r]=this.meshData.indexData[e]+t;this.vertexFrom=t,this.vertexCount=this.meshData.vertexCount,this.indexFrom=r,this.indexCount=this.meshData.indexData.length},r.writeAllMeshDataToBuffers=function(t,e,i){let r=0,n=0;for(const o of t)o.writeMeshDataToBuffers(r,e,n,i),r+=o.vertexCount,n+=o.indexCount},n._computeSortKey=function(){this._sortKey=(31&this.symbolLevel)<<12|(127&this.zOrder)<<4|7&this.geometryType},n.serialize=function(t){return t.push(this.geometryType),t.push(this.materialKey),t.push(this.vertexFrom),t.push(this.vertexCount),t.push(this.indexFrom),t.push(this.indexCount),t.push(this.minZoom),t.push(this.maxZoom),t},r.deserialize=function(t,e){const i=t.readInt32(),n=t.readInt32(),o=new r(e.id,i,n);return o.vertexFrom=t.readInt32(),o.vertexCount=t.readInt32(),o.indexFrom=t.readInt32(),o.indexCount=t.readInt32(),o.minZoom=t.readInt32(),o.maxZoom=t.readInt32(),o},t._createClass(r,[{key:"sortKey",get:function(){return void 0===this._sortKey&&this._computeSortKey(),this._sortKey}}]),r}()}.apply(e,r))||(t.exports=n)},51722:(t,e,i)=>{var r,n;r=[i(73462),i(39241),i(1422),i(74180),i(29726)],void 0===(n=function(t,e,i,r,n){"use strict";const o=t.getLogger("esri/views/2d/engine/webgl/collisions/Metric");return function(){function t(t,e,r,n,o){this.id=t,this.range=e,this.boxes=null,this.minZoom=-1,this.size=0,this.directionX=0,this.directionY=0,this.offsetX=0,this.offsetY=0,this.placementPadding=0,this.anchor=i.fromValues(r,n),this.baseZoom=o}var s=t.prototype;return s.add=function(t,e,i){t.x=t.x+e,t.y=t.y+i,this.bounds?this.boxes?(this.boxes.push(t),this.bounds.extend(t)):(this.boxes=[this.bounds,t],this.bounds=this.bounds.clone(),this.bounds.extend(t)):this.bounds=t},s.computeIndex=function(){const t=this.anchor[0],i=this.anchor[1],r=Math.floor(t/e.COLLISION_BUCKET_SIZE),n=Math.floor(i/e.COLLISION_BUCKET_SIZE);this.xBucket=r,this.yBucket=n;const o=e.TILE_SIZE/e.COLLISION_BUCKET_SIZE;if(this.hasVV)return this.xOverflow=o,void(this.yOverflow=o);this.xOverflow=Math.min(o,Math.ceil(2*this.bounds.width/e.COLLISION_BUCKET_SIZE)),this.yOverflow=Math.min(o,Math.ceil(2*this.bounds.height/e.COLLISION_BUCKET_SIZE))},s.findCollisionDelta=function(t){const i=this.bounds.findCollisionDelta(t.bounds),r=this.boxes&&this.boxes.length,n=t.boxes&&t.boxes.length;return Math.abs(i)>e.COLLISION_MAX_ZOOM_DELTA||!r&&!n?i:r&&n?this._boxesToBoxes(t):r?this._boxesToBox(t):this._boxToBoxes(t)},s.computeVVOffset=function(t,e){e||o.error("mapview-labeling",`Unable to compute label offset. Expected an evaluator function but found ${e}`);let i=this.size;if(this.hasVV){const r=e(t);i=isNaN(r)||null==r||r===1/0?this.size:r}this._computeOffset(i)},s.setPlacementOffset=function(t,e,i,r,n){this.hasVV=t,this.size=e,this.placementPadding=Math.round(i),this.directionX=r,this.directionY=n},s.clone=function(){const e=new t(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);return e.minZoom=this.minZoom,this.bounds&&(e.bounds=this.bounds.clone()),this.boxes&&(e.boxes=this.boxes.map((t=>t.clone()))),e.xBucket=this.xBucket,e.yBucket=this.yBucket,e.xOverflow=this.xOverflow,e.yOverflow=this.yOverflow,e.hasVV=this.hasVV,e.size=this.size,e.directionX=this.directionX,e.directionY=this.directionY,e.offsetX=this.offsetX,e.offsetY=this.offsetY,e},s._boxToBoxes=function(t){let e=-1/0;for(const i of t.boxes){const t=this.bounds.findCollisionDelta(i);e=Math.max(t,e)}return e},s._boxesToBox=function(t){let e=this.boxes[0].findCollisionDelta(t.bounds);for(let i=1;i<this.boxes.length;i++){const r=this.boxes[i].findCollisionDelta(t.bounds);e=Math.max(r,e)}return e},s._boxesToBoxes=function(t){let e=-1/0;for(let i=0;i<this.boxes.length;i++){const r=this.boxes[i];for(const i of t.boxes){const t=r.findCollisionDelta(i);e=Math.max(t,e)}}return e},s._computeOffset=function(t){this.offsetX=this.directionX*(t/2+this.placementPadding),this.offsetY=this.directionY*(t/2+this.placementPadding)},s.serialize=function(t){return t.push(this.id),this.bounds.serialize(t),t.push(this.range.from),t.push(this.range.count),t.push(this.anchor[0]),t.push(this.anchor[1]),t.push(this.baseZoom),t.push(this.hasVV?1:0),t.push(this.size),t.writeF32(this.directionX),t.writeF32(this.directionY),t.push(this.offsetX),t.push(this.offsetY),t.push(this.placementPadding),n.serializeList(t,this.boxes),t},t.deserialize=function(e){const i=e.readInt32(),o=r.deserialize(e),s={from:e.readInt32(),count:e.readInt32()},a=e.readInt32(),l=e.readInt32(),c=e.readInt32(),h=e.readInt32(),u=e.readInt32(),f=e.readF32(),p=e.readF32(),m=e.readInt32(),d=e.readInt32(),y=e.readInt32(),_=n.deserializeList(e,r),x=new t(i,s,a,l,c);return x.bounds=o,x.boxes=_,x.setPlacementOffset(!!h,u,y,f,p),x.offsetX=m,x.offsetY=d,x.computeIndex(),h||x._computeOffset(u),x},t}()}.apply(e,r))||(t.exports=n)},33151:(t,e,i)=>{var r,n;r=[e,i(58797),i(74125),i(29726),i(51722),i(55534),i(9610),i(60595)],void 0===(n=function(t,i,r,n,o,s,a,l){"use strict";let c=function(){function t(t,e){this.vertexVectorsMap=t,this._currentIndex=-1,this._currentRecordOffset=0,this._currentMetricOffset=0,this._currentMetrics=[];const i=4*(4*e.features+1),r=4*(8*e.records+1),n=4*(20*e.metrics+1);this._bufDisplayObjects=new l(Uint32Array,i+4),this._bufDisplayRecords=new l(Uint32Array,r+4),this._bufMetrics=new l(Uint32Array,n+4),this._bufDisplayObjects.push(0),this._bufDisplayRecords.push(0),this._bufMetrics.push(0)}var e=t.prototype;return e.get=function(t){return this.vertexVectorsMap[t]},e.currentDisplayRecordCount=function(){return this._bufDisplayRecords[this._currentRecordOffset]},e.writeDisplayObject=function(t,e){this._bufDisplayObjects.incr(0),this._currentIndex=this._bufDisplayObjects.push(t),this._bufDisplayObjects.push(e),this._bufDisplayObjects.push(0),this._bufDisplayObjects.push(0),this._currentRecordOffset=0,this._currentMetricOffset=0,this._currentMetrics=[]},e.hasDisplayRecords=function(){return!(0===this._currentRecordOffset)},e.endDisplayObject=function(){this.hasDisplayRecords()?this._currentMetrics&&(0===this._currentMetricOffset&&(this._bufDisplayObjects.setValue(this._currentIndex+3,this._bufMetrics.length),this._currentMetricOffset=this._bufMetrics.length),n.serializeList(this._bufMetrics,this._currentMetrics)):this._rollbackDisplayObject()},e.writeDisplayRecord=function(t,e,i,r,n,o,s=0,a=0){0===this._currentRecordOffset&&(this._currentRecordOffset=this._bufDisplayRecords.push(0),this._bufDisplayObjects.setValue(this._currentIndex+2,this._currentRecordOffset)),this._bufDisplayRecords.incr(this._currentRecordOffset),this._bufDisplayRecords.push(t),this._bufDisplayRecords.push(e),this._bufDisplayRecords.push(i),this._bufDisplayRecords.push(r),this._bufDisplayRecords.push(n),this._bufDisplayRecords.push(o),this._bufDisplayRecords.push(s),this._bufDisplayRecords.push(a)},e.writeMetrics=function(t){t&&this._currentMetrics.push(...t)},t.deserializeDisplayObjects=function(t){const{bufDisplayObjects:e,bufMetrics:i,bufRecords:l}=t,c=new a(e),h=new a(l),u=new a(i),f=[];let p=c.readInt32();for(h.readInt32(),u.readInt32();p--;){const t=c.readInt32(),e=c.readInt32(),i=c.readInt32(),a=c.readInt32(),l=new s(t);0!==e&&(l.insertAfter=e),0!==i&&(l.displayRecords=n.deserializeList(h,r,{id:t})),0!==a&&(l.metrics=n.deserializeList(u,o)),f.push(l)}return f},e.encode=function(t,e){const i={};for(let t=0;t<this.vertexVectorsMap.length;t++){const r=this.vertexVectorsMap[t];i[t]={},r.transfer(i[t],e)}t.bufDisplayObjects=this._bufDisplayObjects.buffer(),t.bufRecords=this._bufDisplayRecords.buffer(),t.bufMetrics=this._bufMetrics.buffer(),e.push(t.bufDisplayObjects),e.push(t.bufMetrics),e.push(t.bufRecords),t.vertexBuffersMap=i,this.destroy()},e.destroy=function(){this.vertexVectorsMap=null,this._bufDisplayObjects=null,this._bufDisplayRecords=null,this._bufMetrics=null},e._rollbackDisplayObject=function(){this._bufDisplayObjects.decr(0),this._bufDisplayObjects.seek(this._bufDisplayObjects.length-4),this._currentIndex=this._bufDisplayObjects.length},i._createClass(t,[{key:"vertexBuffersMap",get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(let t=0;t<this.vertexVectorsMap.length;t++)this._vertexBuffersMap[t]=this.vertexVectorsMap[t].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap}}]),t}();e.MeshData=c,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},28862:(t,e,i)=>{var r,n;r=[e,i(20780)],void 0===(n=function(t,i){"use strict";let r=function(){function t(t,e,i){this.data=t,this.stride=e,this.vertexCount=i}return t.decode=function(e){return new t(i.allocateTypedArrayBufferwithData(e.data,e.stride),e.stride,e.vertexCount)},t.fromVertexVector=function(e){return new t(i.allocateTypedArrayBufferwithData(e.data.buffer(),e.stride),e.stride,e.vertexCount)},t}(),n=function(){function t(t,e,i){this.geometryType=t,this.indexBuffer=new Uint32Array(e),this.namedBuffers=i}return t.decode=function(e){const i=e.geometryType,n=e.indexBuffer,o={};for(const t in e.namedBuffers)o[t]=r.decode(e.namedBuffers[t]);return new t(i,n,o)},t.fromVertexVectors=function(e){const i=e.geometryType,n=e.indexVector.buffer(),o={};for(const t in e.namedVectors)o[t]=r.fromVertexVector(e.namedVectors[t]);return new t(i,n,o)},t}();e.VertexBuffers=n,e.default=r,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},53564:(t,e,i)=>{var r,n;r=[e,i(58797),i(20780),i(60595),i(28862)],void 0===(n=function(t,i,r,n,o){"use strict";let s=function(){function t(t,e){this.data=t,this.stride=e}return t.prototype.transfer=function(t,e){const i=this.data.buffer();t.vertexCount=this.vertexCount,t.data=i,t.stride=this.stride,e.push(i)},i._createClass(t,[{key:"vertexCount",get:function(){const t=this.stride/4,e=this.data.length/t;return e!==(0|e)&&console.debug("Corrupted stride"),e}}]),t}(),a=function(){function t(t,e,i=!1){this.geometryType=t,this.indexVector=new n(Uint32Array,6*e),this.namedVectors={};const o=r.getStrides(t,i);for(const t in o){const i=o[t];let r;switch(i%4){case 0:case 2:r=new n(Uint32Array,i*e);break;case 1:case 3:r=new n(Uint8Array,i*e)}this.namedVectors[t]=new s(r,i)}}var e=t.prototype;return e.get=function(t){return this.namedVectors[t].data},e.getVector=function(t){return this.namedVectors[t]},e.transfer=function(t,e){const i=this.indexVector.buffer(),r={};e.push(i);for(const t in this.namedVectors){const i=this.namedVectors[t];r[t]={},i.transfer(r[t],e)}t.geometryType=this.geometryType,t.indexBuffer=i,t.namedBuffers=r,this.destroy()},e.intoBuffers=function(){const t=o.VertexBuffers.fromVertexVectors(this);return this.destroy(),t},e.destroy=function(){this.indexVector=null,this.namedVectors=null},t}();e.VertexVectors=a,e.default=s,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},6953:(t,e)=>{var i;void 0===(i=function(t){"use strict";function i(t,e,i,r,n,o,s){let c;if(s===function(t,e,i,r,n,o){let s=0;for(let i=r,a=n-o;i<n;i+=o)s+=(t[a+e*o]-t[i+e*o])*(t[i+1+e*o]+t[a+1+e*o]),a=i;return s}(t,e,0,r,n,o)>0)for(let i=r;i<n;i+=o)c=a(i+e*o,t[i+e*o],t[i+1+e*o],c);else for(let i=n-o;i>=r;i-=o)c=a(i+e*o,t[i+e*o],t[i+1+e*o],c);return c&&_(c,c.next)&&(l(c),c=c.next),c}function r(t,e=t){if(!t)return t;let i,r=t;do{if(i=!1,r.steiner||!_(r,r.next)&&0!==f(r.prev,r,r.next))r=r.next;else{if(l(r),r=e=r.prev,r===r.next)break;i=!0}}while(i||r!==e);return e}function n(t,e,i,a,c,h,f,p){if(!t)return;!p&&h&&(t=u(t,a,c,h));let m=t;for(;t.prev!==t.next;){const u=t.prev,d=t.next;if(h?s(t,a,c,h):o(t))e.push(u.index/i+f),e.push(t.index/i+f),e.push(d.index/i+f),l(t),t=d.next,m=d.next;else if((t=d)===m){p?1===p?n(t=g(t,e,i,f),e,i,a,c,h,f,2):2===p&&M(t,e,i,a,c,h,f):n(r(t),e,i,a,c,h,f,1);break}}}function o(t){const e=t.prev,i=t,r=t.next;if(f(e,i,r)>=0)return!1;let n=t.next.next;const o=n;let s=0;for(;n!==t.prev&&(0===s||n!==o);){if(s++,m(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&f(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function s(t,e,i,r){const n=t.prev,o=t,s=t.next;if(f(n,o,s)>=0)return!1;const a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,l=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,c=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,h=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,u=y(a,l,e,i,r),p=y(c,h,e,i,r);let d=t.prevZ,_=t.nextZ;for(;d&&d.z>=u&&_&&_.z<=p;){if(d!==t.prev&&d!==t.next&&m(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&f(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,_!==t.prev&&_!==t.next&&m(n.x,n.y,o.x,o.y,s.x,s.y,_.x,_.y)&&f(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&m(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&f(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;_&&_.z<=p;){if(_!==t.prev&&_!==t.next&&m(n.x,n.y,o.x,o.y,s.x,s.y,_.x,_.y)&&f(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function a(t,e,i,r){const n=w.create(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function l(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function c(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function h(t,e){if(e=function(t,e){let i=e;const r=t.x,n=t.y;let o,s=-1/0;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){const t=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=r&&t>s){if(s=t,t===r){if(n===i.y)return i;if(n===i.next.y)return i.next}o=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!o)return null;if(r===s)return o.prev;const a=o,l=o.x,c=o.y;let h,u=1/0;for(i=o.next;i!==a;)r>=i.x&&i.x>=l&&r!==i.x&&m(n<c?r:s,n,l,c,n<c?s:r,n,i.x,i.y)&&(h=Math.abs(n-i.y)/(r-i.x),(h<u||h===u&&i.x>o.x)&&d(i,t)&&(o=i,u=h)),i=i.next;return o}(t,e)){const i=v(e,t);r(i,i.next)}}function u(t,e,i,r){for(let n;n!==t;n=n.next){if(n=n||t,null===n.z&&(n.z=y(n.x,n.y,e,i,r)),n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,u(t,e,i,r);n.prevZ=n.prev,n.nextZ=n.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,i=1;for(;;){let r,n=t;t=null,e=null;let o=0;for(;n;){o++,r=n;let s=0;for(;s<i&&r;s++)r=r.nextZ;let a=i;for(;s>0||a>0&&r;){let i;0===s?(i=r,r=r.nextZ,a--):0!==a&&r?n.z<=r.z?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,s--),e?e.nextZ=i:t=i,i.prevZ=e,e=i}n=r}if(e.nextZ=null,i*=2,o<2)return t}}(t)}function f(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function p(t,e,i,r){return!!(_(t,e)&&_(i,r)||_(t,r)&&_(i,e))||f(t,e,i)>0!=f(t,e,r)>0&&f(i,r,t)>0!=f(i,r,e)>0}function m(t,e,i,r,n,o,s,a){return(n-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(n-s)*(r-a)>=0}function d(t,e){return f(t.prev,t,t.next)<0?f(t,e,t.next)>=0&&f(t,t.prev,e)>=0:f(t,e,t.prev)<0||f(t,t.next,e)<0}function y(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _(t,e){return t.x===e.x&&t.y===e.y}function x(t,e){return t.x-e.x}function g(t,e,i,r){let n=t;do{const o=n.prev,s=n.next.next;!_(o,s)&&p(o,n,n.next,s)&&d(o,s)&&d(s,o)&&(e.push(o.index/i+r),e.push(n.index/i+r),e.push(s.index/i+r),l(n),l(n.next),n=t=s),n=n.next}while(n!==t);return n}function M(t,e,i,o,s,a,l){let c=t;do{let t=c.next.next;for(;t!==c.prev;){if(c.index!==t.index&&b(c,t)){let h=v(c,t);return c=r(c,c.next),h=r(h,h.next),n(c,e,i,o,s,a,l,0),void n(h,e,i,o,s,a,l,0)}t=t.next}c=c.next}while(c!==t)}function b(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let i=t;do{if(i.index!==t.index&&i.next.index!==t.index&&i.index!==e.index&&i.next.index!==e.index&&p(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&d(t,e)&&d(e,t)&&function(t,e){let i=t,r=!1;const n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function v(t,e){const i=w.create(t.index,t.x,t.y),r=w.create(e.index,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}let w=function(){function t(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return t.create=function(t,e,i){const r=S[C++];return r.index=t,r.x=e,r.y=i,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r},t}();const S=new Array;let C=0;for(let t=0;t<8096;t++)S.push(new w);e.bufcut=function(t,e,o,s,a,l,u){C=0;const f=(s-o)*l,p=a&&a.length,m=p?(a[0]-o)*l:f;let d,y,_,g,M,b=i(e,o,0,0,m,l,!0);if(b&&b.next!==b.prev){if(p&&(b=function(t,e,n,o,s,a){const l=new Array;for(let r=0,s=o.length;r<s;r++){const h=i(t,e,0,o[r]*a,r<s-1?o[r+1]*a:n*a,a,!1);h===h.next&&(h.steiner=!0),l.push(c(h))}l.sort(x);for(const t of l)h(t,s),s=r(s,s.next);return s}(e,o,s,a,b,l)),f>80*l){d=_=e[0+o*l],y=g=e[1+o*l];for(let t=l;t<m;t+=l){const i=e[t+o*l],r=e[t+1+o*l];d=Math.min(d,i),y=Math.min(y,r),_=Math.max(_,i),g=Math.max(g,r)}M=Math.max(_-d,g-y),M=0!==M?1/M:0}n(b,t,l,d,y,M,u,0)}},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,[e]))||(t.exports=i)},92131:(t,e,i)=>{var r,n;r=[e,i(58797),i(74637),i(3718),i(9720),i(39241),i(53183),i(33151),i(53564),i(35281),i(67435),i(85294)],void 0===(n=function(t,i,r,n,o,s,a,l,c,h,u,f){"use strict";let p=function(){function t(t,e,i){this._isDD=!1,this._geometryType=t,this._idField=e,this._templateStore=i}var e=t.prototype;return e.update=function(t,e){this._isDD="simple"===t.mesh.matcher.type&&t.mesh.matcher.isDotDensity,n.isSome(t.mesh.labels)&&this._setLabelTemplates(t.mesh.labels,e)},e._setLabelTemplates=function(t,e){this._labelTemplates=t.map((t=>h.fromLabelClass(t,e)))},e.createMeshData=function(t){const e=new Array(5),i=this._labelTemplates&&this._labelTemplates.length>0,r="esriGeometryPolyline"===this._geometryType?s.HEURISTIC_GLYPHS_PER_LINE:s.HEURISTIC_GLYPHS_PER_FEATURE;return e[a.WGLGeometryType.MARKER]=new c.VertexVectors(a.WGLGeometryType.MARKER,4*t),e[a.WGLGeometryType.FILL]=new c.VertexVectors(a.WGLGeometryType.FILL,t,this._isDD),e[a.WGLGeometryType.LINE]=new c.VertexVectors(a.WGLGeometryType.LINE,t),e[a.WGLGeometryType.TEXT]=new c.VertexVectors(a.WGLGeometryType.TEXT,4*t),e[a.WGLGeometryType.LABEL]=new c.VertexVectors(a.WGLGeometryType.LABEL,i?4*r:0),new l.MeshData(e,{features:t,records:t,metrics:0})},e.analyze=async function(t,e,i,r,n){if(o.isAborted(n))return;let s;"dictionary"===e.type&&(s=await e.analyze(this._idField,t.copy(),i,r,n));let a=0;for(;t.next();){let n;if(n=s?s[a++]:e.match(this._idField,t,this._geometryType,i,r),t.setGroupId(n),f.isDynamicId(n)){const e=this._templateStore.getDynamicTemplateGroup(n);for(const n of e)n&&n.analyze&&n.analyze(this._templateStore,t,i,r)}}return this._templateStore.finalize(n)},e.analyzeGraphics=async function(t,e,i,r,n){if(o.isAborted(n))return;const s=t.getCursor();for(e&&await e.analyze(this._idField,s.copy(),i,r,n);s.next();){let t=s.getGroupId();if(null!=t&&-1!==t||(t=e.match(this._idField,s,s.geometryType,i,r),s.setGroupId(t)),f.isDynamicId(t)){const e=this._templateStore.getDynamicTemplateGroup(t);for(const t of e)t&&t.analyze&&t.analyze(this._templateStore,s,i,r)}s.setGroupId(t)}return this._templateStore.finalize(n)},e.writeGraphic=function(t,e){const i=e.getGroupId(),r=e.getDisplayId(),n=this._templateStore.getTemplateGroup(i),o=e.geometryType;if(null!=r){if(f.isDynamicId(i))for(const t of n)t.bindFeature(e,null,null);if(n){t.writeDisplayObject(r,e.readGraphic().insertAfter);for(const i of n){if(!i)continue;const n=t.get(i.geometryType);i.writeMesh(t,n,e,o,r)}}}},e.writeCursor=function(t,e,i,r,o,s){const a=e.getGroupId(),l=e.getDisplayId(),c=this._templateStore.getTemplateGroup(a);if(null==l)return;if(!c)return;if(t.writeDisplayObject(l,0),f.isDynamicId(a))for(const t of c)t.bindFeature(e,i,r);for(const i of c){const r=t.get(i.geometryType);!i.needsPixelBuffer&&e.hasFilter()||i.writeMesh(t,r,e,this._geometryType,l)}const h=t.hasDisplayRecords();if(n.isSome(s)&&h){const i=s&&this._findLabelRef(c);this._writeLabels(t,e,l,s,i,o)}t.endDisplayObject()},e._findLabelRef=function(t){for(const e of t)if(e instanceof u)return e;return null},e._writeLabels=function(t,e,i,r,o,s){for(const a of r)if(n.isSome(a)&&a){const{glyphs:r,rtl:n,index:l}=a,c=this._labelTemplates[l],h=t.get(c.geometryType);c.bindReferenceTemplate(o),c.bindTextInfo(r,n),c.writeMesh(t,h,e,this._geometryType,i,s)}},i._createClass(t,[{key:"templates",get:function(){return this._templateStore}}]),t}();e.WGLMeshFactory=p,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},96899:(t,e,i)=>{var r,n;r=[e,i(73462),i(49359),i(43586)],void 0===(n=function(t,i,r,n){"use strict";const o=i.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");e.createMatcher=async function(t,e,i){switch(t.type){case"simple":return n.FeatureMatcher.fromBasicRenderer(t,e,i);case"map":return n.MapMatcher.fromUVRenderer(t,e,i);case"interval":return n.IntervalMatcher.fromCBRenderer(t,e,i);case"dictionary":return n.DictionaryMatcher.fromDictionaryRenderer(t,e,i);default:return o.error(new r("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},56011:(t,e,i)=>{var r,n;r=[i(58797),i(16985),i(74518),i(53183),i(26653),i(21816)],void 0===(n=function(t,e,i,r,n,o){"use strict";return s=>function(s){function a(...t){var e;return(e=s.call(this,...t)||this).forceLibtess=!1,e.geometryType=r.WGLGeometryType.FILL,e}t._inheritsLoose(a,s);var l=a.prototype;return l.writeMeshWithGeometry=function(t,i,r,s,a,l){const c=n.FillMaterialKey.load(this._materialKey),h=i.indexVector,u=i.getVector("geometry"),f=u.vertexCount,p=h.length;let m=l?e.deltaDecodeGeometry(e.convertFromGeometry(l),2):r.readUnquantizedGeometry();if(!m)return;if(m=o.clipMarshall(m),!m)return;let d=m.coords;!this.forceLibtess&&o.triangulate(h,m,f)||(d=[],o.triangulateLibtess(d,h,m,f)),this._write(u,r,a,d,c);const y=u.vertexCount-f,_=h.length-p;t.writeDisplayRecord(this.geometryType,this._materialKey,f,y,p,_)},l._write=function(t,e,r,n,o){for(let s=0;s<n.length;s+=2){const a=i.i1616to32(1*n[s],1*n[s+1]);t.data.push(a),t.data.push(r),o.dotDensity?t.data.writeF32(1/Math.abs(e.readGeometryArea())):(t.data.push(this.fillColor),t.data.push(this.tl),t.data.push(this.br),t.data.push(this.aux1),t.data.push(this.aux2),t.data.push(this.aux3))}},a}(s)}.apply(e,r))||(t.exports=n)},27045:(t,e,i)=>{var r,n;r=[i(58797),i(74637),i(39241),i(74518),i(53183),i(26653),i(10453),i(48535)],void 0===(n=function(t,e,i,r,n,o,s,a){"use strict";const l=-16,c=i.TILE_SIZE+16,h=31,u=1024,f=1/3.8,p=new s.TileClipper(0,0,0,1,16);p.setExtent(i.TILE_SIZE);const m=new Uint32Array(9),d=new Uint32Array(36),y=new Uint32Array(3),_=new Uint32Array(6),x=t=>e=>{const i=Math.ceil(u*t._halfWidth),n=Math.ceil(u*t._halfReferenceWidth);e.entry0=t.offset+t.vertexCount++;{const o=r.i1616to32(e.distance,i),s=r.i8888to32(Math.round(h*e.prevNormal.x),Math.round(h*e.prevNormal.y),Math.round(0),Math.round(-31)),a=r.i8888to32(0,0,0,t._bitset);d[0]=r.i1616to32(8*e.currentVertex.x,8*e.currentVertex.y),d[1]=t.id,d[2]=t._fillColor,d[3]=s,d[4]=o,d[5]=t._tl,d[6]=t._br,d[7]=a,d[8]=r.i1616to32(n,0)}e.entry2=t.offset+t.vertexCount++;{const o=r.i1616to32(e.distance,i),s=r.i8888to32(Math.round(h*-e.prevNormal.x),Math.round(h*-e.prevNormal.y),Math.round(0),Math.round(31)),a=r.i8888to32(0,0,0,t._bitset);d[9]=r.i1616to32(8*e.currentVertex.x,8*e.currentVertex.y),d[10]=t.id,d[11]=t._fillColor,d[12]=s,d[13]=o,d[14]=t._tl,d[15]=t._br,d[16]=a,d[17]=r.i1616to32(n,0)}e.exit0=t.offset+t.vertexCount++;{const o=r.i1616to32(e.distance,i),s=r.i8888to32(Math.round(h*e.nextNormal.x),Math.round(h*e.nextNormal.y),Math.round(0),Math.round(-31)),a=r.i8888to32(0,0,0,t._bitset);d[18]=r.i1616to32(8*e.currentVertex.x,8*e.currentVertex.y),d[19]=t.id,d[20]=t._fillColor,d[21]=s,d[22]=o,d[23]=t._tl,d[24]=t._br,d[25]=a,d[26]=r.i1616to32(n,0)}e.exit2=t.offset+t.vertexCount++;{const o=r.i1616to32(e.distance,i),s=r.i8888to32(Math.round(h*-e.nextNormal.x),Math.round(h*-e.nextNormal.y),Math.round(0),Math.round(31)),a=r.i8888to32(0,0,0,t._bitset);d[27]=r.i1616to32(8*e.currentVertex.x,8*e.currentVertex.y),d[28]=t.id,d[29]=t._fillColor,d[30]=s,d[31]=o,d[32]=t._tl,d[33]=t._br,d[34]=a,d[35]=r.i1616to32(n,0)}t.geometryBuf.writeRegion(d)},g=t=>e=>{_[0]=e.leftExit0,_[1]=e.rightEntry0,_[2]=e.leftExit2,_[3]=e.rightEntry0,_[4]=e.rightEntry2,_[5]=e.leftExit2,t.indexCount+=6,t.indexBuf.writeRegion(_)},M=t=>(e,i,n,o,s,a,l,c,f)=>{const p=r.i1616to32(f,Math.ceil(u*t._halfWidth)),d=r.i8888to32(Math.round(h*s),Math.round(h*a),Math.round(h*l),Math.round(h*c)),y=r.i8888to32(h*n,h*o,0,t._bitset);return m[0]=r.i1616to32(8*e,8*i),m[1]=t.id,m[2]=t._fillColor,m[3]=d,m[4]=p,m[5]=t._tl,m[6]=t._br,m[7]=y,m[8]=r.i1616to32(Math.ceil(u*t._halfReferenceWidth),0),t.geometryBuf.writeRegion(m),t.offset+t.vertexCount++};return e=>function(e){function r(...t){var i;return(i=e.call(this,...t)||this).tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null},i._tessellationOptions={},i.geometryType=n.WGLGeometryType.LINE,i}t._inheritsLoose(r,e);var s=r.prototype;return s.writeMeshWithGeometry=function(t,e,i,r,n,o){const s=e.indexVector,a=e.get("geometry"),l=e.getVector("geometry").vertexCount,c=s.length,h=null!=o?o:i.readLegacyGeometry();if(!h)return;switch(r){case"esriGeometryPolyline":{const t=this._clipLines(h.paths);if(0===t.length)return;this._write(s,a,l,n,t);break}case"esriGeometryPolygon":{const t=this._clipLines(h.rings);if(0===t.length)return;this._write(s,a,l,n,t);break}}const u=this.tessellationProperties.vertexCount,f=this.tessellationProperties.indexCount;t.writeDisplayRecord(this.geometryType,this._materialKey,l,u,c,f)},s._clipLines=function(t){const e=[];let i=!1,r=0;for(;r<t.length;){const n=[],o=t[r];p.reset(2);let[s,a]=o[0];if(i)p.moveTo(s,a);else{if(s<l||s>c||a<l||a>c){i=!0;continue}n.push({x:s,y:a})}let h=!1;const u=o.length;for(let t=1;t<u;++t)if(s+=o[t][0],a+=o[t][1],i)p.lineTo(s,a);else{if(s<l||s>c||a<l||a>c){h=!0;break}n.push({x:s,y:a})}if(h)i=!0;else{if(i){const t=p.resultWithStarts();if(t)for(const i of t)e.push(i)}else e.push({line:n,start:0});r++,i=!1}}return e},s._write=function(t,e,i,r,n){this.tessellationProperties.id=r,this.tessellationProperties.indexBuf=t,this.tessellationProperties.indexCount=0,this.tessellationProperties.geometryBuf=e,this.tessellationProperties.vertexCount=0,this.tessellationProperties.offset=i;for(const t of n){const e=t.line;e.length<2||(this._tessellationOptions.initialDistance=t.start%65535,this._tessellationCallbacks instanceof a.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),a.tessellate(e,this._tessellationOptions,this._tessellationCallbacks),a.cleanup())}},s._initializeTessellator=function(t){const e=o.LineMaterialKey.load(this._materialKey);if(this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern,this._tessellationOptions.thin=!t&&this.tessellationProperties._halfWidth<i.THIN_LINE_THRESHOLD/2&&!(e.vvSizeFieldStops||e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeUnitValue),this._tessellationOptions.wrapDistance=65535,this._tessellationOptions.outerBisectorAutoSplitThreshold=f,this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern,this._tessellationOptions.innerBisectorAutoSplitThreshold=f,this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern,this._tessellationOptions.thin)this._tessellationCallbacks={vertex:x(this.tessellationProperties),bridge:g(this.tessellationProperties)};else{const t=new a.StandardTessellationCallbacks(M(this.tessellationProperties),(t=>(e,i,r)=>{y[0]=e,y[1]=i,y[2]=r,t.indexCount+=3,t.indexBuf.writeRegion(y)})(this.tessellationProperties));t.miterLimitCosine=this._miterLimitCosine,t.textured=this._isDashed||this._hasPattern,t.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=t}},r}(e)}.apply(e,r))||(t.exports=n)},48163:(t,e,i)=>{var r,n;r=[i(58797),i(3718),i(90920),i(16985),i(10709),i(68904),i(38970),i(1422),i(74518),i(53183),i(85558)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c,h){"use strict";const u=3.14159265359/180;return f=>function(f){function p(...t){var e;return(e=f.call(this,...t)||this).angle=0,e.xOffset=0,e.yOffset=0,e.width=0,e.height=0,e.boundsType="square",e._anchorX=0,e._anchorY=0,e._computedWidth=0,e._computedHeight=0,e.geometryType=c.WGLGeometryType.MARKER,e}t._inheritsLoose(p,f);var m=p.prototype;return m.writeMeshWithGeometry=function(t,i,n,o,s,a){const l=i.indexVector,c=i.get("geometry"),h=i.getVector("geometry"),u=h.vertexCount,f=u,p=l.length;if(e.isSome(this._markerPlacement)){const t=null!=a?a:n.readLegacyGeometry();this._writePlacedMarkers(c,l,u,s,t)}else{const t=a?r.deltaDecodeGeometry(r.convertFromGeometry(a),2):"esriGeometryPolygon"===o?n.readCentroid():n.readUnquantizedGeometry();if(!t)return;if(t.isPoint){const[e,i]=t.coords;this._writeVertices(c,s,this._getPos(e,i)),this._writeIndices(l,u)}else t.forEachVertex(((t,e)=>{const i=h.vertexCount;this._writeVertices(c,s,this._getPos(t,e)),this._writeIndices(l,i)}))}const m=i.getVector("geometry").vertexCount-f,d=l.length-p;t.writeDisplayRecord(this.geometryType,this._materialKey,f,m,p,d)},m._applyTransformation=function(t,e,i=0){o.identity(t),o.translate(t,t,a.fromValues(this.xOffset,-this.yOffset)),this.angle+i!==0&&o.rotate(t,t,u*(this.angle+i));const r=this._computedWidth,s=this._computedHeight,c=(this._anchorX-.5)*r,h=(this._anchorY-.5)*s;n.set(e,c,h),n.transformMat2d(e,e,t),this._offsetUpperLeft=l.i1616to32(16*e[0],16*e[1]),n.set(e,c+r,h),n.transformMat2d(e,e,t),this._offsetUpperRight=l.i1616to32(16*e[0],16*e[1]),n.set(e,c,h+s),n.transformMat2d(e,e,t),this._offsetBottomLeft=l.i1616to32(16*e[0],16*e[1]),n.set(e,c+r,h+s),n.transformMat2d(e,e,t),this._offsetBottomRight=l.i1616to32(16*e[0],16*e[1])},m._writePlacedMarkers=function(t,r,n,o,l){const c=h.CIMMarkerPlacementHelper.getPlacement(l,e.unwrap(this._markerPlacement),i.pt2px(1));if(!c)return;const f=a.create(),p=s.create();let m=0,d=c.next();for(;null!=d;)d.tx>=-128&&d.tx<=640&&d.ty>=-128&&d.ty<=640&&(this._applyTransformation(p,f,d.getAngle()/u),this._writeVertices(t,o,this._getPos(d.tx,d.ty)),this._writeIndices(r,n+m),m+=4),d=c.next()},m._getPos=function(t,e){return l.i1616to32(Math.round(8*t),Math.round(8*e))},m._writeVertices=function(t,e,i){t.push(i),t.push(this._offsetUpperLeft),t.push(this._texUpperLeft),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),t.push(i),t.push(this._offsetUpperRight),t.push(this._texUpperRight),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),t.push(i),t.push(this._offsetBottomLeft),t.push(this._texBottomLeft),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),t.push(i),t.push(this._offsetBottomRight),t.push(this._texBottomRight),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth)},m._writeIndices=function(t,e){const i=e;t.push(i+0),t.push(i+1),t.push(i+2),t.push(i+1),t.push(i+3),t.push(i+2)},p}(f)}.apply(e,r))||(t.exports=n)},37713:(t,e,i)=>{var r,n;r=[i(58797),i(3718),i(90920),i(16985),i(39241),i(74518),i(35561),i(53183),i(26653),i(85558)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c){"use strict";return h=>function(h){function u(...t){var e;return(e=h.call(this,...t)||this)._isCIM=!1,e.geometryType=a.WGLGeometryType.TEXT,e._aux=o.i8888to32(0,0,e._referenceSize,e._bitset),e}t._inheritsLoose(u,h);var f=u.prototype;return f.bindTextInfo=function(t,i){t&&t.length?this._shapingInfo=e.andThen(t,(t=>s.shapeGlyphs(t,i,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:n.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM}))):this._shapingInfo=null},f.writeMeshWithGeometry=function(t,i,n,o,s,a){if(e.isSome(this._textPlacement)){const e=null!=a?a:n.readLegacyGeometry();return this._writePlacedText(t,i,s,e)}const l=a?r.deltaDecodeGeometry(r.convertFromGeometry(a),2):"esriGeometryPolygon"===o?n.readCentroid():n.readUnquantizedGeometry();if(l){if(l.isPoint){const[e,r]=l.coords;return this._writeGlyphs(t,i,s,{x:e,y:r})}l.forEachVertex(((e,r)=>this._writeGlyphs(t,i,s,{x:e,y:r})))}},f._writePlacedText=function(t,r,n,s){const a=this._shapingInfo;if(e.isNone(a))return;const h=l.MaterialKeyBase.load(this._materialKey),u=e.unwrap(this._textPlacement),f=c.CIMMarkerPlacementHelper.getPlacement(s,u,i.pt2px(1));if(!f)return;let p,m,d=f.next();for(;null!=d;){m=o.i1616to32(Math.round(8*d.tx),Math.round(8*d.ty)),p=d.getAngle(),a.setRotation(p);for(const e of a.glyphs){h.textureBinding=e.textureBinding;const i=r.getVector("geometry").vertexCount,o=r.indexVector.length,s=this._writeIndices(r),a=this._writeVertex(r,n,m,e);t.writeDisplayRecord(this.geometryType,h.data,i,a,o,s)}a.setRotation(-p),d=f.next()}},f._writeGlyphs=function(t,i,r,n){const s=this._shapingInfo;if(e.isNone(s))return;const a=l.MaterialKeyBase.load(this._materialKey),c=o.i1616to32(Math.round(8*n.x),Math.round(8*n.y));for(const e of s.glyphs){a.textureBinding=e.textureBinding;const n=i.getVector("geometry").vertexCount,o=i.indexVector.length,s=this._writeIndices(i),l=this._writeVertex(i,r,c,e);t.writeDisplayRecord(this.geometryType,a.data,n,l,o,s)}},f._writeVertexCommon=function(t,e,i,r){const n=this._color,s=this._haloColor,a=o.i8888to32(0,0,this._referenceSize,this._bitset),l=o.i8888to32(0,0,this._size,this._haloSize);t.push(i),t.push(e),t.push(n),t.push(s),t.push(l),t.push(a)},f._writeVertex=function(t,e,i,r){const n=t.get("geometry");return this._writeVertexCommon(n,e,i,r),n.push(r.offsets.upperLeft),n.push(r.texcoords.upperLeft),this._writeVertexCommon(n,e,i,r),n.push(r.offsets.upperRight),n.push(r.texcoords.upperRight),this._writeVertexCommon(n,e,i,r),n.push(r.offsets.lowerLeft),n.push(r.texcoords.lowerLeft),this._writeVertexCommon(n,e,i,r),n.push(r.offsets.lowerRight),n.push(r.texcoords.lowerRight),4},f._writeIndices=function(t){const e=t.getVector("geometry").vertexCount,i=t.indexVector;return i.push(e+0),i.push(e+1),i.push(e+2),i.push(e+1),i.push(e+3),i.push(e+2),6},u}(h)}.apply(e,r))||(t.exports=n)},16697:(t,e,i)=>{var r,n;r=[i(58797),i(3438),i(90920),i(39241),i(74518),i(26653),i(31581),i(6578),i(14657),i(31160),i(56011),i(89681)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c,h,u){"use strict";const f=128;return function(h){function u(t){var e;if(e=h.call(this,t)||this,c.isFunction(t.color)){const i=(e,i,r)=>{const n=t.color(e,i,r);return n&&s.premultiplyAlphaRGBA(n)||0};e._dynamicPropertyMap.set("_fillColor",i)}else{const i=t.color;e.fillColor=i&&s.premultiplyAlphaRGBA(i)||0}let r=0;c.isFunction(t.height)||(r=t.height||0),e._dynamicPropertyMap.set("_height",((e,i,n)=>c.isFunction(t.height)?t.height(e,i,n):r));let n=0;c.isFunction(t.offsetX)||(n=i.pt2px(t.offsetX||0)+f,n>255&&(n=255)),e._dynamicPropertyMap.set("_offsetX",((e,r,o)=>{if(c.isFunction(t.offsetX)){let n=i.pt2px(t.offsetX(e,r,o))+f;return n>255&&(n=255),n}return n}));let l=1;c.isFunction(t.scaleX)||(l=t.scaleX||1),e._dynamicPropertyMap.set("_scaleX",((e,i,r)=>c.isFunction(t.scaleX)?t.scaleX(e,i,r):l));let u=0;c.isFunction(t.offsetY)||(u=i.pt2px(-t.offsetY||0)+f,u>255&&(u=255)),e._dynamicPropertyMap.set("_offsetY",((e,r,n)=>{if(c.isFunction(t.offsetY)){let o=i.pt2px(-t.offsetY(e,r,n))+f;return o>255&&(o=255),o}return u}));let p=0;return c.isFunction(t.angle)||(p=a.radToByte(t.angle)||0),e._dynamicPropertyMap.set("_angle",((e,i,r)=>c.isFunction(t.angle)?a.radToByte(t.angle(e,i,r)):p)),e.effects=t.effects,e._cimFillLayer=t,e._fillMaterialKey=o.FillMaterialKey.load(t.materialKey),e}return t._inheritsLoose(u,h),u.fromCIMFill=function(t){return new u(t)},u.prototype.bindFeature=function(t,o,s){const a=t.readLegacyFeature();this._dynamicPropertyMap.forEach(((t,e)=>{this[e]=t(a,o,s)}));const c=this._fillMaterialKey,h=this._materialCache,u=this._cimFillLayer;this.aux3=n.i8888to32(0,0,this._angle,u.colorLocked?1:0);const p=(0,u.materialHash)(a,o,s),m=h.get(p);let d=null;if(m&&l.ok(m.spriteMosaicItem)&&(d=m.spriteMosaicItem),d){const{rect:t,width:o,height:s}=d,a=t.x+r.SPRITE_PADDING,l=t.y+r.SPRITE_PADDING,h=a+o,u=l+s;let p=e.nextHighestPowerOfTwo(i.pt2px(this._height));p>255?p=255:p<=0&&(p=e.nextHighestPowerOfTwo(u-l));let m=e.nextHighestPowerOfTwo(i.pt2px(this._height/s*o||0));m>255?m=255:m<=0&&(m=e.nextHighestPowerOfTwo(h-a));const y=this._scaleX,_=1;this.tl=n.i1616to32(a,l),this.br=n.i1616to32(h,u),this.aux1=n.i8888to32(m,p,this._offsetX,this._offsetY),this.aux2=n.i1616to32(f*y,f*_),c.sdf=d.sdf,c.pattern=!0,c.textureBinding=d.textureBinding}else this.tl=0,this.br=0,this.aux1=0,this.aux2=0,c.sdf=!1,c.pattern=!1,c.textureBinding=0;this._materialKey=c.data},u}(h(u))}.apply(e,r))||(t.exports=n)},24513:(t,e,i)=>{var r,n;r=[i(58797),i(90920),i(39241),i(74518),i(26653),i(31581),i(14657),i(31160),i(89681),i(27045)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c){"use strict";return function(l){function c(t){var i;(i=l.call(this,t)||this)._cimLineLayer=t;let r=0;if(a.isFunction(t.width)||(r=.5*e.pt2px(t.width)),i._dynamicPropertyMap.set("_halfWidth",((i,n,o)=>a.isFunction(t.width)?.5*e.pt2px(t.width(i,n,o)):r)),a.isFunction(t.cap)?i._dynamicPropertyMap.set("_capType",t.cap):i._capType=t.cap,a.isFunction(t.join)?i._dynamicPropertyMap.set("_joinType",t.join):i._joinType=t.join,a.isFunction(t.color)){const e=(e,i,r)=>{const n=t.color(e,i,r);return n&&o.premultiplyAlphaRGBA(n)||0};i._dynamicPropertyMap.set("_fillColor",e)}else{const e=t.color;i._fillColor=e&&o.premultiplyAlphaRGBA(e)||0}if(a.isFunction(t.miterLimit)){const e=(e,i,r)=>a.getLimitCosine(t.miterLimit(e,i,r));i._dynamicPropertyMap.set("_miterLimitCosine",e)}else i._miterLimitCosine=a.getLimitCosine(t.miterLimit);return i._scaleFactor=t.scaleFactor||1,i._isDashed=t.isDashed,i.effects=t.effects,i.tessellationProperties._bitset=t.colorLocked?1:0,i._materialKey=t.materialKey,i._initializeTessellator(!0),i}return t._inheritsLoose(c,l),c.fromCIMLine=function(t){return new c(t)},c.prototype.bindFeature=function(t,e,o){const a=t.readLegacyFeature();this._dynamicPropertyMap.forEach(((t,i)=>{this[i]=t(a,e,o)})),this._halfWidth*=this._scaleFactor;const l=this._materialCache,c=(0,this._cimLineLayer.materialHash)(a,e,o),h=l.get(c);let u=null;if(h&&s.ok(h.spriteMosaicItem)&&(u=h.spriteMosaicItem),u){this._hasPattern=!0;const{rect:t,width:e,height:n}=u,o=t.x+i.SPRITE_PADDING,s=t.y+i.SPRITE_PADDING,a=o+e,l=s+n;this.tessellationProperties._tl=r.i1616to32(o,s),this.tessellationProperties._br=r.i1616to32(a,l)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;const f=n.LineMaterialKey.load(this._materialKey);u&&(f.sdf=u.sdf,f.pattern=!0,f.textureBinding=u.textureBinding),this._materialKey=f.data},c}(c(l))}.apply(e,r))||(t.exports=n)},95059:(t,e,i)=>{var r,n;r=[i(58797),i(3718),i(73462),i(49359),i(90920),i(39241),i(38970),i(1422),i(74518),i(26653),i(31581),i(14657),i(31160),i(48163),i(89681)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c,h,u,f,p,m){"use strict";const d=a.create(),y=s.create(),_=i.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(i){function s(t){var r;if((r=i.call(this,t)||this)._cimMarkerLayer=t,f.isFunction(t.color)){const e=(e,i,r)=>h.premultiplyAlphaRGBA(t.color(e,i,r));r._dynamicPropertyMap.set("_fillColor",e)}else r._fillColor=h.premultiplyAlphaRGBA(t.color);if(f.isFunction(t.outlineColor)){const e=(e,i,r)=>h.premultiplyAlphaRGBA(t.outlineColor(e,i,r));r._dynamicPropertyMap.set("_outlineColor",e)}else r._outlineColor=h.premultiplyAlphaRGBA(t.outlineColor);if(f.isFunction(t.size)){const e=(e,i,r)=>n.pt2px(t.size(e,i,r));r._dynamicPropertyMap.set("_size",e)}else r._size=n.pt2px(t.size);if(f.isFunction(t.scaleX)?r._dynamicPropertyMap.set("_scaleX",t.scaleX):r._scaleX=t.scaleX,f.isFunction(t.offsetX)){const e=(e,i,r)=>n.pt2px(t.offsetX(e,i,r));r._dynamicPropertyMap.set("xOffset",e)}else r.xOffset=n.pt2px(t.offsetX);if(f.isFunction(t.offsetY)){const e=(e,i,r)=>n.pt2px(t.offsetY(e,i,r));r._dynamicPropertyMap.set("yOffset",e)}else r.yOffset=n.pt2px(t.offsetY);if(f.isFunction(t.outlineWidth)){const e=(e,i,r)=>n.pt2px(t.outlineWidth(e,i,r));r._dynamicPropertyMap.set("_outlineWidth",e)}else r._outlineWidth=n.pt2px(t.outlineWidth);return f.isFunction(t.rotation)?r._dynamicPropertyMap.set("_angle",t.rotation):r._angle=t.rotation,r._scaleFactor=e.unwrapOr(t.scaleFactor,1),r._markerPlacement=t.markerPlacement,r.effects=t.effects,r._bitSet=(1===t.alignment?1:0)|(t.colorLocked?1:0)<<1|(t.scaleSymbolsProportionally?1:0)<<3,r._materialKey=t.materialKey,r}return t._inheritsLoose(s,i),s.fromCIMMarker=function(t){return new s(t)},s.prototype.bindFeature=function(t,e,i){const s=t.readLegacyFeature();this._dynamicPropertyMap.forEach(((t,r)=>{this[r]=t(s,e,i)}));const a=this._cimMarkerLayer.materialHash,h="function"==typeof a?a(s,e,i):a,f=this._materialCache.get(h);if(!f||!u.ok(f.spriteMosaicItem)||!f.spriteMosaicItem)return void _.error(new r("mapview-cim","Encountered an error when binding feature"));const p=f.spriteMosaicItem,m=this._cimMarkerLayer.sizeRatio,x=p.width/p.height*this._scaleX,g=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle;let M=this._size,b=M*x;const v=this.xOffset,w=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;const S=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/n.pt2px(this._cimMarkerLayer.frameHeight):1,C=this._outlineWidth*S,I=n.pt2px(this._cimMarkerLayer.referenceSize);let L=0,P=0;const T=this._cimMarkerLayer.anchorPoint;T&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(L=-T.x/(this._size*x),P=T.y/this._size):(L=T.x,P=T.y)),this._sizeOutlineWidth=l.i8888to32(Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*M),255)),Math.round(Math.min(Math.sqrt(128*C),255)),Math.round(Math.min(Math.sqrt(128*I),255))),this.angle=g;const O=Math.round(Math.min(64*m,255));this._bitestAndDistRatio=l.i8888to32(0,0,this._bitSet,O);const k=p.rect.x+o.SPRITE_PADDING,D=p.rect.y+o.SPRITE_PADDING,A=k+p.width,z=D+p.height;this._texUpperLeft=l.i1616to32(k,D),this._texUpperRight=l.i1616to32(A,D),this._texBottomLeft=l.i1616to32(k,z),this._texBottomRight=l.i1616to32(A,z);const R=c.MarkerMaterialKey.load(this._materialKey);R.sdf=p.sdf,R.pattern=!0,R.textureBinding=p.textureBinding,this._materialKey=R.data,this._anchorX=.5-(.5+L)*p.width/p.width,this._anchorY=.5-(.5+P)*p.height/p.height,b*=m,M*=m,b*=this._scaleFactor,M*=this._scaleFactor,b*=p.rect.width/p.width,M*=p.rect.height/p.height,this._computedWidth=b,this._computedHeight=M,this._applyTransformation(y,d),this.xOffset=v,this.yOffset=w},s}(p(m))}.apply(e,r))||(t.exports=n)},89681:(t,e,i)=>{var r,n;r=[i(58797),i(73462),i(9720),i(30453),i(79855)],void 0===(n=function(t,e,i,r,n){"use strict";const o=e.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(e){function n(t){var i;return(i=e.call(this)||this)._ongoingMaterialRequestMap=new Map,i._materialCache=new Map,i._dynamicPropertyMap=new Map,i._cimLayer=t,i}return t._inheritsLoose(n,e),n.prototype.analyze=function(t,e,n,s){const a=e.readLegacyFeature(),l=this._materialCache,c=this._cimLayer.materialHash;if(!c)return o.error("A Dynamic mesh template must have a material hash value or function!"),i.reject(null);const h="function"==typeof c?c(a,n,s):c;if(l.has(h)){const t=l.get(h);return i.resolve(t)}if(this._ongoingMaterialRequestMap.has(h))return this._ongoingMaterialRequestMap.get(h);const u=r.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);u.mosaicHash=h;const f=t.getMosaicItem(u).then((t=>(this._ongoingMaterialRequestMap.delete(h),l.set(h,t),t))).catch((t=>(this._ongoingMaterialRequestMap.delete(h),o.error(".analyze()",t.message),null)));return this._ongoingMaterialRequestMap.set(h,f),f},n}(n)}.apply(e,r))||(t.exports=n)},3457:(t,e,i)=>{var r,n;r=[i(58797),i(90920),i(81901),i(26653),i(31581),i(31160),i(37713),i(89681),i(35872)],void 0===(n=function(t,e,i,r,n,o,s,a,l){"use strict";return function(s){function a(t){var i;(i=s.call(this,t)||this)._horizontalAlignment="center",i._verticalAlignment="middle",i._textToGlyphs=new Map;const a=t.scaleFactor||1;if(i._cimTextLayer=t,o.isFunction(t.color)){const e=(e,i,r)=>n.premultiplyAlphaRGBA(t.color(e,i,r));i._dynamicPropertyMap.set("_color",e)}else i._color=n.premultiplyAlphaRGBA(t.color);if(o.isFunction(t.color)){const e=(e,i,r)=>n.premultiplyAlphaRGBA(t.outlineColor(e,i,r));i._dynamicPropertyMap.set("_haloColor",e)}else i._haloColor=n.premultiplyAlphaRGBA(t.outlineColor);let l,c,h;if(o.isFunction(t.size)||(l=Math.min(Math.round(e.pt2px(t.size*t.sizeRatio)),127)),i._dynamicPropertyMap.set("_size",((i,r,n)=>o.isFunction(t.size)?Math.min(Math.round(e.pt2px(t.size(i,r,n)*t.sizeRatio)),127):l)),o.isFunction(t.outlineSize)){const r=(i,r,n)=>Math.min(Math.floor(5*e.pt2px(t.outlineSize(i,r,n)*t.sizeRatio)),127);i._dynamicPropertyMap.set("_haloSize",r)}else i._haloSize=Math.min(Math.floor(5*e.pt2px(t.outlineSize*t.sizeRatio)),127);o.isFunction(t.offsetX)||(c=Math.round(e.pt2px(t.offsetX*t.sizeRatio))),i._dynamicPropertyMap.set("_xOffset",((i,r,n)=>o.isFunction(t.offsetX)?Math.round(e.pt2px(t.offsetX(i,r,n)*t.sizeRatio)):c)),o.isFunction(t.offsetY)||(h=Math.round(e.pt2px(t.offsetY*t.sizeRatio))),i._dynamicPropertyMap.set("_yOffset",((i,r,n)=>o.isFunction(t.offsetY)?Math.round(e.pt2px(t.offsetY(i,r,n)*t.sizeRatio)):h)),o.isFunction(t.angle)?i._dynamicPropertyMap.set("_angle",t.angle):i._angle=t.angle,o.isFunction(t.horizontalAlignment)?i._dynamicPropertyMap.set("_horizontalAlignment",t.horizontalAlignment):i._horizontalAlignment=t.horizontalAlignment,o.isFunction(t.verticalAlignment)?i._dynamicPropertyMap.set("_verticalAlignment",t.verticalAlignment):i._verticalAlignment=t.verticalAlignment,i._scaleFactor=a,o.isFunction(t.text)?i._dynamicPropertyMap.set("_text",t.text):i._text=t.text;const u=Math.min(Math.round(e.pt2px(t.referenceSize*t.sizeRatio)),127);i._referenceSize=Math.round(Math.sqrt(256*u)),i._materialKey=t.materialKey;const f=r.TextMaterialKey.load(i._materialKey);return f.sdf=!0,i._bitset=(1===t.alignment?1:0)|(t.colorLocked?1:0)<<1,i._materialKey=f.data,i._decoration="none",i._lineHeight=1,i._lineWidth=512,i._textPlacement=t.markerPlacement,i.effects=t.effects,i._isCIM=!0,i}t._inheritsLoose(a,s),a.fromCIMText=function(t){return new a(t)};var c=a.prototype;return c.analyze=async function(t,e,i,r){const n=e.readLegacyFeature(),o=function(t,e,i,r){return"string"==typeof t.text?t.text:"function"==typeof t.text?t.text(e,i,r):""}(this._cimTextLayer,n,i,r),s=await t.getMosaicItem(this._cimTextLayer.cim,l.codepoints(o));return this._textToGlyphs.set(o,s.glyphMosaicItems),s},c.bindFeature=function(t,e,r){const n=t.readLegacyFeature();if(this._dynamicPropertyMap.forEach(((t,i)=>{this[i]=t(n,e,r)})),!this._text||0===this._text.length)return void(this._shapingInfo=null);this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=i.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=i.getYAnchorDirection(this._verticalAlignment||"baseline");const o=this._textToGlyphs.get(this._text);this.bindTextInfo(o,!1)},a}(s(a))}.apply(e,r))||(t.exports=n)},60566:(t,e,i)=>{var r,n;r=[i(58797),i(3438),i(90920),i(39241),i(74518),i(26653),i(31581),i(6578),i(79855),i(56011)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c){"use strict";const h=128;return function(l){function c(t,e,i,r,n,s,a,c,h){var u;(u=l.call(this)||this).effects=h;const f=o.FillMaterialKey.load(t);return e&&(f.sdf=e.sdf,f.pattern=!0,f.textureBinding=e.textureBinding),u.fillColor=i,u.tl=r,u.br=n,u.aux1=s,u.aux2=a,u.aux3=c,u._materialKey=f.data,u}return t._inheritsLoose(c,l),c.fromCIMFill=function(t,o){const l=t.color,u=l&&s.premultiplyAlphaRGBA(l)||0,f=t.materialKey;if(!o)return new c(f,null,u,0,0,0,0,n.i8888to32(0,0,0,t.colorLocked?1:0),t.effects);const{rect:p,width:m,height:d}=o,y=p.x+r.SPRITE_PADDING,_=p.y+r.SPRITE_PADDING,x=y+m,g=_+d;let M=e.nextHighestPowerOfTwo(i.pt2px(t.height||0));M>255?M=255:M<=0&&(M=e.nextHighestPowerOfTwo(g-_));let b=e.nextHighestPowerOfTwo(i.pt2px(t.height/d*m||0));b>255?b=255:b<=0&&(b=e.nextHighestPowerOfTwo(x-y));let v=i.pt2px(t.offsetX||0)+h;v>255&&(v=255);let w=i.pt2px(-t.offsetY||0)+h;w>255&&(w=255);const S=t.scaleX||1;return new c(f,o,u,n.i1616to32(y,_),n.i1616to32(x,g),n.i8888to32(b,M,v,w),n.i1616to32(h*S,128),n.i8888to32(0,0,a.degToByte(t.angle),t.colorLocked?1:0),t.effects)},c.fromSimpleFill=function(t,i,o=!1){const{color:a}=t,l=a&&"esriSFSNull"!==t.style&&s.premultiplyAlphaRGBAArray(a)||0,u=n.i8888to32(0,0,0,o?255:0),f=t.materialKey;if(!i)return new c(f,null,l,0,0,0,0,u,null);const{rect:p,width:m,height:d}=i,y=p.x+r.SPRITE_PADDING,_=p.y+r.SPRITE_PADDING,x=y+m,g=_+d;return new c(f,i,l,n.i1616to32(y,_),n.i1616to32(x,g),n.i8888to32(e.nextHighestPowerOfTwo(x-y),e.nextHighestPowerOfTwo(g-_),0,0),n.i1616to32(h,h),u,null)},c.fromPictureFill=function(t,o,s=!1){const a=r.PICTURE_FILL_COLOR,{rect:l,width:u,height:f}=o,p=l.x+r.SPRITE_PADDING,m=l.y+r.SPRITE_PADDING,d=p+u,y=m+f,_=n.i1616to32(p,m),x=n.i1616to32(d,y);let g=e.nextHighestPowerOfTwo(i.pt2px(t.width));g>255&&(g=255);let M=e.nextHighestPowerOfTwo(i.pt2px(t.height));M>255&&(M=255);let b=i.pt2px(t.xoffset)+h;b>255&&(b=255);let v=i.pt2px(-t.yoffset)+h;v>255&&(v=255);const w=n.i8888to32(g,M,b,v),S=n.i1616to32(h*t.xscale,h*t.yscale),C=n.i8888to32(0,0,0,s?255:0);return new c(t.materialKey,o,a,_,x,w,S,C,null)},c}(c(l))}.apply(e,r))||(t.exports=n)},35281:(t,e,i)=>{var r,n;r=[i(58797),i(3718),i(73462),i(49359),i(3438),i(90920),i(39241),i(81901),i(74518),i(53183),i(1291),i(26653),i(31581),i(51722),i(1831),i(62638)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c,h,u,f,p,m,d){"use strict";const y=i.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),_=function(t){const e=new Map;return t=>(e.has(t)||e.set(t,(t=>{let e=0;if(0===t)return 1/0;for(;!(t%2);)e++,t/=2;return e})(t)),e.get(t))}(),x=t=>Math.floor(127*t+127),g=t=>Math.floor(10*t),M=t=>Math.round(t*(254/360)),b=(t,e)=>l.i1616to32(Math.round(8*t),Math.round(8*e));return function(i){function d(t,e,r,l){var p;(p=i.call(this,t,r.font.size,r.haloSize||0,r.color&&f.premultiplyAlphaRGBAArray(r.color)||0,r.haloColor&&f.premultiplyAlphaRGBAArray(r.haloColor)||0,r.horizontalAlignment,r.verticalAlignment,h.isMapAligned(e.labelPlacement)?1:0,r.font.decoration,!1,r.angle||0,r.xoffset,r.yoffset,r.lineWidth,r.lineHeight,null,null)||this)._outLineLabelAngle=0,p._refPlacementPadding=0,p._refPlacementDirX=0,p._refPlacementDirY=0,p._refOffsetX=0,p._refOffsetY=0,p.geometryType=c.WGLGeometryType.LABEL;const m=function(t,e){const i=!!t.minScale&&e.scaleToZoom(t.minScale)||0;return n.clamp(i,0,25.5)}(e,l),d=function(t,e){const i=!!t.maxScale&&e.scaleToZoom(t.maxScale)||255;return n.clamp(i,0,25.5)}(e,l),y=e.labelPlacement,[_,x]=a.getAlignmentFromPlacement(y);p._xAlignD=_,p._yAlignD=x,p._minZoom=m,p._maxZoom=d,p._refPlacementPadding=o.pt2px(r.haloSize)+s.TEXT_PLACEMENT_PADDING;const g=u.LabelMaterialKey.load(t);return g.sdf=!0,p._materialKey=g.data,p}t._inheritsLoose(d,i),d.fromLabelClass=function(t,e){if("center-along"===t.labelPlacement){const e=t.symbol;e.xoffset=0,e.yoffset=0,e.angle=0,e.font.decoration="none"}return new d(t.materialKey,t,t.symbol,e)};var v=d.prototype;return v.bindReferenceTemplate=function(t){let i=a.getXDirection(this._xAlignD),r=a.getYDirection(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,e.isNone(t))return void(this._refSymbolAndPlacementOffset=l.i8888to32(0,0,x(i),x(r)));if("circle"===t.boundsType&&(i||r)){const t=Math.sqrt(i*i+r*r);i/=t,r/=t}const n=Math.max(t.height,t.width),o=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=l.i8888to32(o,n,x(i),x(r)),this._referenceSize=n,this._refPlacementDirX=i,this._refPlacementDirY=r,this._refOffsetX=t.xOffset,this._refOffsetY=t.yOffset},v.writeMesh=function(t,i,n,o,s,a){if(e.isNone(this._shapingInfo))return;const l=new Array,c=this._shapingInfo,h="esriGeometryPolygon"===n.geometryType?n.readLegacyCentroid():n.readLegacyGeometry();if(h){switch(this.current={out:t,outVecs:i,outMetrics:l,inId:s,inShaping:c,zoomLevel:a},o){case"esriGeometryPolyline":this._placeLineLabels(h);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(h);break;default:((t,e="mapview-labeling")=>{y.error(new r(e,t))})("mapview-labeling",`Geometry of type ${o} is not supported`)}t.writeMetrics(this.current.outMetrics)}},v._isVisible=function(t,e){const i=g(this.current.zoomLevel);return g(t)<=i&&i<=g(e)},v._placePointLabels=function(t){const{out:e,outVecs:i,outMetrics:r,inId:n}=this.current;this._writeGlyphs(e,i,n,t,r)},v._placeLineLabels=function(t){const e=m.smoothPaths(t.paths,this.current.inShaping.bounds.width),i=this._placeSubdivGlyphs.bind(this),r=(this._shapedBox.width+128)/4;for(const t of e)m.pathDivide(t,r,i)},v._placeSubdivGlyphs=function(t,e,i,r){const o=_(e),s=this._shapedBox.width/4,a=Math.min(i,r-i),l=n.log2(a/(4+s/2)),c=0===e?l:Math.min(o,l),h=Math.max(this._minZoom,this.current.zoomLevel+2-c),u=this.current.zoomLevel-h,f=this._shapedBox.width/2*Math.pow(2,u);this.current.inShaping.isMultiline?0===e&&this._placeStraight(t,h):this._placeCurved(t,h,f)},v._placeStraight=function(t,e){const{out:i,outVecs:r,outMetrics:n,inId:o}=this.current;this._writeGlyphs(i,r,o,t,n,e)},v._placeCurved=function(t,e,i){const r={from:this.current.out.currentDisplayRecordCount(),count:-1},n=new p(this.current.inId,r,t.x,t.y,e),o=t.clone(),s=t.angle*(180/Math.PI)%360,a=(t.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=M(s),this._placeFirst(o,n,e,1),this._placeBack(t,o,n,e,i,1),this._placeForward(t,o,n,e,i,1),this._outLineLabelAngle=M(a),this._placeFirst(o,n,e,0),this._placeBack(t,o,n,e,i,0),this._placeForward(t,o,n,e,i,0),n.range.count=this.current.out.currentDisplayRecordCount()-n.range.from,n.bounds&&this.current.outMetrics.push(n)},v._placeBack=function(t,e,i,r,n,o){const s=t.clone();let a=t.backwardLength+0;for(;s.prev()&&!(a>=n);)this._placeOnSegment(s,e,i,a,r,-1,o),a+=s.length+0},v._placeForward=function(t,e,i,r,n,o){const s=t.clone();let a=t.remainingLength+0;for(;s.next()&&!(a>=n);)this._placeOnSegment(s,e,i,a,r,1,o),a+=s.length+0},v._placeFirst=function(t,e,i,r){const o=t,s=this.current.inShaping,a=s.glyphs,l=this.current.zoomLevel,{out:c,outVecs:h,inId:u}=this.current,f=b(o.x,o.y);for(const o of a){const a=o.x>s.bounds.x?r:1-r,p=a*t.remainingLength+(1-a)*t.backwardLength,m=Math.abs(o.x+o.width/2-s.bounds.x),d=Math.max(0,l+n.log2(m/(p+0))),y=Math.max(i,d);o.maxZoom=25,o.angle=t.angle+(1-r)*Math.PI,o.minZoom=y,this._writeGlyph(c,h,o,u,f),r&&this._isVisible(o.minZoom,o.maxZoom)&&e.add(o.bounds,0,0)}},v._placeOnSegment=function(t,e,i,r,o,s,a){const l=this.current.inShaping.glyphs,{out:c,outVecs:h,inId:u}=this.current,f=this.current.inShaping,p=this.current.zoomLevel,m=t.dx/t.length,d=t.dy/t.length,y={x:t.x+r*-s*m,y:t.y+r*-s*d},_=b(y.x,y.y);for(const m of l){const l=m.x>f.bounds.x?a:1-a;if(!(l&&1===s||!l&&-1===s))continue;const d=Math.abs(m.x+m.width/2-f.bounds.x),y=Math.max(0,p+n.log2(d/r)-.1),x=Math.max(o,p+n.log2(d/(r+t.length+0)));0!==y&&(m.angle=t.angle+(1-a)*Math.PI,m.minZoom=x,m.maxZoom=y,this._writeGlyph(c,h,m,u,_),a&&this._isVisible(m.minZoom,m.maxZoom)&&i.add(m.bounds,t.x-e.x,t.y-e.y))}},v._writeGlyphs=function(t,i,r,n,o,s=this._minZoom){const a=this._shapingInfo;if(e.isNone(a))return;if(n.x<0||n.x>=512||n.y<0||n.y>=512)return;const l=t.currentDisplayRecordCount(),c=b(n.x+this._refOffsetX,n.y-this._refOffsetY),h=new p(r,{from:l,count:-1},n.x+this._refOffsetX,n.y-this._refOffsetY,s);for(const e of a.glyphs)e.minZoom=s,e.maxZoom=this._maxZoom,this._writeGlyph(t,i,e,r,c);h.range.count=t.currentDisplayRecordCount()-h.range.from,h.bounds=a.boundsT;const f=u.LabelMaterialKey.load(this._materialKey),m=this._refPlacementDirX,d=this._refPlacementDirY,y=f.vvSizeFieldStops||f.vvSizeMinMaxValue||f.vvSizeScaleStops||f.vvSizeUnitValue;h.setPlacementOffset(y,this._referenceSize,this._refPlacementPadding,m,d),o.push(h)},v._writeGlyph=function(t,e,i,r,n){const o=u.MaterialKeyBase.load(this._materialKey);o.textureBinding=i.textureBinding;const s=e.indexVector.length,a=e.getVector("geometry").vertexCount,l=this._writeIndices(e),c=this._writeVertex(e,r,n,i);t.writeDisplayRecord(this.geometryType,o.data,a,c,s,l)},v._writeVertexCommon=function(t,e,i,r){const n=this._color,o=this._haloColor,s=l.i8888to32(0,0,this._size,this._haloSize),a=Math.max(r.minZoom,this._minZoom),c=Math.min(r.maxZoom,this._maxZoom),h=l.i8888to32(g(a),g(c),this._outLineLabelAngle,0);t.push(i),t.push(e),t.push(n),t.push(o),t.push(s),t.push(this._refSymbolAndPlacementOffset),t.push(h)},t._createClass(d,[{key:"_shapedBox",get:function(){return e.unwrap(this._shapingInfo).bounds}}]),d}(d)}.apply(e,r))||(t.exports=n)},8349:(t,e,i)=>{var r,n;r=[i(58797),i(73462),i(90920),i(39241),i(74518),i(26653),i(31581),i(20780),i(31160),i(79855),i(27045)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c,h){"use strict";const u=e.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(e){function c(t,i,r,n,s,a,c,h,u,f,p,m,d,y,_,x){var g;g=e.call(this)||this;const M=o.LineMaterialKey.load(t);return i&&(M.sdf=i.sdf,M.pattern=!0,M.textureBinding=i.textureBinding),g._capType=n,g._joinType=s,g._miterLimitCosine=l.getLimitCosine(a),g.tessellationProperties._fillColor=c,g.tessellationProperties._tl=h,g.tessellationProperties._br=u,g._hasPattern=f,g._isDashed=p,g._joinOnUTurn=_,g._isColorLocked=m,g._zOrder=y,g.effects=x,g._materialKey=M.data,g.tessellationProperties._bitset=m?1:0,g.tessellationProperties._halfWidth=.5*r,g.tessellationProperties._halfReferenceWidth=.5*d,g._initializeTessellator(!1),g}return t._inheritsLoose(c,e),c.fromCIMLine=function(t,e,o){const a=t.color,l=t.scaleFactor||1,h=t.isDashed;let u=t.cap;h&&1===u&&(u=2);const f=t.join,p=i.pt2px(t.width)*l,m=i.pt2px(t.referenceWidth),d=i.pt2px(t.miterLimit),y=a&&s.premultiplyAlphaRGBA(a)||0;if(!e)return new c(t.materialKey,e,p,u,f,d,y,0,0,!1,h,t.colorLocked,m,t.zOrder,o,t.effects);const{rect:_,width:x,height:g}=e,M=_.x+r.SPRITE_PADDING,b=_.y+r.SPRITE_PADDING,v=M+x,w=b+g,S=n.i1616to32(M,b),C=n.i1616to32(v,w);return new c(t.materialKey,e,p,u,f,d,y,S,C,!0,h,t.colorLocked,m,t.zOrder,o,t.effects)},c.fromSimpleLine=function(t,e,o){const{color:l}=t,h="esriSLSSolid"!==t.style&&"esriSLSNull"!==t.style,u=a.getCapType(t.cap||"round",h),f=a.getJoinType(t.join||"round");let p=l&&"esriSLSNull"!==t.style&&s.premultiplyAlphaRGBAArray(l)||0;"esriSLSNull"===t.style&&(p=0);const m=i.pt2px(t.width),d=t.miterLimit;if(!e)return new c(t.materialKey,e,m,u,f,d,p,0,0,!1,h,!1,m,0,o,null);const{rect:y,width:_,height:x}=e,g=y.x+r.SPRITE_PADDING,M=y.y+r.SPRITE_PADDING,b=g+_,v=M+x,w=n.i1616to32(g,M),S=n.i1616to32(b,v);return new c(t.materialKey,e,m,u,f,d,p,w,S,!0,h,!1,m,0,o,null)},c.fromPictureLineSymbol=function(t,e,i,r){return u.error("PictureLineSymbol support does not exist!"),null},c}(h(c))}.apply(e,r))||(t.exports=n)},67435:(t,e,i)=>{var r,n;r=[i(58797),i(3718),i(90920),i(39241),i(38970),i(1422),i(74518),i(26653),i(31581),i(79855),i(48163)],void 0===(n=function(t,e,i,r,n,o,s,a,l,c,h){"use strict";return function(c){function h(t,e,i,l,h,u,f,p,m,d,y,_,x,g,M,b,v,w,S,C,I){var L;(L=c.call(this)||this).angle=l,L.height=f,L.width=u,L.xOffset=e*S,L.yOffset=i*S,L._markerPlacement=C,L.effects=I,L._anchorX=.5-(.5+b)*M.width/M.width,L._anchorY=.5-(.5+v)*M.height/M.height;const P=(1===g?1:0)|(y?1:0)<<1|(x?1:0)<<2|(_?1:0)<<3,T=M&&M.sdf,O=a.MarkerMaterialKey.load(t);O.sdf=T,O.pattern=!0,O.textureBinding=M.textureBinding,L._materialKey=O.data,L._fillColor=h,L._outlineColor=m,L._sizeOutlineWidth=s.i8888to32(Math.round(Math.min(Math.sqrt(128*u),255)),Math.round(Math.min(Math.sqrt(128*f),255)),Math.round(Math.min(Math.sqrt(128*d),255)),Math.round(Math.min(Math.sqrt(128*p),255)));const k=M.rect.x+r.SPRITE_PADDING,D=M.rect.y+r.SPRITE_PADDING,A=k+M.width,z=D+M.height;L._texUpperLeft=s.i1616to32(k,D),L._texUpperRight=s.i1616to32(A,D),L._texBottomLeft=s.i1616to32(k,z),L._texBottomRight=s.i1616to32(A,z),u*=w,f*=w,u*=S,f*=S;const R=Math.round(Math.min(64*w,255));L._bitestAndDistRatio=s.i8888to32(0,0,P,R),L._computedWidth=u,L._computedHeight=f;const F=o.create(),G=n.create();return L._applyTransformation(G,F),L}return t._inheritsLoose(h,c),h.fromCIMMarker=function(t,r){const n=r&&r.width||1,o=r&&r.height||1,s=t.size,a=n/o*t.scaleX,c=t.scaleSymbolsProportionally&&t.frameHeight?s/t.frameHeight:1,u=l.premultiplyAlphaRGBA(t.color),f=l.premultiplyAlphaRGBA(t.outlineColor),p=i.pt2px(s),m=p*a,d=i.pt2px(t.offsetX||0),y=i.pt2px(t.offsetY||0),_=i.pt2px(t.outlineWidth||0)*c,x=t.alignment||0,g=i.pt2px(t.referenceSize);let M=t.rotation||0;t.rotateClockwise||(M=-M);let b=0,v=0;const w=t.anchorPoint;return w&&(t.isAbsoluteAnchorPoint?s&&(b=-w.x/(s*a),v=w.y/s):(b=w.x,v=w.y)),new h(t.materialKey,d,y,M,u,m,p,g,f,_,t.colorLocked,t.scaleSymbolsProportionally,!1,x,r,b,v,t.sizeRatio,e.unwrapOr(t.scaleFactor,1),t.markerPlacement,t.effects)},h.fromPictureMarker=function(t,e){const n=Math.round(i.pt2px(t.width)),o=Math.round(i.pt2px(t.height)),s=r.PICTURE_FILL_COLOR,a=Math.round(i.pt2px(t.xoffset||0)),l=Math.round(i.pt2px(t.yoffset||0));return new h(t.materialKey,a,l,t.angle,s,n,o,o,0,0,!1,!1,!1,0,e,0,0,1,1,null,null)},h.fromSimpleMarker=function(t,e){const r=l.premultiplyAlphaRGBAArray(t.color),n=Math.round(i.pt2px(t.size)),o=n,s=Math.round(i.pt2px(t.xoffset||0)),a=Math.round(i.pt2px(t.yoffset||0)),c=t.style,u=t.outline,f=0|(u&&u.color&&l.premultiplyAlphaRGBAArray(u.color)),p=0|(u&&u.width&&Math.round(i.pt2px(u.width))),m=new h(t.materialKey,s,a,t.angle,r,n,o,o,f,p,!1,!1,"esriSMSCross"===c||"esriSMSX"===c,0,e,0,0,126/64,1,null,null);return m.boundsType="esriSMSCircle"===c?"circle":"square",m},h.fromLineSymbolMarker=function(t,e){const r=l.premultiplyAlphaRGBAArray(t.color),n=Math.round(i.pt2px(6*t.lineWidth)),o=n,s="cross"===t.style||"x"===t.style;let a;switch(t.placement){case"begin-end":a="Both";break;case"begin":a="JustBegin";break;case"end":a="JustEnd";break;default:a="None"}const c={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:a,offsetAlongLine:0},u=new h(t.materialKey,0,0,0,r,n,o,o/6,r,s?Math.round(i.pt2px(t.lineWidth)):0,!1,!1,s,1,e,0,0,126/64,1,c,null);return u.boundsType="circle"===t.style?"circle":"square",u},h}(h(c))}.apply(e,r))||(t.exports=n)},79855:(t,e,i)=>{var r,n;r=[i(58797),i(3718),i(57167),i(53183),i(88479)],void 0===(n=function(t,e,i,r,n){"use strict";return function(){function o(){}var s=o.prototype;return s.writeMesh=function(t,r,o,s,a){if(e.isNone(this.effects))return this.writeMeshWithGeometry(t,r,o,s,a);const l=n.CIMEffectHelper.executeEffects(this.effects,o.readLegacyGeometry());let c=n.CIMEffectHelper.next(l);for(;c;)this.writeMeshWithGeometry(t,r,o,i.getJsonType(c),a,c),c=n.CIMEffectHelper.next(l)},s.writeMeshWithGeometry=function(t,e,i,r,n,o){},s.bindFeature=function(t,e,i){},t._createClass(o,[{key:"needsPixelBuffer",get:function(){return!!this.effects||this.geometryType===r.WGLGeometryType.MARKER||this.geometryType===r.WGLGeometryType.TEXT||this.geometryType===r.WGLGeometryType.LABEL}}]),o}()}.apply(e,r))||(t.exports=n)},85294:(t,e,i)=>{var r,n;r=[e,i(58797),i(73462),i(49359),i(9720),i(63872),i(14657),i(55726),i(62638),i(67435),i(16697),i(24513),i(95059),i(35872),i(3457),i(60566),i(8349),i(86253)],void 0===(n=function(t,i,r,n,o,s,a,l,c,h,u,f,p,m,d,y,_,x){"use strict";const g=r.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),M=new Array;function b(t,e){const i=t.length;return t.push(null),e.then((e=>t[i]=e)),t}function v(t){return!!(1&t)}let w=function(){function t(t,e){this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new x.default,this._fetchResource=t,this._joinOnUTurn=e}var e=t.prototype;return e.createTemplateGroup=function(t,e){this._initErrorTemplates();const i=t.hash;if(this._symbolToTemplate.has(i))return this._symbolToTemplate.get(i);const r=new Array;e&&this._createMeshTemplates(r,e,!0),this._createMeshTemplates(r,t,!1);const n=this._createGroupId("expanded-cim"===t.type);return this._idToTemplateGroup.set(n,r),this._symbolToTemplate.set(i,n),n},e.getTemplateGroup=function(t){return this._idToTemplateGroup.has(t)?this._idToTemplateGroup.get(t):M},e.getDynamicTemplateGroup=function(t){return this._idToTemplateGroup.has(t)?(v(t)||g.error("mapview-template-store",`Id ${t} does not refer to a dynamic template`),this._idToTemplateGroup.get(t)):M},e.getMosaicItem=function(t,e){const i=this._createTemplateId(),r=o.create((t=>this._idToResolver.set(i,t)));return this._fetchQueue.push({symbol:t,id:i,glyphIds:e}),r},e.finalize=function(t){return this._fetchQueue.length||this._lock.isHeld()?x.withLock(this._lock,this._fetchAllQueuedResources.bind(this),t):o.resolve()},e._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],l.createSymbolSchema(s.errorPolygonSymbol2D),!1),marker:this._createMeshTemplates([],l.createSymbolSchema(s.errorPointSymbol2D),!1),line:this._createMeshTemplates([],l.createSymbolSchema(s.errorPolylineSymbol2D),!1)})},e._fetchAllQueuedResources=function(t){if(!this._fetchQueue.length)return o.resolve();const e=this._fetchQueue,i=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],o.all(i).then((()=>this._fetchResource(e,t).then((t=>{for(const{id:e,mosaicItem:i}of t)this._idToResolver.get(e)(i),this._idToResolver.delete(e)})))).catch((t=>{o.isAbortError(t)?this._fetchQueue=this._fetchQueue.concat(e):function(t){return"worker:port-closed"===t.name}(t)||g.error(new n("mapview-template-store","Unable to fetch requested texture resources",t))}))},e._createGroupId=function(t){return this._idCounter++<<1|(t?1:0)},e._createTemplateId=function(){return this._templateIdCounter++},e._createSMS=async function(t){const{spriteMosaicItem:e}=await this.getMosaicItem(t);return a.ok(e,g)?h.fromSimpleMarker(t,e):this._markerError},e._createPMS=async function(t){const{spriteMosaicItem:e}=await this.getMosaicItem(t);return a.ok(e,g)?h.fromPictureMarker(t,e):this._markerError},e._createSFS=async function(t,e){const{spriteMosaicItem:i}=await this.getMosaicItem(t);return a.ok(i,g)?y.fromSimpleFill(t,i,e):this._fillError},e._createPFS=async function(t,e){const{spriteMosaicItem:i}=await this.getMosaicItem(t);return a.ok(i,g)?y.fromPictureFill(t,i,e):this._fillError},e._createSLS=async function(t,e){const{spriteMosaicItem:i}=await this.getMosaicItem(t);return a.ok(i,g)?_.fromSimpleLine(t,i,this._joinOnUTurn):this._lineError},e._createLMS=async function(t){const{spriteMosaicItem:e}=await this.getMosaicItem(t);return a.ok(e,g)?h.fromLineSymbolMarker(t,e):this._markerError},e._createTS=async function(t){const{glyphMosaicItems:e}=await this.getMosaicItem(t);return c.fromText(t,e)},e._createCIMText=async function(t){const{glyphMosaicItems:e}=await this.getMosaicItem(t.cim,m.codepoints(t.text));return t.cim.mosaicHash=t.materialHash,a.ok(e,g)?c.fromCIMText(t,e):this._textError},e._createCIMFill=async function(t){t.cim.mosaicHash=t.materialHash;const{spriteMosaicItem:e}=await this.getMosaicItem(t.cim);return a.ok(e,g)?y.fromCIMFill(t,e):this._fillError},e._createCIMLine=async function(t){t.cim.mosaicHash=t.materialHash;const{spriteMosaicItem:e}=await this.getMosaicItem(t.cim);return a.ok(e,g)?_.fromCIMLine(t,e,this._joinOnUTurn):this._lineError},e._createCIMMarker=async function(t){t.cim.mosaicHash=t.materialHash;const{spriteMosaicItem:e}=await this.getMosaicItem(t.cim);return a.ok(e,g)?h.fromCIMMarker(t,e):this._markerError},e._createCIM=async function(t){const e=t.templateHash;if(this._cimTemplateCache.has(e))return this._cimTemplateCache.get(e);let i;switch(t.type){case"marker":i=this._createCIMMarker(t);break;case"line":i=this._createCIMLine(t);break;case"fill":i=this._createCIMFill(t);break;case"text":i=this._createCIMText(t)}return i.then((t=>this._cimTemplateCache.set(e,t))),i},e._createDynamicCIM=function(t){const e=t.templateHash;if(this._cimTemplateCache.has(e))return this._cimTemplateCache.get(e);let i;switch(t.type){case"marker":i=p.fromCIMMarker(t);break;case"line":i=f.fromCIMLine(t);break;case"fill":i=u.fromCIMFill(t);break;case"text":i=d.fromCIMText(t)}return this._cimTemplateCache.set(e,i),i},e._createPrimitiveMeshTemplates=function(t,e,i){switch(e.type){case"esriSMS":return b(t,this._createSMS(e));case"esriPMS":return b(t,this._createPMS(e));case"esriSFS":return b(t,this._createSFS(e,i));case"line-marker":return b(t,this._createLMS(e));case"esriPFS":return b(t,this._createPFS(e,i));case"esriSLS":return b(t,this._createSLS(e,!1));case"esriTS":return b(t,this._createTS(e));default:return g.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),t}},e._createMeshTemplates=function(t,e,i){if(-1!==e.type.indexOf("3d"))return g.error("3D symbols are not supported with MapView"),t;if("expanded-cim"===e.type){for(const i of e.layers)"function"==typeof i.materialHash?t.push(this._createDynamicCIM(i)):b(t,this._createCIM(i));return t}if("composite-symbol"===e.type){for(const r of e.layers)this._createPrimitiveMeshTemplates(t,r,i);return t}return"cim"===e.type||"label"===e.type||"web-style"===e.type?t:this._createPrimitiveMeshTemplates(t,e,i)},i._createClass(t,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]),t}();e.WGLTemplateStore=w,e.isDynamicId=v,Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},62638:(t,e,i)=>{var r,n;r=[i(58797),i(90920),i(81901),i(69911),i(26653),i(31581),i(37713),i(79855)],void 0===(n=function(t,e,i,r,n,o,s,a){"use strict";return function(s){function a(t,r,o,a,l,c,h,u,f,p,m,d,y,_,x,g,M,b=!1){var v;(v=s.call(this)||this)._xOffset=e.pt2px(d),v._yOffset=e.pt2px(y),v._decoration=f||"none",v._color=a,v._haloColor=l,v._haloSize=Math.min(Math.floor(5*e.pt2px(e.toPt(o))),127),v._size=Math.min(Math.round(e.pt2px(r)),127);const w=Math.min(Math.round(e.pt2px(r)),127);v._referenceSize=Math.round(Math.sqrt(256*w)),v._scale=v._size/24,v._angle=m,v._justify=i.getJustification(c||"center"),v._xAlignD=i.getXAnchorDirection(c||"center"),v._yAlignD=i.getYAnchorDirection(h||"baseline"),v._baseline="baseline"===(h||"baseline"),v._bitset=(1===u?1:0)|(p?1:0)<<1;const S=n.MaterialKeyBase.load(t);return S.sdf=!0,v._materialKey=S.data,v._lineWidth=e.pt2px(_)||512,v._lineHeight=x||1,v._textPlacement=g,v.effects=M,v._isCIM=b,v}return t._inheritsLoose(a,s),a.fromText=function(t,e){const i=new a(t.materialKey,t.font.size,t.haloSize||0,t.color&&o.premultiplyAlphaRGBAArray(t.color)||0,t.haloColor&&o.premultiplyAlphaRGBAArray(t.haloColor)||0,t.horizontalAlignment,t.verticalAlignment,0,t.font.decoration,!1,t.angle||0,t.xoffset,t.yoffset,t.lineWidth,t.lineHeight,null,null,!1),[,n]=r.bidiText(t.text);return i.bindTextInfo(e,n),i},a.fromCIMText=function(t,e){const i=t.scaleFactor||1,n=new a(t.materialKey,t.size*t.sizeRatio*i,t.outlineSize*t.sizeRatio,o.premultiplyAlphaRGBA(t.color),o.premultiplyAlphaRGBA(t.outlineColor),t.horizontalAlignment,t.verticalAlignment,t.alignment,t.decoration,t.colorLocked,t.angle,t.offsetX*t.sizeRatio*i,t.offsetY*t.sizeRatio*i,512,1,t.markerPlacement,t.effects,!0),[,s]=r.bidiText(t.text);return n.bindTextInfo(e,s),n},a}(s(a))}.apply(e,r))||(t.exports=n)},1831:(t,e,i)=>{var r,n;r=[e,i(58797),i(3718),i(31160)],void 0===(n=function(t,i,r,n){"use strict";function o(t,e){return t[e+1]}function s(t){return t.length-1}function a(t){let e=0;for(let i=0;i<s(t);i++)e+=l(t,i);return e}function l(t,e,i=1){const[r,n]=o(t,e);return Math.sqrt(r*r+n*n)*i}let c=function(){function t(t,e,i,r,n){this._segments=t,this._index=e,this._distance=i,this._xStart=r,this._yStart=n,this._done=!1}t.create=function(e){return new t(e,0,0,e[0][0],e[0][1])};var e=t.prototype;return e.clone=function(){return new t(this._segments,this._index,this._distance,this.xStart,this.yStart)},e.equals=function(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)},e.leq=function(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance},e.geq=function(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance},e.hasPrev=function(){return this._index-1>=0},e.hasNext=function(){return this._index+1<s(this._segments)},e.next=function(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null},e.prev=function(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)},e._seekBackwards=function(t,e){const i=this.backwardLength;if(t<=i)return this._distance=(i-t)/this.length,this;let r=this.backwardLength;for(;this.prev();){if(r+this.length>t)return this._seekBackwards(t-r);r+=this.length}return this._distance=0,e?this:null},e.seek=function(t,e=!1){if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let i=this.remainingLength;for(;this.next();){if(i+this.length>t)return this.seek(t-i,e);i+=this.length}return this._distance=1,e?this:null},i._createClass(t,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let i=Math.acos(e);return t>0&&(i=2*Math.PI-i),i}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]),t}();function h(t,e,i,n,o){if(i<e)return;const s=n.clone().seek(i/2);if(r.isNone(s))return;t(s.clone(),i,o),i=(i-e)/2;const a=r.unwrap(s.seek(e/2));h(t,e,i,n,o+1),h(t,e,i,a,o+1)}function u(t,e){const i=1e-6;if(e<=0)return;const r=t.length;if(r<3)return;const o=[];let s=0;o.push(0);for(let e=1;e<r;e++)s+=n.dist(t[e],t[e-1]),o.push(s);e=Math.min(e,.2*s);const a=[];a.push(t[0][0]),a.push(t[0][1]);const l=t[r-1][0],c=t[r-1][1],h=n.sub([0,0],t[0],t[1]);n.normalize(h),t[0][0]+=e*h[0],t[0][1]+=e*h[1],n.sub(h,t[r-1],t[r-2]),n.normalize(h),t[r-1][0]+=e*h[0],t[r-1][1]+=e*h[1];for(let t=1;t<r;t++)o[t]+=e;o[r-1]+=e;const u=.5*e;for(let n=1;n<r-1;n++){let s=0,l=0,c=0;for(let r=n-1;r>=0&&!(o[r+1]<o[n]-u);r--){const a=u+o[r+1]-o[n],h=o[r+1]-o[r],f=o[n]-o[r]<u?1:a/h;if(Math.abs(f)<i)break;const p=f*f,m=f*a-.5*p*h,d=f*h/e,y=t[r+1],_=t[r][0]-y[0],x=t[r][1]-y[1];s+=d/m*(y[0]*f*a+.5*p*(a*_-h*y[0])-p*f*h*_/3),l+=d/m*(y[1]*f*a+.5*p*(a*x-h*y[1])-p*f*h*x/3),c+=d}for(let a=n+1;a<r&&!(o[a-1]>o[n]+u);a++){const r=u-o[a-1]+o[n],h=o[a]-o[a-1],f=o[a]-o[n]<u?1:r/h;if(Math.abs(f)<i)break;const p=f*f,m=f*r-.5*p*h,d=f*h/e,y=t[a-1],_=t[a][0]-y[0],x=t[a][1]-y[1];s+=d/m*(y[0]*f*r+.5*p*(r*_-h*y[0])-p*f*h*_/3),l+=d/m*(y[1]*f*r+.5*p*(r*x-h*y[1])-p*f*h*x/3),c+=d}a.push(s/c),a.push(l/c)}a.push(l),a.push(c);for(let e=0,i=0;e<r;e++)t[e][0]=a[i++],t[e][1]=a[i++]}e.SegmentCursor=c,e.pathDivide=function(t,e,i){const r=a(t),n=c.create(t),o=r/2,s=(r-e)/2,l=Math.floor(s/e),h=o-l*e;n.seek(h);for(let t=-l;t<=l;t++)n.x<512&&n.x>=0&&n.y<512&&n.y>=0&&i(n.clone(),t,o+t*e,r),n.seek(e)},e.pathLength=a,e.pathSubdivide=function(t,e,i){h(i,e,a(t),c.create(t),0)},e.segmentAt=o,e.segmentCount=s,e.segmentLength=l,e.smoothPaths=function(t,e){const i=e;for(let e=0;e<t.length;e++){let r=t[e];const n=[];n.push(r[0]);for(let t=1;t<r.length;t++){let[e,i]=n[t-1];e+=r[t][0],i+=r[t][1],n.push([e,i])}u(n,i);const o=[];o.push(n[0]);for(let t=1;t<n.length;t++){const[e,i]=n[t-1],[r,s]=n[t],a=Math.round(r-e),l=Math.round(s-i);o.push([a,l])}t[e]=o,r=o}return t},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},21816:(t,e,i)=>{var r,n;r=[e,i(87547),i(61789),i(39241),i(10453),i(6953),i(53690)],void 0===(n=function(t,i,r,n,o,s,a){"use strict";const l=new a,c=new o.TileClipper(0,0,0,1,128);function h(t,e,i){let r=0;for(let n=1;n<i;n++){const i=t[2*(e+n-1)],o=t[2*(e+n-1)+1];r+=(t[2*(e+n)]-i)*(t[2*(e+n)+1]+o)}return r}function u(t,e,i,r,n){let o=0;for(let s=i;s<r;s+=3){const i=2*(t.getValue(s)-n),r=2*(t.getValue(s+1)-n),a=2*(t.getValue(s+2)-n);o+=Math.abs((e[i]-e[a])*(e[r+1]-e[i+1])-(e[i]-e[r])*(e[a+1]-e[i+1]))}return o}function f(t,e,i,r,n,o,s,a){const l=((t-n)*(o-a)-(e-a)*(n-s))/((t-i)*(o-a)-(e-r)*(n-s));return l<0||l>1?null:{x:Math.round(t+l*(i-t)),y:Math.round(e+l*(r-e))}}c.setExtent(n.TILE_SIZE),e.area=h,e.clip=function(t,e,i=0){const r=-i,n=e+i;let o=0,s=0,a=0;for(let e=0;e<t.lengths.length;e++){const i=t.lengths[e],l=a+i;let c=0,h=null;for(;o!==l;){let e=t.coords[2*o],i=t.coords[2*o+++1],a=e<r||e>=n||i<r||i>=n;const u=a;for(;o!==l&&a===u;)a||(t.coords[2*s]=e,t.coords[2*s+++1]=i,c++),e=t.coords[2*o],i=t.coords[2*o+++1],a=e<r||e>=n||i<r||i>=n;if(o===l){a?h&&(t.coords[2*s]=h.x,t.coords[2*s+++1]=h.y,c++):(t.coords[2*s]=e,t.coords[2*s+++1]=i,c++);continue}const p=t.coords[2*(o-2)],m=t.coords[2*(o-2)+1],d=f(p,m,e,i,r,r,n,r)||f(p,m,e,i,n,r,n,n)||f(p,m,e,i,n,n,r,n)||f(p,m,e,i,r,r,r,n);d&&(t.coords[2*s]=d.x,t.coords[2*s+++1]=d.y,c++,h||(h=d)),a||(t.coords[2*s]=e,t.coords[2*s+++1]=i,c++)}t.lengths[e]=c,a+=i}},e.clipMarshall=function(t){if(!function(t,e,i){let r=0;for(let e=0;e<t.lengths.length;e++){const n=t.lengths[e];for(let e=0;e<n;e++){const n=t.coords[2*(e+r)],o=t.coords[2*(e+r)+1];if(n<-128||n>i||o<-128||o>i)return!0}r+=n}return!1}(t,0,n.TILE_SIZE+128))return t;c.reset(3);let e=0;for(let i=0;i<t.lengths.length;i++){const r=t.lengths[i];let n=t.coords[2*(0+e)],o=t.coords[2*(0+e)+1];c.moveTo(n,o);for(let i=1;i<r;i++)n=t.coords[2*(i+e)],o=t.coords[2*(i+e)+1],c.lineTo(n,o);c.close(),e+=r}const r=c.result(!1);if(!r)return null;const o=[],s=[];for(const t of r){let e=0;for(const i of t)s.push(i.x),s.push(i.y),e++;o.push(e)}return new i(o,s)},e.triangleArea=u,e.triangulate=function(t,e,i){const{coords:r,lengths:n,hasIndeterminateRingOrder:o}=e;if(o)return!1;const a=t.length;let l=0;for(let e=0;e<n.length;){let o=e,c=n[e],f=h(r,l,c);const p=[];for(;++o<n.length;){const t=n[o],e=h(r,l+c,t);if(!(e>0))break;f+=e,p.push(l+c),c+=t}const m=t.length;s.bufcut(t,r,l,l+c,p,2,i);const d=u(t,r,m,t.length,i),y=Math.abs(f);if(Math.abs((d-y)/Math.max(1e-7,y))>1e-5)return t.seek(a),!1;e=o,l+=c}return!0},e.triangulateEarcut=function(t,e,i){const{coords:n,lengths:o,hasIndeterminateRingOrder:s}=e;if(s)return!1;let a=0;for(let s=0;s<o.length;){let l=s,c=o[s];const u=[];for(;++l<o.length;){const t=o[l];if(!(h(n,a+c,t)>0))break;u.push(a+c-a),c+=t}const f=a+c,p=e.coords.slice(2*a,2*f),m=r.earcut(p,u,2);for(const e of m)t.push(e+i+a);s=l,a+=c}return!0},e.triangulateLibtess=function(t,e,i,r){const n=[],{coords:o,lengths:s}=i;l.beginPolygon(t,n);let a=0;for(let t=0;t<s.length;t++){const e=i.lengths[t];l.beginContour();for(let t=0;t<e;t++){const e=[o[2*(a+t)],o[2*(a+t)+1],0];l.addVertex(e,e)}l.endContour(),a+=e}l.endPolygon();for(let t=0;t<n.length;t++)e.push(n[t]+r)},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},86253:(t,e,i)=>{var r,n;r=[e,i(9720)],void 0===(n=function(t,i){"use strict";let r=function(){function t(){this._resolver=null}var e=t.prototype;return e.isHeld=function(){return!!this._resolver},e.acquire=function(){return this._resolver?this._resolver.promise.then((()=>this.acquire())):(this._resolver=i.createResolver(),i.resolve())},e.release=function(){const t=this._resolver;this._resolver=null,t.resolve()},t}();e.default=r,e.withLock=function(t,e,i){return t.acquire().then((()=>e(i))).then((()=>t.release())).catch((e=>{throw t.release(),e}))},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},43586:(t,e,i)=>{var r,n;r=[i,e,i(58797),i(73462),i(49359),i(9720),i(27006),i(80476),i(79058),i(53391),i(88309),i(55726)],void 0===(n=function(t,r,n,o,s,a,l,c,h,u,f,p){"use strict";const m=o.getLogger("esri/views/2d/engine/webgl/util/Matcher");let d=function(){function t(){this.type="feature",this._defaultResult=null}t.fromBasicRenderer=async function(e,i,r){const n=new t;if(e.symbol){const t=await f.expandSymbol(e.symbol,r),o=i.createTemplateGroup(t,null);n.setDefault(o)}return n};var e=t.prototype;return e.size=function(){return 1},e.getDefault=function(){return this._defaultResult},e.setDefault=function(t){this._defaultResult=t},e.match=function(t,e,i,r,n){return this.getDefault()},e.analyze=async function(t,e,i,r,n){return null},t}(),y=function(t){function e(e,i,r,n){var o;return(o=t.call(this)||this).type="interval",o._intervals=[],o._isMaxInclusive=i,o._fieldIndex=n,o._field=e,o._normalizationInfo=r,o}n._inheritsLoose(e,t),e.fromCBRenderer=async function(t,i,r){const{isMaxInclusive:n,normalizationField:o,normalizationTotal:s,normalizationType:l}=t,c=new e(t.field,n,{normalizationField:o,normalizationTotal:s,normalizationType:l},t.fieldIndex),h=await f.expandSymbol(t.backgroundFillSymbol,r);await a.all(t.intervals.map((async t=>{const e=await f.expandSymbol(t.symbol,r),n=await i.createTemplateGroup(e,h),o={min:t.min,max:t.max};c.add(o,n)})));const u=await f.expandSymbol(t.defaultSymbol,r);if(u){const t=await i.createTemplateGroup(u,h);c.setDefault(t)}return c};var i=e.prototype;return i.add=function(t,e){this._intervals.push({interval:t,result:e}),this._intervals.sort(((t,e)=>t.interval.min-e.interval.min))},i.size=function(){return t.prototype.size.call(this)+this._intervals.length},i.match=function(t,e,i,r,n){if(null==this._fieldIndex&&!this._field)return this.getDefault();const o=null!=this._fieldIndex?e.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(e);if(!o&&(null==o||isNaN(o)))return this.getDefault();for(let t=0;t<this._intervals.length;t++){const{interval:e,result:i}=this._intervals[t],r=o>=e.min,n=this._isMaxInclusive?o<=e.max:o<e.max;if(r&&n)return i}return this.getDefault()},i._needsNormalization=function(){const t=this._normalizationInfo;return t&&(t.normalizationField||t.normalizationTotal||t.normalizationType)},i._getValueFromField=function(t){const e=t.readAttribute(this._field);if(!this._needsNormalization())return e;const{normalizationField:i,normalizationTotal:r,normalizationType:n}=this._normalizationInfo,o=!!i&&t.readAttribute(i);if(n)switch(n){case"esriNormalizeByField":return o?e/o:void 0;case"esriNormalizeByLog":return Math.log(e)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return e/r*100;default:return void m.error(`Found unknown normalization type: ${n}`)}else m.error("Normalization is required, but no type was set!")},e}(d),_=function(t){function e(e,i,r){var n;return(n=t.call(this)||this).type="map",n._nullResult=null,n._resultsMap=new Map,n._fieldsIndex=r,n._fields=e,n._seperator=i||"",n}n._inheritsLoose(e,t),e.fromUVRenderer=async function(t,i,r){const n=t.fieldDelimiter,o=[t.field];t.field2&&o.push(t.field2),t.field3&&o.push(t.field3);const s=await f.expandSymbol(t.backgroundFillSymbol,r),l=new e(o,n,t.fieldIndex);await a.all(t.map.map((async t=>{const e=await f.expandSymbol(t.symbol,r),n=await i.createTemplateGroup(e,s);"<Null>"===t.value?l.setNullResult(n):l.add(t.value,n)})));const c=await f.expandSymbol(t.defaultSymbol,r);if(c){const t=await i.createTemplateGroup(c,s);l.setDefault(t)}return l};var i=e.prototype;return i.setNullResult=function(t){this._nullResult=t},i.add=function(t,e){this._resultsMap.set(t.toString(),e)},i.size=function(){return t.prototype.size.call(this)+this._resultsMap.size},i.match=function(t,e,i,r,n){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();const o=null!=this._fieldsIndex?e.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(e);if(null!==this._nullResult&&(null==o||""===o||"<Null>"===o))return this._nullResult;if(!o&&null==o)return this.getDefault();const s=o.toString();return this._resultsMap.has(s)?this._resultsMap.get(s):this.getDefault()},i._getValueFromFields=function(t){const e=[];for(const i of this._fields){const r=t.readAttribute(i);e.push(r)}return e.join(this._seperator)},e}(d),x=function(t){function e(e,i,r,n){var o;return(o=t.call(this)||this).type="dictionary",o._groupIdCache=new h(100),o._renderer=e,o._fieldMap=e.fieldMap,o._symbolFields=e.getSymbolFields(),o._templates=i,o._info=r,o._scaleFn=n,o}n._inheritsLoose(e,t),e.fromDictionaryRenderer=async function(t,r,n){const o=(await new Promise((function(t,e){Promise.resolve().then((function(){var e=[i(87703)];(function(e){t(function(t){return Object.freeze({__proto__:null,default:t})}(e))}).apply(null,e)})).catch(e.bind(this))}))).default.fromJSON(t.renderer);return await o.fetchResources({spatialReference:n.spatialReference,fields:n.fields}),new e(o,r,n,await async function(t,e){const i=t||1;if("number"==typeof i)return(t,e,r)=>i;const r=await l.createRendererExpression(i,e.spatialReference,e.fields);return(t,i,n)=>u(r,t,{$view:n},e.geometryType,i)||1}(o.scaleExpression,n))};var r=e.prototype;return r._analyzeFeature=async function(t,e,i,r){const n=t.readLegacyFeature(),o=this._scaleFn(n,e,i),a=this._attributeHash(n)+"-"+o,l=this._groupIdCache.get(a);if(l)return l;const h={...i,spatialReference:this._info.spatialReference,abortOptions:r,fields:this._info.fields},u=await this._renderer.getSymbolAsync(n,h),d=p.createSymbolSchema(u,this._renderer),y=f.expandSymbol(d,this._info,r).then((t=>{if("expanded-cim"!==t.type)return m.error(new s("mapview-bad-type",`Found unexpected type ${t.type} in dictionary response`)),null;t.hash+="-"+o;for(const e of t.layers)e.scaleFactor=o,e.templateHash+="-"+o,"text"===e.type&&"string"==typeof e.text&&e.text.indexOf("[")>-1&&(e.text=c.createLabelOverrideFunction(this._fieldMap,e.text,e.cim.textCase));return this._templates.createTemplateGroup(t,null)}));return this._groupIdCache.put(a,y,1),y},r.analyze=async function(t,e,i,r,n){const o=e.getCursor(),s=[];for(;o.next();)s.push(this._analyzeFeature(o,i,r,n));return a.all(s)},r.match=function(t,e,i,r,n){return null},r._attributeHash=function(t){let e="";for(const i of this._symbolFields){const r=this._fieldMap[i];r&&(e+=t.attributes[r]+"-")}return e},e}(d);e.DictionaryMatcher=x,e.FeatureMatcher=d,e.IntervalMatcher=y,e.MapMatcher=_,Object.defineProperty(r,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},9610:(t,e,i)=>{var r;void 0===(r=function(){"use strict";return function(){function t(t){this._pos=0,this._buffer=t,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}var e=t.prototype;return e.readInt32=function(){return this._i32View[this._pos++]},e.readF32=function(){return this._f32View[this._pos++]},t}()}.call(e,i,e,t))||(t.exports=r)},14657:(t,e,i)=>{var r,n;r=[e,i(49359)],void 0===(n=function(t,i){"use strict";e.ok=function(t,e){if(t&&"name"in t){const r=t;return e&&e.error(new i(r.name,r.message,r.details)),!1}return!0},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,r))||(t.exports=n)},60595:(t,e,i)=>{var r,n;r=[i(58797)],void 0===(n=function(t){"use strict";return function(){function e(t,e){this._pos=0;const i=e?this._roundToNearest(e,t.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(i),this._buffer=new t(this._array),this._ctor=t}var i=e.prototype;return i._roundToNearest=function(t,e){const i=Math.round(t);return i+(e-i%e)},i._ensureSize=function(t){if(this._pos+t>=this._buffer.length){const e=this._roundToNearest(1.5*(this._array.byteLength+t*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),i=new ArrayBuffer(e),r=new this._ctor(i);r.set(this._buffer,0),this._array=i,this._buffer=r}},i.writeF32=function(t){this._ensureSize(1);const e=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=t,this._pos++,e},i.push=function(t){this._ensureSize(1);const e=this._pos;return this._buffer[this._pos++]=t,e},i.writeFixed=function(t){this._buffer[this._pos++]=t},i.setValue=function(t,e){this._buffer[t]=e},i.getValue=function(t){return this._buffer[t]},i.incr=function(t){this._buffer[t]++},i.decr=function(t){this._buffer[t]--},i.writeRegion=function(t){this._ensureSize(t.length);const e=this._pos;return this._buffer.set(t,this._pos),this._pos+=t.length,e},i.buffer=function(){const t=this._array.slice(0,4*this._pos);return this.destroy(),t},i.toArray=function(){const t=this._array,e=[];for(let i=0;i<t.byteLength/4;i++)e.push(t[i]);return e},i.seek=function(t){this._pos=t},i.destroy=function(){this._array=null,this._buffer=null},t._createClass(e,[{key:"length",get:function(){return this._pos}}]),e}()}.apply(e,r))||(t.exports=n)},29726:(t,e)=>{var i;void 0===(i=function(t){"use strict";e.deserializeList=function(t,e,i){const r=t.readInt32(),n=new Array(r);for(let r=0;r<n.length;r++)n[r]=e.deserialize(t,i);return n},e.serializeList=function(t,e){if(null!==e){t.push(e.length);for(const i of e)i.serialize(t);return t}t.push(0)},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,[e]))||(t.exports=i)},35872:(t,e)=>{var i;void 0===(i=function(t){"use strict";e.codepoints=function(t){const e=new Array(t.length);for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e},Object.defineProperty(t,"__esModule",{value:!0})}.apply(e,[e]))||(t.exports=i)}}]);