(self.webpackChunkh2oc=self.webpackChunkh2oc||[]).push([[2301],{80498:(e,t)=>{var a;void 0===(a=function(e){"use strict";function a(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function r(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){let t=0,a=0;for(let r=0;r<e.length;r++){const i=e[r].size;"number"==typeof i&&(t+=i,a++)}return t/a}(e.stops):t}t.calculateTolerance=function(e){const t=e&&e.renderer,i="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return i;const s="visualVariables"in t?function(e,t){if(!t)return e;const a=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:a,minSize:i}=t;return(r(a,e)+r(i,e))/2}));let i=0;const s=a.length;if(0===s)return e;for(let e=0;e<s;e++)i+=a[e];const n=Math.floor(i/s);return Math.max(n,e)}(i,t.visualVariables):i;if("simple"===t.type)return a(s,t.symbol);if("unique-value"===t.type){let e=s;return t.uniqueValueInfos.forEach((t=>{e=a(e,t.symbol)})),e}if("class-breaks"===t.type){let e=s;return t.classBreakInfos.forEach((t=>{e=a(e,t.symbol)})),e}return t.type,s},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,[t]))||(e.exports=a)},22301:(e,t,a)=>{var r,i;r=[a(58797),a(11285),a(74637),a(73462),a(67059),a(26475),a(99752),a(4037),a(51916),a(18377),a(9720),a(69788),a(28187),a(26552),a(75885),a(87515),a(35552),a(19048),a(46351),a(58329)],void 0===(i=function(e,t,a,r,i,s,n,o,p,u,l,c,d,m,h,f,y,g,v,x){"use strict";const b=r.getLogger("esri.views.2d.layers.MapImageLayerView2D");let w=function(t){function a(){var e;return(e=t.apply(this,arguments)||this)._exportImageVersion=-1,e}e._inheritsLoose(a,t);var r=a.prototype;return r.hitTest=function(){return null},r.update=function(e){this.strategy.update(e).catch((e=>{l.isAbortError(e)||b.error(e)}))},r.attach=function(){const{imageMaxWidth:e,imageMaxHeight:t,version:a}=this.layer,r=a>=10.3,i=a>=10;this._bitmapContainer=new g.BitmapContainer,this.container.addChild(this._bitmapContainer),this.strategy=new x({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:e,imageMaxHeight:t,imageRotationSupported:r,imageNormalizationSupported:i,hidpi:!0}),this.imageParameters=new m.ExportImageParameters({view:this.view,layer:this.layer}),this.handles.add(c.init(this.imageParameters,"version",(e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())})),"mapimagelayerview-update")},r.detach=function(){this.strategy.destroy(),this.handles.remove("mapimagelayerview-update"),this.imageParameters.destroy(),this.imageParameters=null,this._exportImageVersion=-1,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()},r.moveStart=function(){},r.viewChange=function(){},r.moveEnd=function(){this.requestUpdate()},r.createFetchPopupFeaturesQueryGeometry=function(e,t){return f.createQueryGeometry(e,t,this.view)},r.doRefresh=async function(){this.requestUpdate()},r.isUpdating=function(){return this.strategy.updating||this.updateRequested},r.fetchImage=function(e,t,a,r){return this.layer.fetchImage(e,t,a,{timeExtent:this.imageParameters.timeExtent,timestamp:this.refreshTimestamp,...r})},a}(y.MapImageLayerView(d.RefreshableLayerView(v.LayerView2DMixin(h))));return t.__decorate([s.property()],w.prototype,"strategy",void 0),t.__decorate([s.property({dependsOn:["strategy.updating"]})],w.prototype,"updating",void 0),w=t.__decorate([n.subclass("esri.views.2d.layers.MapImageLayerView2D")],w),w}.apply(t,r))||(e.exports=i)},35552:(e,t,a)=>{var r,i;r=[t,a(58797),a(11285),a(74637),a(3718),a(73462),a(67059),a(26475),a(99752),a(49359),a(4037),a(51916),a(18377),a(9720),a(27006),a(80498),a(28575)],void 0===(i=function(e,a,r,i,s,n,o,p,u,l,c,d,m,h,f,y,g){"use strict";t.MapImageLayerView=e=>{let t=function(e){function t(){return e.apply(this,arguments)||this}a._inheritsLoose(t,e);var r=t.prototype;return r.fetchPopupFeatures=async function(e,t){const{layer:a}=this;if(!e)return h.reject(new l("mapimagelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:a}));const r=this.get("view.scale"),i=[],n=async e=>{const a=0===e.minScale||r<=e.minScale,o=0===e.maxScale||r>=e.maxScale;if(e.visible&&a&&o)if(e.sublayers)e.sublayers.forEach(n);else if(e.popupEnabled){const a=g.getFetchPopupTemplate(e,{...t,defaultPopupTemplateEnabled:!1});s.isSome(a)&&i.push({sublayer:e,popupTemplate:a})}},o=a.sublayers.toArray().map(n);await h.all(o);const p=i.map((async({sublayer:a,popupTemplate:r})=>{await a.load().catch((()=>{}));const i=a.createQuery(),n=s.isSome(t)?t.event:null,o=y.calculateTolerance({renderer:a.renderer,event:n}),p=this.createFetchPopupFeaturesQueryGeometry(e,o);i.geometry=p,i.outFields=await g.getRequiredFields(a,r);const u=await this._loadArcadeModules(r);return u&&u.arcadeUtils.hasGeometryOperations(r)||(i.maxAllowableOffset=p.width/o),(await a.queryFeatures(i)).features}));return(await h.eachAlways(p)).reduce(((e,t)=>t.value?[...e,...t.value]:e),[]).filter((e=>null!=e))},r.canResume=function(){var t,a;return!(!e.prototype.canResume.call(this)||null!=(t=this.imageParameters)&&null!=(a=t.timeExtent)&&a.isEmpty)},r._loadArcadeModules=function(e){if(e.get("expressionInfos.length"))return f.loadArcade()},t}(e);return r.__decorate([p.property()],t.prototype,"imageParameters",void 0),r.__decorate([p.property()],t.prototype,"layer",void 0),r.__decorate([p.property({dependsOn:["imageParameters.timeExtent"]})],t.prototype,"suspended",void 0),t=r.__decorate([u.subclass("esri.views.layers.MapImageLayerView")],t),t},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,r))||(e.exports=i)},28575:(e,t,a)=>{var r,i;r=[t,a(3718),a(12808)],void 0===(i=function(e,a,r){"use strict";t.getFetchPopupTemplate=function(e,t){return e.popupTemplate?e.popupTemplate:a.isSome(t)&&t.defaultPopupTemplateEnabled&&a.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null},t.getRequiredFields=async function(e,t=e.popupTemplate){if(!a.isSome(t))return[];const i=await t.getRequiredFields(e.fields),{lastEditInfoEnabled:s}=t,{objectIdField:n,typeIdField:o,globalIdField:p,relationships:u}=e;if(i.includes("*"))return["*"];const l=s?await r.getFeatureEditFields(e):[],c=r.fixFields(e.fields,[...i,...l]);return o&&c.push(o),c&&n&&r.hasField(e.fields,n)&&-1===c.indexOf(n)&&c.push(n),c&&p&&r.hasField(e.fields,p)&&-1===c.indexOf(p)&&c.push(p),u&&u.forEach((t=>{const{keyField:a}=t;c&&a&&r.hasField(e.fields,a)&&-1===c.indexOf(a)&&c.push(a)})),c},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,r))||(e.exports=i)},87515:(e,t,a)=>{var r,i;r=[t,a(3718),a(12997),a(26016),a(35477),a(80498)],void 0===(i=function(e,a,r,i,s,n){"use strict";function o(e,t,i,n=new r){let o;if("2d"===i.type)o=t*i.resolution;else if("3d"===i.type){const r=i.overlayPixelSizeInMapUnits(e),n=i.basemapSpatialReference;o=a.isSome(n)&&!n.equals(i.spatialReference)?s.getMetersPerUnitForSR(n)/s.getMetersPerUnitForSR(i.spatialReference):t*r}const p=e.x-o,u=e.y-o,l=e.x+o,c=e.y+o,{spatialReference:d}=i;return n.xmin=Math.min(p,l),n.ymin=Math.min(u,c),n.xmax=Math.max(p,l),n.ymax=Math.max(u,c),n.spatialReference=d,n}const p=new r;t.createQueryGeometry=o,t.intersectsDrapedGeometry=function(e,t,r){const i=r.toMap(e);return!a.isNone(i)&&o(i,n.calculateTolerance(),r,p).intersects(t)},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,r))||(e.exports=i)}}]);