(self.webpackChunkh2oc=self.webpackChunkh2oc||[]).push([[5739],{17944:(e,t,r)=>{var i,o;i=[r(58797),r(11285),r(70792),r(74637),r(92231),r(73462),r(67059),r(26475),r(59376),r(99752),r(25179),r(49359),r(4037),r(51916),r(18377),r(9720),r(23084),r(12997),r(40810),r(95791),r(64393),r(23704),r(25548),r(87842),r(52058),r(93511),r(72146),r(83568),r(59332),r(36889),r(93595),r(52295),r(36239),r(3462),r(63324),r(42922),r(43768)],void 0===(o=function(e,t,r,i,o,l,n,a,s,c,p,u,h,y,d,f,_,m,v,S,A,T,g,I,b,E,w,O,R,L,U,x,N,C,D,P,M){"use strict";let B=function(t){function i(...e){var r;return(r=t.call(this,...e)||this)._spriteSourceMap=new Map,r.currentStyleInfo=null,r.style=null,r.isReference=null,r.operationalLayerType="VectorTileLayer",r.type="vector-tile",r.url=null,r}e._inheritsLoose(i,t);var l=i.prototype;return l.normalizeCtorArgs=function(e,t){return"string"==typeof e?{url:e,...t}:e},l.destroy=function(){this._spriteSourceMap.clear()},l.prefetchResources=async function(e){await this.loadSpriteSource(r.devicePixelRatio||1,e)},l.load=function(e){const t=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},e).then((async()=>{if(!this.portalItem||!this.portalItem.id)return;const t=`${this.portalItem.itemUrl}/resources/styles/root.json`;(await v(t,{...e,query:{f:"json"}})).data&&this.read({url:t},N.createForItem(this.portalItem))})).then((()=>this._loadStyle(e)),(()=>this._loadStyle(e)));return this.addResolvingPromise(t),f.resolve(this)},l.writeStyleUrl=function(e,t){e&&h.isProtocolRelative(e)&&(e=`https:${e}`),t.styleUrl=e},l.readVersion=function(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)},l.loadSpriteSource=async function(e=1,t){if(!this._spriteSourceMap.has(e)){const r=M(),i=new U(this.styleRepository.sprite,e,r.maxTextureSize,this.currentStyleInfo.spriteFormat);await i.load(t),this._spriteSourceMap.set(e,i)}return f.resolve(this._spriteSourceMap.get(e))},l.loadStyle=async function(e,t){const r=e||this.style||this.url;if(this._loadingPromise&&"string"==typeof r&&this.url===r&&!f.isAborted(this._abortController))return this._loadingPromise;const i=this._abortController;i&&i.abort();const o=f.createAbortController();return this._loadingPromise=f.create(((e,i)=>{const l={signal:o.signal};this._spriteSourceMap.clear(),this._getSourceAndStyle(r,l).then(e,i),f.onAbort(t,(()=>{o.abort()}))})),this._abortController=o,this._loadingPromise},l.getStyleLayerId=function(e){return this.styleRepository.getStyleLayerId(e)},l.getStyleLayerIndex=function(e){return this.styleRepository.getStyleLayerIndex(e)},l.getPaintProperties=function(e){return o.clone(this.styleRepository.getPaintProperties(e))},l.setPaintProperties=function(e,t){const r=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);const i=this.styleRepository.isPainterDataDriven(e);this.emit("paint-change",{layerName:e,paint:t,isDataDriven:r||i})},l.getStyleLayer=function(e){return o.clone(this.styleRepository.getStyleLayer(e))},l.setStyleLayer=function(e,t){this.styleRepository.setStyleLayer(e,t),this.emit("style-layer-change",{layer:e,index:t})},l.deleteStyleLayer=function(e){this.styleRepository.deleteStyleLayer(e),this.emit("delete-style-layer",{layerName:e})},l.getLayoutProperties=function(e){return o.clone(this.styleRepository.getLayoutProperties(e))},l.setLayoutProperties=function(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit("layout-change",{layer:e,layout:t})},l.setStyleLayerVisibility=function(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit("style-layer-visibility-change",{layer:e,visibility:t})},l.getStyleLayerVisibility=function(e){return this.styleRepository.getStyleLayerVisibility(e)},l.getTileUrl=function(e,t,r){let i=this.tileServers[t%this.tileServers.length];return i=i.replace(/\{z\}/gi,e.toString()).replace(/\{y\}/gi,t.toString()).replace(/\{x\}/gi,r.toString()),i},l.write=function(e,r){return r&&r.origin&&!this.styleUrl?(r.messages&&r.messages.push(new u("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):t.prototype.write.call(this,e,r)},l._getSourceAndStyle=async function(e,t){if(!e)throw new Error("invalid style!");const r=await x.loadMetadata(e,t);"webp"===r.spriteFormat&&(await L.checkWebPSupport("lossy")||(r.spriteFormat="png")),this._set("currentStyleInfo",{...r}),"string"==typeof e?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set("sourceNameToSource",r.sourceNameToSource),this._set("primarySourceName",r.primarySourceName),this._set("styleRepository",new P(r.style,r)),this.read(r.layerDefinition,{origin:"service"}),this.emit("load-style",{})},l._getDefaultAttribution=function(e){const t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i),r=["OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2"];if(!t)return;const i=t[2]&&t[2].toLowerCase();if(!i)return;const o=t[1]||"";for(const e of r)if(e.toLowerCase().indexOf(i)>-1)return h.normalize(`//static.arcgis.com/attribution/Vector${o}/${e}`)},l._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null},l._loadStyle=async function(e){return this._loadingPromise?this._loadingPromise:this.loadStyle(null,e)},e._createClass(i,[{key:"attributionDataUrl",get:function(){const e=this.currentStyleInfo,t=e&&e.serviceUrl&&h.urlToObject(e.serviceUrl);return t?this._getDefaultAttribution(t.path):null}},{key:"capabilities",get:function(){const e=this._getPrimarySource();return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}},{key:"fullExtent",get:function(){const e=this._getPrimarySource();return e?e.fullExtent:null}},{key:"parsedUrl",get:function(){return this.serviceUrl?h.urlToObject(this.serviceUrl):null}},{key:"serviceUrl",get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null}},{key:"spatialReference",get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null}},{key:"styleUrl",get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null}},{key:"tileIndexType",get:function(){const e=this._getPrimarySource();return e?e.type:""}},{key:"tileIndexUrl",get:function(){const e=this._getPrimarySource();return e?e.tileMapURL:""}},{key:"tileInfo",get:function(){var e;const t=[];for(const e in this.sourceNameToSource)t.push(this.sourceNameToSource[e]);let r=(null==(e=this._getPrimarySource())?void 0:e.tileInfo)||new w;if(t.length>1)for(let e=0;e<t.length;e++)D.areSchemasOverlapping(r,t[e].tileInfo)&&(r=D.unionTileInfos(r,t[e].tileInfo));return r}},{key:"tilemapCache",get:function(){const e=this._getPrimarySource();return e&&e.capabilities.operations.supportsTileMap?e.tilemapCache:null}},{key:"tileServers",get:function(){const e=this._getPrimarySource();return e?e.tileServers:[]}},{key:"compatibleTileInfo256",get:function(){return C.create256x256CompatibleTileInfo(this.tileInfo)}},{key:"compatibleTileInfo512",get:function(){return C.create512x512CompatibleTileInfo(this.tileInfo)}}]),i}(I.BlendLayer(E.ScaleRangeLayer(R.ArcGISCachedService(g.ArcGISService(T.OperationalLayer(b.PortalLayer(A.MultiOriginJSONMixin(S))))))));return t.__decorate([a.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],B.prototype,"attributionDataUrl",null),t.__decorate([a.property({type:["show","hide"]})],B.prototype,"listMode",void 0),t.__decorate([a.property({readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"],autoTracked:!1,json:{read:!1}})],B.prototype,"capabilities",null),t.__decorate([a.property({readOnly:!0})],B.prototype,"currentStyleInfo",void 0),t.__decorate([a.property({json:{read:!1},readOnly:!0,type:m,dependsOn:["sourceNameToSource","primarySourceName"]})],B.prototype,"fullExtent",null),t.__decorate([a.property()],B.prototype,"style",void 0),t.__decorate([a.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],B.prototype,"isReference",void 0),t.__decorate([a.property({type:["VectorTileLayer"]})],B.prototype,"operationalLayerType",void 0),t.__decorate([a.property({readOnly:!0,dependsOn:["serviceUrl"]})],B.prototype,"parsedUrl",null),t.__decorate([a.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],B.prototype,"serviceUrl",null),t.__decorate([a.property({type:_,dependsOn:["tileInfo"],readOnly:!0})],B.prototype,"spatialReference",null),t.__decorate([a.property({readOnly:!0})],B.prototype,"styleRepository",void 0),t.__decorate([a.property({readOnly:!0})],B.prototype,"sourceNameToSource",void 0),t.__decorate([a.property({readOnly:!0})],B.prototype,"primarySourceName",void 0),t.__decorate([a.property({type:String,readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],B.prototype,"styleUrl",null),t.__decorate([p.writer(["portal-item","web-document"],"styleUrl")],B.prototype,"writeStyleUrl",null),t.__decorate([a.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],B.prototype,"tileIndexType",null),t.__decorate([a.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],B.prototype,"tileIndexUrl",null),t.__decorate([a.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:w,dependsOn:["sourceNameToSource","primarySourceName"]})],B.prototype,"tileInfo",null),t.__decorate([a.property({json:{read:!1},readOnly:!0,type:O.TilemapCache,dependsOn:["sourceNameToSource","primarySourceName"]})],B.prototype,"tilemapCache",null),t.__decorate([a.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],B.prototype,"tileServers",null),t.__decorate([a.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],B.prototype,"type",void 0),t.__decorate([a.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],B.prototype,"url",void 0),t.__decorate([a.property({readOnly:!0})],B.prototype,"version",void 0),t.__decorate([s.reader("version",["version","currentVersion"])],B.prototype,"readVersion",null),t.__decorate([a.property({readOnly:!0,dependsOn:["tileInfo"]})],B.prototype,"compatibleTileInfo256",null),t.__decorate([a.property({readOnly:!0,dependsOn:["tileInfo"]})],B.prototype,"compatibleTileInfo512",null),B=t.__decorate([c.subclass("esri.layers.VectorTileLayer")],B),B}.apply(t,i))||(e.exports=o)},59332:(e,t,r)=>{var i,o;i=[t,r(58797),r(11285),r(74637),r(73462),r(67059),r(26475),r(59376),r(99752),r(4037),r(51916),r(18377),r(23084),r(26016),r(89425),r(83568)],void 0===(o=function(e,r,i,o,l,n,a,s,c,p,u,h,y,d,f,_){"use strict";t.ArcGISCachedService=e=>{let t=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).copyright=null,t.minScale=0,t.maxScale=0,t.spatialReference=null,t.tileInfo=null,t.tilemapCache=null,t}r._inheritsLoose(t,e);var i=t.prototype;return i.readMinScale=function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0},i.readMaxScale=function(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0},i.readTilemapCache=function(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new _.TilemapCache({layer:this}):null},r._createClass(t,[{key:"supportsBlankTile",get:function(){return this.version>=10.2}}]),t}(e);return i.__decorate([a.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),i.__decorate([a.property()],t.prototype,"minScale",void 0),i.__decorate([s.reader("service","minScale")],t.prototype,"readMinScale",null),i.__decorate([a.property()],t.prototype,"maxScale",void 0),i.__decorate([s.reader("service","maxScale")],t.prototype,"readMaxScale",null),i.__decorate([a.property({type:y})],t.prototype,"spatialReference",void 0),i.__decorate([a.property({readOnly:!0,dependsOn:["version"]})],t.prototype,"supportsBlankTile",null),i.__decorate([a.property(f.serviceTileInfoProperty)],t.prototype,"tileInfo",void 0),i.__decorate([a.property()],t.prototype,"tilemapCache",void 0),i.__decorate([s.reader("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),i.__decorate([a.property()],t.prototype,"version",void 0),t=i.__decorate([c.subclass("esri.layers.mixins.ArcGISCachedService")],t),t},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=o)},93595:(e,t,r)=>{var i,o;i=[r(58797),r(73462),r(49359),r(4037),r(9720),r(40810)],void 0===(o=function(e,t,r,i,o,l){"use strict";const n=t.getLogger("esri.layers.support.SpriteSource");return function(){function t(e,t,r,i){this.baseURL=e,this.devicePixelRatio=t,this.maxTextureSize=r,this._spriteImageFormat=i,this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded"}var a=t.prototype;return a.getSpriteInfo=function(e){return this._spritesData[e]},a.load=async function(e){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(e),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"},a._loadSprites=function(e){this._isRetina=this.devicePixelRatio>1.15;const t=i.urlToObject(this.baseURL),a=t.query?"?"+i.objectToQuery(t.query):"",s=this._isRetina?"@2x":"",c=`${t.path}${s}.${this._spriteImageFormat}${a}`,p=`${t.path}${s}.json${a}`;return o.all([l(p,e),l(c,{responseType:"image",...e})]).then((([e,i])=>{const l=Object.keys(e.data);if(!l||0===l.length||1===l.length&&"_ssl"===l[0]||!i||!i.data)return this._spritesData=this.image=null,this.width=this.height=0,o.resolve(null);this._spritesData=e.data;const a=i.data,s=Math.max(this.maxTextureSize,4096);if(a.width>s||a.height>s){const e=`Sprite resource for style ${t.path} is bigger than the maximum allowed of ${s} pixels}`;throw n.error(e),new r("SpriteSource",e)}this.width=a.width,this.height=a.height;const c=document.createElement("canvas"),p=c.getContext("2d");c.width=a.width,c.height=a.height,p.drawImage(a,0,0,a.width,a.height);const u=p.getImageData(0,0,a.width,a.height),h=new Uint8Array(u.data);let y;for(let e=0;e<h.length;e+=4)y=h[e+3]/255,h[e]=h[e]*y,h[e+1]=h[e+1]*y,h[e+2]=h[e+2]*y;this.image=h}))},e._createClass(t,[{key:"spriteNames",get:function(){const e=[];for(const t in this._spritesData)e.push(t);return e.sort(),e}}]),t}()}.apply(t,i))||(e.exports=o)},24048:(e,t,r)=>{var i,o;i=[t,r(92231),r(49359),r(45630),r(40810)],void 0===(o=function(e,r,i,o,l){"use strict";let n=function(){function e(){this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}var t=e.prototype;return t.getAvailability=function(e,t){if("unknown"!==this._allAvailability)return this._allAvailability;const r=(e-this.location.top)*this.location.width+(t-this.location.left),i=r%8,o=r>>3,l=this._tileAvailabilityBitSet;return o<0||o>l.length?"unknown":l[o]&1<<i?"available":"unavailable"},t._updateFromData=function(e){const t=this.location.width,r=this.location.height;let i=!0,o=!0;const l=Math.ceil(t*r/8),n=new Uint8Array(l);let a=0;for(let t=0;t<e.length;t++){const r=t%8;e[t]?(o=!1,n[a]|=1<<r):i=!1,7===r&&++a}o?this._allAvailability="unavailable":i?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=n,this.byteSize+=n.length)},e.fromDefinition=function(t,r){const n=t.service.request||l,{row:s,col:c,width:p,height:u}=t,h={query:{f:"json"}};return r=r?{...h,...r}:h,n(a(t),r).then((e=>e.data)).catch((e=>{if(e&&e.details&&422===e.details.httpStatus)return{location:{top:s,left:c,width:p,height:u},valid:!0,data:o.constant(p*u,0)};throw e})).then((t=>{if(t.location&&(t.location.top!==s||t.location.left!==c||t.location.width!==p||t.location.height!==u))throw new i("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:s,left:c,width:p,height:u}});return e.fromJSON(t)}))},e.fromJSON=function(t){e.validateJSON(t);const i=new e;return i.location=Object.freeze(r.clone(t.location)),i._updateFromData(t.data),Object.freeze(i)},e.validateJSON=function(e){if(!e||!e.location)throw new i("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new i("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new i("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new i("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new i("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")},e}();function a(e){let t;if("vector-tile"===e.service.type)t=`${e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`;else{const r=e.service.tileServers;t=`${r&&r.length?r[e.row%r.length]:e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}const r=e.service.query;return r&&(t=`${t}?${r}`),t}t.Tilemap=n,t.default=n,t.tilemapDefinitionId=function(e){return`${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`},t.tilemapDefinitionUrl=a,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=o)},83568:(e,t,r)=>{var i,o;i=[t,r(58797),r(11285),r(74637),r(73462),r(26475),r(37055),r(99752),r(49359),r(4037),r(51916),r(18377),r(20499),r(9720),r(48199),r(37862),r(40810),r(75416),r(69788),r(79058),r(24048)],void 0===(o=function(e,r,i,o,l,n,a,s,c,p,u,h,y,d,f,_,m,v,S,A,T){"use strict";var g;const I=l.getLogger("esri.layers.support.TilemapCache");t.TilemapCache=g=function(e){function t(t){var r;return(r=e.call(this,t)||this)._handles=new v,r._pendingTilemapRequests={},r._availableLevels={},r.levels=5,r.cacheByteSize=2097152,r.request=m,r._prefetchingEnabled=!0,r}r._inheritsLoose(t,e);var i=t.prototype;return i.initialize=function(){this._tilemapCache=new A(this.cacheByteSize),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],(()=>this._initializeTilemapDefinition())),S.init(this,"layer.tileInfo.lods",(e=>this._initializeAvailableLevels(e)),!0)]),this._initializeTilemapDefinition()},i.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)},i.castLevels=function(e){return e<=2?(I.error("Minimum levels for Tilemap is 3, but got ",e),3):e},i.fetchTilemap=function(e,t,r,i){if(!this._availableLevels[e])return d.reject(new c("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const o=this._tmpTilemapDefinition,l=this._tilemapFromCache(e,t,r,o);if(l)return d.resolve(l);const n=i&&i.signal;return i={...i,signal:null},d.create(((e,t)=>{d.onAbort(n,(()=>t(d.createAbortError())));const r=T.tilemapDefinitionId(o);let l=this._pendingTilemapRequests[r];if(!l){l=T.Tilemap.fromDefinition(o,i).then((e=>(this._tilemapCache.put(r,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[r];this._pendingTilemapRequests[r]=l,l.then(e,e)}l.then(e,t)}))},i.getAvailability=function(e,t,r){if(!this._availableLevels[e])return"unavailable";const i=this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition);return i?i.getAvailability(t,r):"unknown"},i.getAvailabilityUpsample=function(e,t,r,i){i.level=e,i.row=t,i.col=r;const o=this.layer.tileInfo;for(o.updateTileInfo(i);;){const e=this.getAvailability(i.level,i.row,i.col);if("unavailable"!==e)return e;if(!o.upsampleTile(i))return"unavailable"}},i.fetchAvailability=function(e,t,r,i){return this._availableLevels[e]?this.fetchTilemap(e,t,r,i).catch((e=>e)).then((i=>{if(i instanceof T.Tilemap){const o=i.getAvailability(t,r);return"unavailable"===o?d.reject(new c("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):o}if(d.isAbortError(i))throw i;return"unknown"})):d.reject(new c("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`))},i.fetchAvailabilityUpsample=function(e,t,r,i,o){i.level=e,i.row=t,i.col=r;const l=this.layer.tileInfo;l.updateTileInfo(i);const n=this.fetchAvailability(e,t,r,o).catch((e=>{if(d.isAbortError(e))throw e;if(l.upsampleTile(i))return this.fetchAvailabilityUpsample(i.level,i.row,i.col,i);throw e}));return this._fetchAvailabilityUpsamplePrefetch(i.id,e,t,r,o,n),n},i._fetchAvailabilityUpsamplePrefetch=async function(e,t,r,i,o,l){if(!this._prefetchingEnabled)return;const n=`prefetch-${e}`;if(this._handles.has(n))return;const a=d.createAbortController();l.then((()=>a.abort()),(()=>a.abort()));let s=!1;const c={remove(){s||(s=!0,a.abort())}};if(this._handles.add(c,n),await f.waitTicks(10,a.signal).catch((()=>{})),s||(s=!0,this._handles.remove(n)),d.isAborted(a))return;const p={id:e,level:t,row:r,col:i},u={...o,signal:a.signal},h=this.layer.tileInfo;for(let e=0;g._prefetches.length<g._maxPrefetch&&h.upsampleTile(p);++e){const e=this.fetchAvailability(p.level,p.row,p.col,u);g._prefetches.push(e);const t=()=>{g._prefetches.removeUnordered(e)};e.then(t,t)}},i._initializeTilemapDefinition=function(){if(!this.layer.parsedUrl)return;const e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?p.objectToQuery(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}},i._tilemapFromCache=function(e,t,r,i){i.level=e,i.row=t-t%this.size,i.col=r-r%this.size;const o=T.tilemapDefinitionId(i);return this._tilemapCache.get(o)},i._initializeAvailableLevels=function(e){this._availableLevels={},e&&e.forEach((e=>this._availableLevels[e.level]=!0))},r._createClass(t,[{key:"size",get:function(){return 1<<this.levels}},{key:"test",get:function(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,r,i)=>!!e._tilemapFromCache(t,r,i,e._tmpTilemapDefinition)}}}]),t}(_),t.TilemapCache._maxPrefetch=4,t.TilemapCache._prefetches=new y({initialSize:g._maxPrefetch}),i.__decorate([n.property({constructOnly:!0,type:Number})],e.TilemapCache.prototype,"levels",void 0),i.__decorate([a.cast("levels")],e.TilemapCache.prototype,"castLevels",null),i.__decorate([n.property({readOnly:!0,dependsOn:["levels"],type:Number})],e.TilemapCache.prototype,"size",null),i.__decorate([n.property({constructOnly:!0,type:Number})],e.TilemapCache.prototype,"cacheByteSize",void 0),i.__decorate([n.property({constructOnly:!0})],e.TilemapCache.prototype,"layer",void 0),i.__decorate([n.property({constructOnly:!0})],e.TilemapCache.prototype,"request",void 0),t.TilemapCache=g=i.__decorate([s.subclass("esri.layers.support.TilemapCache")],e.TilemapCache),Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=o)},36889:(e,t)=>{var r;void 0===(r=function(e){"use strict";t.checkWebPSupport=function(e){const t={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return new Promise((r=>{const i=new Image;i.onload=()=>{i.onload=i.onerror=null,r(i.width>0&&i.height>0)},i.onerror=()=>{i.onload=i.onerror=null,r(!1)},i.src="data:image/webp;base64,"+t[e]}))},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,[t]))||(e.exports=r)},89425:(e,t,r)=>{var i,o;i=[t,r(72146)],void 0===(o=function(e,r){"use strict";const i={type:r,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:o}}}}};function o(e,t,i,o){if(!e)return null;const{minScale:l,maxScale:n,minLOD:a,maxLOD:s}=t;if(null!=a&&null!=s)return o&&o.ignoreMinMaxLOD?r.fromJSON(e):r.fromJSON({...e,lods:e.lods.filter((({level:e})=>null!=e&&e>=a&&e<=s))});if(0!==l&&0!==n){const t=e=>Math.round(1e4*e)/1e4,i=l?t(l):1/0,o=n?t(n):-1/0;return r.fromJSON({...e,lods:e.lods.filter((e=>{const r=t(e.scale);return r<=i&&r>=o}))})}return r.fromJSON(e)}t.readServiceTileInfo=o,t.serviceTileInfoProperty=i,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=o)},52295:(e,t,r)=>{var i,o;i=[t,r(37578),r(4037),r(9720),r(40810),r(18706)],void 0===(o=function(e,r,i,o,l,n){"use strict";const a=r.defaults&&r.defaults.io.corsEnabledServers;function s(e){if(!e)return;const t=i.getOrigin(e);a&&-1===a.indexOf(t)&&a.push(t)}function c(...e){let t;for(let r=0;r<e.length;++r)if(i.isProtocolRelative(e[r])){if(t){const i=t.split("://")[0];t=i+":"+e[r].trim()}}else t=i.isAbsolute(e[r])?e[r]:i.join(t,e[r]);return i.removeTrailingSlash(t)}async function p(e,t,r,n,a){let y,d,f;if(o.throwIfAborted(a),"string"==typeof r){const e=i.normalize(r);s(e);const t=i.urlToObject(e);f=await l(t.path,{query:{f:"json"},responseType:"json",...a}),y=e,d=e}else f={data:r},y=r.jsonUrl||null,d=n;const _=f.data;return f.ssl&&(y&&(y=y.replace(/^http:/i,"https:")),d&&(d=d.replace(/^http:/i,"https:"))),u(_)?(e.styleUrl=y||null,async function(e,t,r,l){const n=r?i.removeFile(r):i.appBaseUrl;e.styleBase=n,e.style=t,e.styleUrl&&s(e.styleUrl),t["sprite-format"]&&"webp"===t["sprite-format"].toLowerCase()&&(e.spriteFormat="webp");const a=[];if(t.sources&&t.sources.esri){const r=t.sources.esri;r.url?await p(e,"esri",c(n,r.url),void 0,l):a.push(p(e,"esri",r,n,l))}for(const r of Object.keys(t.sources))"esri"!==r&&"vector"===t.sources[r].type&&(t.sources[r].url?a.push(p(e,r,c(n,t.sources[r].url),void 0,l)):a.push(p(e,r,t.sources[r],n,l)));await o.all(a)}(e,_,d,a)):u(_)?o.reject("You must specify the URL or the JSON for a service or for a style."):e.sourceUrl?h(e,_,d,!1,t,a):(e.sourceUrl=y||null,h(e,_,d,!0,t,a))}function u(e){return!!e.sources}async function h(e,t,r,l,a,u){const h=r?i.removeTrailingSlash(r)+"/":i.appBaseUrl,y=function(e,t){if(e.hasOwnProperty("tileInfo"))return e;const r={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100}};let i=78271.51696400007,o=295828763.7957775;const l=[],n=e.hasOwnProperty("minzoom")?parseFloat(e.minzoom):0,a=e.hasOwnProperty("maxzoom")?parseFloat(e.maxzoom):22;for(let e=0;e<=a;e++)e>=n&&l.push({level:e,scale:o,resolution:i}),i/=2,o/=2;for(const r of e.tiles)s(c(t,r));return{capabilities:"TilesOnly",initialExtent:r,fullExtent:r,minScale:0,maxScale:0,tiles:e.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-20037508.342787,y:20037508.342787},lods:l,spatialReference:{wkid:102100}}}}(t,h),d=new n(a,h,y);if(!l&&e.primarySourceName in e.sourceNameToSource){const t=e.sourceNameToSource[e.primarySourceName];if(!t.isCompatibleWith(d))return o.resolve();null!=d.fullExtent&&(null!=t.fullExtent?t.fullExtent.union(d.fullExtent):t.fullExtent=d.fullExtent.clone()),t.tileInfo.lods.length<d.tileInfo.lods.length&&(t.tileInfo=d.tileInfo)}if(l?(e.sourceBase=h,e.source=t,e.validatedSource=y,e.primarySourceName=a,e.sourceUrl&&s(e.sourceUrl)):s(h),e.sourceNameToSource[a]=d,!e.style)return null==t.defaultStyles?o.reject():"string"==typeof t.defaultStyles?p(e,"",c(h,t.defaultStyles,"root.json"),void 0,u):p(e,"",t.defaultStyles,c(h,"root.json"),u)}t.loadMetadata=async function(e,t){const r={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[o,l]="string"==typeof e?[e,null]:[null,e.jsonUrl],n=o?i.urlToObject(o):null;await p(r,"esri",e,l,t);const a={layerDefinition:r.validatedSource,url:o,parsedUrl:n,serviceUrl:r.sourceUrl,style:r.style,styleUrl:r.styleUrl,spriteUrl:r.style.sprite&&c(r.styleBase,r.style.sprite),spriteFormat:r.spriteFormat,glyphsUrl:r.style.glyphs&&c(r.styleBase,r.style.glyphs),sourceNameToSource:r.sourceNameToSource,primarySourceName:r.primarySourceName};return s(a.spriteUrl),s(a.glyphsUrl),a},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=o)},36239:(e,t,r)=>{var i,o;i=[t,r(4037),r(25489)],void 0===(o=function(e,r,i){"use strict";t.createForItem=function(e){return{origin:"portal-item",url:r.urlToObject(e.itemUrl),portal:e.portal||i.getDefault(),portalItem:e,readResourcePaths:[]}},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=o)},3462:(e,t,r)=>{var i,o;i=[r(36368),r(72146)],void 0===(o=function(e,t){"use strict";return function(){function r(e,t){this.lockedSchemaPixelSize=e,this.isGCS=t}var i=r.prototype;return i.getLevelRowColumn=function(e){return this.isGCS?[e[0],e[1]>>1,e[2]>>1]:256===this.lockedSchemaPixelSize&&e[0]>0?[e[0]-1,e[1]>>1,e[2]>>1]:e},i.adjustLevel=function(e){return this.isGCS?e:256===this.lockedSchemaPixelSize?e>0?e-1:0:e},i.getShift=function(e,t){let r=0,i=0;return(256===this.lockedSchemaPixelSize||this.isGCS)&&(e[2]%2&&(r=t),e[1]%2&&(i=t)),[r,i]},i.getScale=function(e){if(this.isGCS){if(512===this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===e)return 1;return 2},r.create256x256CompatibleTileInfo=function(r){if(!r)return null;if(256===r.size[0]&&256===r.size[1])return r;const i=r.spatialReference.isGeographic,o=[],l=r.lods.length;for(let t=0;t<l;t++){const l=r.lods[t],n=i?l.resolution:2*l.resolution;o.push(new e({level:l.level,scale:l.scale,resolution:n}))}return new t({size:[256,256],dpi:r.dpi,format:r.format,compressionQuality:r.compressionQuality,origin:r.origin,spatialReference:r.spatialReference,lods:o})},r.create512x512CompatibleTileInfo=function(r){if(!r)return null;if(256===r.size[0]||256===r.size[1])return null;const i=[],o=r.lods.length;for(let t=0;t<o;t++){const o=r.lods[t],l=.5*o.resolution;i.push(new e({level:o.level,scale:o.scale,resolution:l}))}return new t({size:[512,512],dpi:r.dpi,format:r.format,compressionQuality:r.compressionQuality,origin:r.origin,spatialReference:r.spatialReference,lods:i})},r}()}.apply(t,i))||(e.exports=o)},51078:(e,t,r)=>{var i,o;i=[r(9720),r(83568),r(11286)],void 0===(o=function(e,t,r){"use strict";return function(){function i(e){if(e instanceof t.TilemapCache)this._tilemapCache=e;else{if(!e||!("index"in e))throw new Error("Invalid tilemap!");this._tilemap=e.index}}var o=i.prototype;return o.dataKey=function(t,i){if(this._tilemapCache){const{level:o,row:l,col:n}=t,a=new r(t);return this._tilemapCache.fetchAvailabilityUpsample(o,l,n,a,i).then((()=>(a.world=t.world,a))).catch((t=>{if(e.isAbortError(t))throw t;return null}))}return this._getIndexedDataKey(t)},o.forEach=function(e,t,r,i,o){this._callback=o,this._maxLevel=t+e,this._forEach(this._tilemap,t,r,i)},o._forEach=function(e,t,r,i){0!==e&&(this._callback(t,r,i),t!==this._maxLevel&&"object"==typeof e&&(this._forEach(e[0],t+1,2*r,2*i),this._forEach(e[1],t+1,2*r,2*i+1),this._forEach(e[2],t+1,2*r+1,2*i),this._forEach(e[3],t+1,2*r+1,2*i+1)))},o._getIndexedDataKey=function(t){const i=[t];if(t.level<0||t.row<0||t.col<0||t.row>>t.level>0||t.col>>t.level>0)return e.resolve(null);let o=t;for(;0!==o.level;)o=new r(o.level-1,o.row>>1,o.col>>1,o.world),i.push(o);let l,n,a=this._tilemap,s=i.pop();if(1===a)return e.resolve(s);for(;i.length;)if(l=i.pop(),n=(1&l.col)+((1&l.row)<<1),a){if(0===a[n]){s=null;break}if(1===a[n]){s=l;break}s=l,a=a[n]}return e.resolve(s)},i}()}.apply(t,i))||(e.exports=o)},18706:(e,t,r)=>{var i,o;i=[r(92231),r(4037),r(9720),r(12997),r(89425),r(83568),r(51078)],void 0===(o=function(e,t,r,i,o,l,n){"use strict";return function(){function a(r,a,s){this.tileMapURL="",this.tilemapCache=null,this.parsedUrl=null,this.tileInfo=null,this.capabilities=null,this.tileIndex=null,this.fullExtent=null,this.name=r,this.sourceUrl=a,a&&(this.parsedUrl=t.urlToObject(this.sourceUrl));const c=this.parsedUrl.path,p=this.parsedUrl.query?"?"+t.objectToQuery(this.parsedUrl.query):"",u=e.clone(s),h=u.tiles;a&&h.forEach(((e,r)=>{t.isAbsolute(e)||(h[r]=t.join(c,e)+p)})),this.tileServers=h,s.tileMap&&(this.tileMapURL=t.join(a,s.tileMap));const y=s.capabilities&&s.capabilities.split(",").map((e=>e.toLowerCase().trim())),d=!!s.exportTilesAllowed,f=!!y&&-1!==y.indexOf("tilemap"),_=d&&s.hasOwnProperty("maxExportTilesCount")?s.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:d,supportsTileMap:f},exportTiles:d?{maxExportTilesCount:+_}:null},this.tileInfo=o.readServiceTileInfo(u.tileInfo,u,null,{ignoreMinMaxLOD:!0}),f&&(this.type="vector-tile",this.tilemapCache=new l.TilemapCache({layer:this}),this.tilemapCache&&(this.tileIndex=new n(this.tilemapCache))),this.fullExtent=i.fromJSON(s.fullExtent)}var s=a.prototype;return s.getRefKey=function(e,t){return this.tileIndex?this.tileIndex.dataKey(e,t):r.resolve(e)},s.getSourceTileUrl=function(e,t,r){let i=this.tileServers[t%this.tileServers.length];return i=i.replace(/\{z\}/gi,e.toString()).replace(/\{y\}/gi,t.toString()).replace(/\{x\}/gi,r.toString()),i},s.isCompatibleWith=function(e){const t=this.tileInfo,r=e.tileInfo;if(!t.spatialReference.equals(r.spatialReference))return!1;if(!t.origin.equals(r.origin))return!1;if(Math.round(t.dpi)!==Math.round(r.dpi))return!1;const i=t.lods,o=r.lods,l=Math.min(i.length,o.length);for(let e=0;e<l;e++){const t=i[e],r=o[e];if(t.level!==r.level||Math.round(t.scale)!==Math.round(r.scale))return!1}return!0},a}()}.apply(t,i))||(e.exports=o)},63324:(e,t,r)=>{var i,o;i=[t,r(72146)],void 0===(o=function(e,r){"use strict";const i=1e-6;t.areSchemasOverlapping=function(e,t){if(e===t)return!0;if(!e&&null!=t)return!1;if(null!=e&&!t)return!1;if(!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;const r=e.origin,o=t.origin;if(Math.abs(r.x-o.x)>=i||Math.abs(r.y-o.y)>=i)return!1;let l,n;e.lods[0].scale>t.lods[0].scale?(l=e,n=t):(n=e,l=t);for(let e=l.lods[0].scale;e>=n.lods[n.lods.length-1].scale-i;e/=2)if(Math.abs(e-n.lods[0].scale)<i)return!0;return!1},t.unionTileInfos=function(e,t){if(e===t)return e;if(!e&&null!=t)return t;if(null!=e&&!t)return e;const i=e.size[0],o=e.format,l=e.dpi,n={x:e.origin.x,y:e.origin.y},a=e.spatialReference.toJSON(),s=e.lods[0].scale>t.lods[0].scale?e.lods[0]:t.lods[0],c=e.lods[e.lods.length-1].scale<=t.lods[t.lods.length-1].scale?e.lods[e.lods.length-1]:t.lods[t.lods.length-1],p=s.scale,u=s.resolution,h=c.scale,y=[];let d=p,f=u,_=0;for(;d>h;)y.push({level:_,resolution:f,scale:d}),_++,d/=2,f/=2;return new r({size:[i,i],dpi:l,format:o||"pbf",origin:n,lods:y,spatialReference:a})},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=o)},39241:(e,t)=>{var r;void 0===(r=function(e){"use strict";t.ANGLE_FACTOR_256=256/360,t.ATTRIBUTE_DATA_ANIMATION=1,t.ATTRIBUTE_DATA_DD0=3,t.ATTRIBUTE_DATA_DD1=3,t.ATTRIBUTE_DATA_FILTER_FLAGS=0,t.ATTRIBUTE_DATA_VV=2,t.ATTRIBUTE_STORE_TEXTURE_SIZE=1024,t.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}},t.COLLISION_BOX_PADDING=16,t.COLLISION_BUCKET_SIZE=128,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=16,t.COLLISION_MAX_ZOOM_DELTA=1,t.COLLISION_PLACEMENT_PADDING=8,t.COLLISION_TILE_BOX_SIZE=4,t.DEBUG_LABELS=!1,t.DOT_DENSITY_MAX_FIELDS=8,t.EFFECT_FLAG_0=4,t.EXTRUDE_SCALE=64,t.FILTER_FLAG_0=2,t.GLYPH_SIZE=24,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HIGHLIGHT_FLAG=1,t.HITTEST_SEARCH_SIZE=6,t.MAGIC_LABEL_LINE_HEIGHT=29,t.MAX_FILTERS=2,t.MAX_GPU_UPLOADS_PER_FRAME=2,t.NAN_MAGIC_NUMBER=1e-30,t.PICTURE_FILL_COLOR=4294967295,t.RASTER_TILE_SIZE=256,t.SPRITE_PADDING=2,t.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1,t.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2,t.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3,t.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4,t.TEXTURE_BINDING_BITMAP=0,t.TEXTURE_BINDING_GLYPH_ATLAS=0,t.TEXTURE_BINDING_HIGHLIGHT_0=5,t.TEXTURE_BINDING_HIGHLIGHT_1=6,t.TEXTURE_BINDING_RENDERER_0=5,t.TEXTURE_BINDING_RENDERER_1=6,t.TEXTURE_BINDING_SPRITE_ATLAS=0,t.TEXT_PLACEMENT_PADDING=8,t.THIN_LINE_THRESHOLD=2.5,t.TILE_SIZE=512,t.VTL_HIGH_RES_CUTOFF=1.15,t.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6,t.VTL_TEXTURE_BINDING_UNIT_SPRITES=5,t.WEBGL_MAX_INNER_STOPS=6,t.WEBGL_MAX_STOPS=8,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,[t]))||(e.exports=r)}}]);