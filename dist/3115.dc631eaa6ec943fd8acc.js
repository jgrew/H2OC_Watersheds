(self.webpackChunkh2oc=self.webpackChunkh2oc||[]).push([[3115],{5999:(e,t,r)=>{var i,n;i=[t,r(57167)],void 0===(n=function(e,r){"use strict";function i(e){return e&&"upperLeft"===e.originPosition}const n=(e,t,r)=>[t,r],o=(e,t,r)=>[t,r,e[2]],a=(e,t,r)=>[t,r,e[2],e[3]];function s({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function l({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function c(e,t,r){const i=[];let n,o,a,c;for(let m=0;m<r.length;m++){const u=r[m];m>0?(a=s(e,u[0]),c=l(e,u[1]),a===n&&c===o||(i.push(t(u,a-n,c-o)),n=a,o=c)):(n=s(e,u[0]),o=l(e,u[1]),i.push(t(u,n,o)))}return i.length>0?i:null}function m(e,t,r,i){return c(e,r?i?a:o:i?o:n,t)}function u(e,t,r,i){const s=[],l=r?i?a:o:i?o:n;for(let r=0;r<t.length;r++){const i=c(e,l,t[r]);i&&i.length>=3&&s.push(i)}return s.length?s:null}function f(e,t,r,i){const s=[],l=r?i?a:o:i?o:n;for(let r=0;r<t.length;r++){const i=c(e,l,t[r]);i&&i.length>=2&&s.push(i)}return s.length?s:null}function h({scale:e,translate:t},r){return r*e[0]+t[0]}function y({scale:e,translate:t},r){return t[1]-r*e[1]}function p(e,t,r){const i=new Array(r.length);if(!r.length)return i;const[n,o]=e.scale;let a=h(e,r[0][0]),s=y(e,r[0][1]);i[0]=t(r[0],a,s);for(let e=1;e<r.length;e++){const l=r[e];a+=l[0]*n,s-=l[1]*o,i[e]=t(l,a,s)}return i}function g(e,t,r){const i=new Array(r.length);for(let n=0;n<r.length;n++)i[n]=p(e,t,r[n]);return i}function d(e,t,r,i){return p(e,r?i?a:o:i?o:n,t)}function x(e,t,r,i){return g(e,r?i?a:o:i?o:n,t)}function C(e,t,r,i){return g(e,r?i?a:o:i?o:n,t)}function S(e,t,r){let[i,n]=r[0],o=Math.min(i,t[0]),a=Math.min(n,t[1]),s=Math.max(i,t[2]),l=Math.max(n,t[3]);for(let e=1;e<r.length;e++){const[t,c]=r[e];i+=t,n+=c,t<0&&(o=Math.min(o,i)),t>0&&(s=Math.max(s,i)),c<0?a=Math.min(a,n):c>0&&(l=Math.max(l,n))}return e[0]=o,e[1]=a,e[2]=s,e[3]=l,e}function M(e,t){if(!t.length)return null;e[0]=e[1]=Number.POSITIVE_INFINITY,e[2]=e[3]=Number.NEGATIVE_INFINITY;for(let r=0;r<t.length;r++)S(e,e,t[r]);return e}function v(e,t,r,i,n){return t.xmin=s(e,r.xmin),t.ymin=l(e,r.ymin),t.xmax=s(e,r.xmax),t.ymax=l(e,r.ymax),t!==r&&(i&&(t.zmin=r.zmin,t.zmax=r.zmax),n&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function b(e,t,r,i,n){return t.points=m(e,r.points,i,n),t}function I(e,t,r,i,n){return t.x=s(e,r.x),t.y=l(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m)),t}function z(e,t,r,i,n){const o=u(e,r.rings,i,n);return o?(t.rings=o,t):null}function P(e,t,r,i,n){const o=f(e,r.paths,i,n);return o?(t.paths=o,t):null}t.equals=function(e,t){if(e===t||null==e&&null==t)return!0;if(null==e||null==t)return!1;let r,n,o,a,s,l;return i(e)?(r=e.translate[0],n=e.translate[1],o=e.scale[0]):(r=e.extent.xmin,n=e.extent.ymax,o=e.tolerance),i(t)?(a=t.translate[0],s=t.translate[1],l=t.scale[0]):(a=t.extent.xmin,s=t.extent.ymax,l=t.tolerance),r===a&&n===s&&o===l},t.getQuantizedBoundsCoordsArray=S,t.getQuantizedBoundsCoordsArrayArray=M,t.getQuantizedBoundsPaths=function(e){return M([0,0,0,0],e)},t.getQuantizedBoundsPoints=function(e){const t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return S(t,t,e)},t.getQuantizedBoundsRings=function(e){return M([0,0,0,0],e)},t.quantizeBounds=function(e,t,r){return t[0]=s(e,r[0]),t[3]=l(e,r[1]),t[2]=s(e,r[2]),t[1]=l(e,r[3]),t},t.quantizeExtent=v,t.quantizeGeometry=function(e,t){return e&&t?r.isPoint(t)?I(e,{},t,!1,!1):r.isPolyline(t)?P(e,{},t,!1,!1):r.isPolygon(t)?z(e,{},t,!1,!1):r.isMultipoint(t)?b(e,{},t,!1,!1):r.isExtent(t)?v(e,{},t,!1,!1):null:null},t.quantizeMultipoint=b,t.quantizePaths=f,t.quantizePoint=I,t.quantizePoints=m,t.quantizePolygon=z,t.quantizePolyline=P,t.quantizeRings=u,t.quantizeX=s,t.quantizeY=l,t.toQuantizationTransform=function(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null},t.unquantizeBounds=function(e,t,r){return r?(t[0]=h(e,r[0]),t[1]=y(e,r[3]),t[2]=h(e,r[2]),t[3]=y(e,r[1]),t):[h(e,t[0]),y(e,t[3]),h(e,t[2]),y(e,t[1])]},t.unquantizeCoordsArray=p,t.unquantizeCoordsArrayArray=g,t.unquantizeExtent=function(e,t,r,i,n){return t.xmin=h(e,r.xmin),t.ymin=y(e,r.ymin),t.xmax=h(e,r.xmax),t.ymax=y(e,r.ymax),t!==r&&(i&&(t.zmin=r.zmin,t.zmax=r.zmax),n&&(t.mmin=r.mmin,t.mmax=r.mmax)),t},t.unquantizeMultipoint=function(e,t,r,i,n){return t.points=d(e,r.points,i,n),t},t.unquantizePaths=x,t.unquantizePoint=function(e,t,r,i,n){return t.x=h(e,r.x),t.y=y(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m)),t},t.unquantizePoints=d,t.unquantizePolygon=function(e,t,r,i,n){return t.rings=C(e,r.rings,i,n),t},t.unquantizePolyline=function(e,t,r,i,n){return t.paths=x(e,r.paths,i,n),t},t.unquantizeRings=C,t.unquantizeX=h,t.unquantizeY=y,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=n)},89341:(e,t,r)=>{var i,n;i=[t,r(73227),r(9720),r(57167),r(90920),r(7168),r(40810),r(80476),r(99141),r(30453),r(58323),r(22355)],void 0===(n=function(e,r,i,n,o,a,s,l,c,m,u,f){"use strict";var h;(h=e.GeometryStyle||(t.GeometryStyle={})).Legend="legend",h.Preview="preview";const y=(e,t,r)=>{if(e&&e.targetSize){let i;if(r){const t=Math.max(r.frame.xmax-r.frame.xmin,r.frame.ymax-r.frame.ymin);i=e.targetSize/o.pt2px(t)}else i=e.targetSize/t.referenceSize;return i}return e&&e.scaleFactor?e.scaleFactor:1},p={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};let g=function(){function t(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._rasterizer=new u,this._textRasterizer=new f.TextRasterizer,this._pictureMarkerCache=new Map}var h=t.prototype;return h.rasterizeCIMSymbolAsync=async function(e,t,r,i,o,a,s,l){i=i||(t?null!=t.centroid?"esriGeometryPolygon":n.getJsonType(t.geometry):null)||function(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}(e);const c=await this.analyzeCIMSymbol(e,t?function(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}(t.attributes):null,r,i,l);return this.rasterizeCIMSymbol(c,t,i,o,a,s)},h.analyzeCIMSymbol=async function(e,t,r,n,o){const a=[],s=t?{geometryType:n,spatialReference:this._spatialReference,fields:t}:null;let c;await m.analyzeCIMSymbol(e.data,s,a,this._avoidSDF),i.throwIfAborted(o);for(const e of a)"CIMPictureMarker"!==e.cim.type&&"CIMPictureFill"!==e.cim.type&&"CIMPictureStroke"!==e.cim.type||(c||(c=[]),c.push(this.fetchPictureMarkerResource(e,o))),r&&"text"===e.type&&"string"==typeof e.text&&e.text.indexOf("[")>-1&&(e.text=l.createLabelOverrideFunction(r,e.text,e.cim.textCase));return c&&await i.all(c),a},h.fetchPictureMarkerResource=async function(e,t){const r=e.materialHash;if(!this._pictureMarkerCache.get(r)){const i=(await s(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;this._pictureMarkerCache.set(r,i)}},h.rasterizeCIMSymbol=function(e,t,r,i,n,o){const a=[];for(const s of e){i&&"function"==typeof i.scaleFactor&&(i.scaleFactor=i.scaleFactor(t,n,o));const e=this._getRasterizedResource(s,t,r,i,n,o);if(!e)continue;let c=0,m=e.anchorX||0,u=e.anchorY||0,f=!1,h=0,p=0;if("esriGeometryPoint"===r){const e=y(i,s,null);if(h=l.evaluateValueOrFunction(s.offsetX,t,n,o)*e||0,p=l.evaluateValueOrFunction(s.offsetY,t,n,o)*e||0,"marker"===s.type)c=l.evaluateValueOrFunction(s.rotation,t,n,o)||0,f=!!s.rotateClockwise&&s.rotateClockwise;else if("text"===s.type){if(c=l.evaluateValueOrFunction(s.angle,t,n,o)||0,void 0!==s.horizontalAlignment)switch(s.horizontalAlignment){case"left":m=-.5;break;case"right":m=.5;break;default:m=0}if(void 0!==s.verticalAlignment)switch(s.verticalAlignment){case"top":u=.5;break;case"bottom":u=-.5;break;case"baseline":u=-.25;break;default:u=0}}}null!=e&&a.push({angle:c,rotateClockWise:f,anchorX:m,anchorY:u,offsetX:h,offsetY:p,rasterizedResource:e})}return this.getSymbolImage(a)},h.getSymbolImage=function(e){const t=document.createElement("canvas"),r=t.getContext("2d");let i=0,n=0,s=0,l=0;const c=[];for(let t=0;t<e.length;t++){const a=e[t],m=a.rasterizedResource;if(!m)continue;const u=m.size,f=a.offsetX,h=a.offsetY,y=a.anchorX,p=a.anchorY,g=a.rotateClockWise||!1;let d=a.angle,x=o.pt2px(f)-u[0]*(.5+y),C=o.pt2px(h)-u[1]*(.5+p),S=x+u[0],M=C+u[1];if(d){g&&(d=-d);const e=Math.sin(d*Math.PI/180),t=Math.cos(d*Math.PI/180),r=x*t-C*e,i=x*e+C*t,n=x*t-M*e,o=x*e+M*t,a=S*t-M*e,s=S*e+M*t,l=S*t-C*e,c=S*e+C*t;x=Math.min(r,n,a,l),C=Math.min(i,o,s,c),S=Math.max(r,n,a,l),M=Math.max(i,o,s,c)}i=x<i?x:i,n=C<n?C:n,s=S>s?S:s,l=M>l?M:l;const v=r.createImageData(m.size[0],m.size[1]);v.data.set(new Uint8ClampedArray(m.image.buffer));const b={offsetX:f,offsetY:h,rotateClockwise:g,angle:d,rasterizedImage:v,anchorX:y,anchorY:p};c.push(b)}t.width=s-i,t.height=l-n;const m=-i,u=l;for(let e=0;e<c.length;e++){const t=c[e],i=this._imageDataToCanvas(t.rasterizedImage),n=t.rasterizedImage.width,a=t.rasterizedImage.height,s=m-n*(.5+t.anchorX),l=u-a*(.5-t.anchorY);if(t.angle){const e=(360-t.angle)*Math.PI/180;r.save(),r.translate(o.pt2px(t.offsetX),-o.pt2px(t.offsetY)),r.translate(m,u),r.rotate(e),r.translate(-m,-u),r.drawImage(i,s,l),r.restore()}else r.drawImage(i,s+o.pt2px(t.offsetX),l-o.pt2px(t.offsetY))}const f=new a.default({x:m/t.width-.5,y:u/t.height-.5});return{imageData:0!==t.width&&0!==t.height?r.getImageData(0,0,t.width,t.height):r.createImageData(1,1),anchorPosition:f}},h._imageDataToCanvas=function(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,r=t.getContext("2d");return t.width=e.width,t.height=e.height,r.putImageData(e,0,0),t},h._imageTo32Array=function(e,t,r){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const i=this._imageDataCanvas,n=i.getContext("2d");return i.width=t,i.height=r,n.drawImage(e,0,0,t,r),new Uint32Array(n.getImageData(0,0,t,r).data.buffer)},h._getRasterizedResource=function(t,i,n,o,a,s){let m,u,f,h;if("esriGeometryPolyline"===n||"esriGeometryPolygon"===n){const c=o&&o.style?o.style:e.GeometryStyle.Legend,h="esriGeometryPolyline"===n?p.stroke[c]:p.fill[c];if("line"===t.type){if("CIMSolidStroke"!==t.cim.type){if("CIMPictureStroke"===t.cim.type){const e=l.evaluateValueOrFunction(t.width,i,a,s);let r,n,o;return({image:r,width:n,height:o}=this._getPictureResource(t,e)),this._rasterizePictureResource(t,r,n,o,h,e)}return null}({analyzedCIM:m,hash:f}=d(t,i,a,s)),u=this._embedCIMLayerInVectorMarker(m,h)}else if("marker"===t.type){if("CIMPictureMarker"===t.cim.type)return null;if("CIMVectorMarker"!==t.cim.type)return null;t.cim.offsetX=l.evaluateValueOrFunction(t.offsetX,i,a,s),t.cim.offsetY=l.evaluateValueOrFunction(t.offsetY,i,a,s),t.cim.rotation=l.evaluateValueOrFunction(t.rotation,i,a,s),t.cim.markerPlacement=t.markerPlacement,({analyzedCIM:m}=d(t,i,a,s)),f=r.numericHash(JSON.stringify(m)).toString(),u=this._embedCIMLayerInVectorMarker(m,h)}else{if("text"===t.type)return null;if("fill"===t.type){if("CIMHatchFill"===t.cim.type||"CIMVectorMarker"===t.cim.type||"CIMPictureMarker"===t.cim.type||"CIMPictureFill"===t.cim.type){const e=t.cim.size||t.cim.height;let r,n,o;if("CIMPictureMarker"===t.cim.type||"CIMPictureFill"===t.cim.type)({image:r,width:n,height:o}=this._getPictureResource(t,e));else{({analyzedCIM:m,hash:f}=d(t,i,a,s));const e=this._rasterizer.rasterizeJSONResource(m,1,this._avoidSDF);r=e.image,n=e.size[0],o=e.size[1]}return this._rasterizePictureResource(t,r,n,o,h,null)}if("CIMSolidFill"!==t.cim.type)return null;({analyzedCIM:m,hash:f}=d(t,i,a,s)),u=this._embedCIMLayerInVectorMarker(m,h)}}}else{if("text"===t.type)return h=this._rasterizeTextResource(t,i,o,a,s),h;({analyzedCIM:m,hash:f}=d(t,i,a,s));const e=y(o,t,null);if("CIMPictureMarker"===t.cim.type){const r=l.evaluateValueOrFunction(t.size,i,a,s)*e,{image:n,width:o,height:c}=this._getPictureResource(t,r);return h={image:n,size:[o,c],sdf:!1,simplePattern:!1,anchorX:t.anchorPoint?t.anchorPoint.x:0,anchorY:t.anchorPoint?t.anchorPoint.y:0},h}c.scaleCIMMarker(m,e,{preserveOutlineWidth:!1}),u=m}f+=n,o&&(f+=JSON.stringify(o));const g=this._resourceCache;return g.has(f)?g.get(f):(h=this._rasterizer.rasterizeJSONResource(u,window.devicePixelRatio||1,this._avoidSDF),g.set(f,h),h)},h._rasterizeTextResource=function(e,t,r,i,n){const o=y(r,e,null),a=l.evaluateValueOrFunction(e.text,t,i,n);if(!a||0===a.length)return null;const s=l.evaluateValueOrFunction(e.fontName,t,i,n),c=l.evaluateValueOrFunction(e.style,t,i,n),m=l.evaluateValueOrFunction(e.weight,t,i,n),u=l.evaluateValueOrFunction(e.decoration,t,i,n),f=l.evaluateValueOrFunction(e.size,t,i,n)*o,h=l.evaluateValueOrFunction(e.horizontalAlignment,t,i,n),p=l.evaluateValueOrFunction(e.verticalAlignment,t,i,n),g=l.colorToArray(l.evaluateValueOrFunction(e.color,t,i,n)),d=l.colorToArray(l.evaluateValueOrFunction(e.outlineColor,t,i,n)),x={color:g,size:f,horizontalAlignment:h,verticalAlignment:p,font:{family:s,style:c,weight:m,decoration:u},halo:{size:l.evaluateValueOrFunction(e.outlineSize,t,i,n)||0,color:d,style:c},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(a,x)},h._rasterizePictureResource=function(e,t,r,i,a,s){const l=document.createElement("canvas"),c=l.getContext("2d");l.height=o.pt2px(Math.max(Math.abs(a.frame.ymax-a.frame.ymin),s)),l.width=o.pt2px(Math.abs(a.frame.xmax-a.frame.xmin));const m=c.createImageData(r,i);m.data.set(new Uint8ClampedArray(t.buffer));const u=this._imageDataToCanvas(m),f=c.createPattern(u,"repeat"),h=Math.cos((-e.cim.rotation||0)*Math.PI/180),y=Math.sin((-e.cim.rotation||0)*Math.PI/180);f.setTransform({m11:h,m12:y,m21:-y,m22:h,m41:o.pt2px(e.cim.offsetX)||0,m42:o.pt2px(e.cim.offsetY)||0});const p=a.canvasPaths;let g,d,x;n.isPolygon(p)?(g=p.rings,c.fillStyle=f,d=c.fill,x=["evenodd"]):n.isPolyline(p)&&(g=p.paths,c.strokeStyle=f,c.lineWidth=s,d=c.stroke,g[0][0][1]=l.height/2,g[0][1][1]=l.height/2),c.beginPath();for(const e of g){const t=e?e.length:0;if(t>1){let r=e[0];c.moveTo(o.pt2px(r[0]),o.pt2px(r[1]));for(let i=1;i<t;++i)r=e[i],c.lineTo(o.pt2px(r[0]),o.pt2px(r[1]));c.closePath()}}d.apply(c,x);const C=c.getImageData(0,0,l.width,l.height),S=new Uint8Array(C.data);return{size:[l.width,l.height],image:new Uint32Array(S.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}},h._getPictureResource=function(e,t){const r=this._pictureMarkerCache.get(e.materialHash);if(!r)return null;const i=r.height/r.width,n=t?i>1?o.pt2px(t):o.pt2px(t)/i:r.width,a=t?i>1?o.pt2px(t)*i:o.pt2px(t):r.height;return{image:this._imageTo32Array(r,n,a),width:n,height:a}},h._embedCIMLayerInVectorMarker=function(e,t){const r=n.isPolygon(t.geometry)?"CIMPolygonSymbol":"CIMLineSymbol";return{type:"CIMVectorMarker",frame:t.frame,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t.geometry,symbol:{type:r,symbolLayers:[e]}}]}},t}();function d(e,t,r,i){let n,o;return"function"==typeof e.materialHash?(n=(0,e.materialHash)(t,r,i),o=m.analyzeCIMResource(e.cim,e.materialOverrides)):(n=e.materialHash,o=e.cim),{analyzedCIM:o,hash:n}}t.CIMSymbolRasterizer=g,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=n)},58323:(e,t,r)=>{var i,n;i=[r(80476),r(29282),r(51361),r(29305)],void 0===(n=function(e,t,r,i){"use strict";return function(){function n(){}var o=n.prototype;return o.dispose=function(){this._rasterizationCanvas=null},o.rasterizeJSONResource=function(e,n,o){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){const[t,i,o]=r.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,e.style,n);return{size:[i,o],image:new Uint32Array(t.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===e.type||"esriSLS"===e.type){const[t,i,n]=r.SymbolHelper.rasterizeSimpleLine(e.style,e.cap);return{size:[i,n],image:new Uint32Array(t.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,s,l;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(a=r.CIMSymbolHelper.fromSimpleMarker(e),l=i.getSDFInfo(a)):"CIMHatchFill"===e.type?(a=r.CIMSymbolHelper.fromCIMHatchFill(e),s=new t(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):e.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type?(a=r.CIMSymbolHelper.fromCIMInsidePolygon(e),s=new t(a.frame.xmin,-a.frame.ymax,a.frame.xmax-a.frame.xmin,a.frame.ymax-a.frame.ymin)):(a=e,l=i.getSDFInfo(a)),l&&!o){const[e,t,r]=i.buildSDF(l);return e?{size:[t,r],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[c,m,u,f,h]=r.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,s,!o);return c?{size:[m,u],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:f,anchorY:h}:null},o.rasterizeImageResource=function(t,r,i,n){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=t,this._rasterizationCanvas.height=r;const o=this._rasterizationCanvas.getContext("2d");i instanceof ImageData?o.putImageData(i,0,0):(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${r}px`),o.drawImage(i,0,0,t,r));const a=o.getImageData(0,0,t,r),s=new Uint8Array(a.data);if(n)for(const e of n)if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){const[t,r,i,n]=e.oldColor,[o,a,l,c]=e.newColor;if(t===o&&r===a&&i===l&&n===c)continue;for(let e=0;e<s.length;e+=4)t===s[e]&&r===s[e+1]&&i===s[e+2]&&n===s[e+3]&&(s[e]=o,s[e+1]=a,s[e+2]=l,s[e+3]=c)}let l;for(let e=0;e<s.length;e+=4)l=s[e+3]/255,s[e]=s[e]*l,s[e+1]=s[e+1]*l,s[e+2]=s[e+2]*l;let c=s,m=t,u=r;const f=512;if(m>=f||u>=f){const i=m/u;i>1?(m=f,u=Math.round(f/i)):(u=f,m=Math.round(f*i)),c=new Uint8Array(4*m*u);const n=new Uint8ClampedArray(c.buffer);e.resampleHermite(s,t,r,n,m,u,!1)}return{size:[t,r],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}},n}()}.apply(t,i))||(e.exports=n)},29305:(e,t,r)=>{var i,n;i=[t,r(57167),r(29282),r(58597)],void 0===(n=function(e,r,i,n){"use strict";function o(e){let t=1/0,r=-1/0,i=1/0,n=-1/0;for(const o of e)for(const e of o)e[0]<t&&(t=e[0]),e[0]>r&&(r=e[0]),e[1]<i&&(i=e[1]),e[1]>n&&(n=e[1]);return[t,i,r,n]}function a(e,t){const r=2*t,i=e.length,o=new Uint8Array(4*i);for(let t=0;t<i;++t){const i=.5-e[t]/r;n.packFloatRGBA(i,o,4*t)}return o}t.buildSDF=function(e){const t=(r=e.geom)?r.rings?r.rings:r.paths?r.paths:void 0!==r.xmin&&void 0!==r.ymin&&void 0!==r.xmax&&void 0!==r.ymax?[[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]:null:null;var r;const n=function(e){let t=1/0,r=-1/0,n=1/0,o=-1/0;for(const i of e)for(const e of i)e[0]<t&&(t=e[0]),e[0]>r&&(r=e[0]),e[1]<n&&(n=e[1]),e[1]>o&&(o=e[1]);return new i(t,n,r-t,o-n)}(t),o=Math.floor(31.5),s=(128-2*(o+1))/Math.max(n.width,n.height),l=Math.round(n.width*s)+2*o,c=Math.round(n.height*s)+2*o,m=[];for(const r of t)if(r&&r.length>1){const t=[];for(const e of r){let[r,i]=e;r-=n.x,i-=n.y,r*=s,i*=s,r+=o-.5,i+=o-.5,t.push([r,i])}if(e.asFill){const e=t.length-1;t[0][0]===t[e][0]&&t[0][1]===t[e][1]||t.push(t[0])}m.push(t)}const u=function(e,t,r,i){const n=t*r,o=new Array(n),a=i*i+1;for(let e=0;e<n;++e)o[e]=a;for(const n of e){const e=n.length;for(let a=1;a<e;++a){const e=n[a-1],s=n[a];let l,c,m,u;e[0]<s[0]?(l=e[0],c=s[0]):(l=s[0],c=e[0]),e[1]<s[1]?(m=e[1],u=s[1]):(m=s[1],u=e[1]);let f=Math.floor(l)-i,h=Math.floor(c)+i,y=Math.floor(m)-i,p=Math.floor(u)+i;f<0&&(f=0),h>t&&(h=t),y<0&&(y=0),p>r&&(p=r);const g=s[0]-e[0],d=s[1]-e[1],x=g*g+d*d;for(let i=f;i<h;i++)for(let n=y;n<p;n++){let a,l,c=(i-e[0])*g+(n-e[1])*d;c<0?(a=e[0],l=e[1]):c>x?(a=s[0],l=s[1]):(c/=x,a=e[0]+c*g,l=e[1]+c*d);const m=(i-a)*(i-a)+(n-l)*(n-l),u=(r-n-1)*t+i;m<o[u]&&(o[u]=m)}}}for(let e=0;e<n;++e)o[e]=Math.sqrt(o[e]);return o}(m,l,c,o);return e.asFill&&function(e,t,r,i,n){for(const o of e){const e=o.length;for(let a=1;a<e;++a){const e=o[a-1],s=o[a];let l,c,m,u;e[0]<s[0]?(l=e[0],c=s[0]):(l=s[0],c=e[0]),e[1]<s[1]?(m=e[1],u=s[1]):(m=s[1],u=e[1]);let f=Math.floor(l),h=Math.floor(c)+1,y=Math.floor(m),p=Math.floor(u)+1;f<i&&(f=i),h>t-i&&(h=t-i),y<i&&(y=i),p>r-i&&(p=r-i);for(let o=y;o<p;++o){if(e[1]>o==s[1]>o)continue;const a=(r-o-1)*t;for(let t=f;t<h;++t)t<(s[0]-e[0])*(o-e[1])/(s[1]-e[1])+e[0]&&(n[a+t]=-n[a+t]);for(let e=i;e<f;++e)n[a+e]=-n[a+e]}}}}(m,l,c,o,u),[a(u,o),l,c]},t.getExtent=function(e){return e?e.rings?o(e.rings):e.paths?o(e.paths):r.isExtent(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null},t.getSDFInfo=function e(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":{const r=t.symbolLayers;return r&&1===r.length?e(r[0]):null}case"CIMVectorMarker":{const e=t.markerGraphics;if(!e||1!==e.length)return null;const r=e[0];if(!r)return null;const i=r.geometry;if(!i)return null;const n=r.symbol;return!n||"CIMPolygonSymbol"!==n.type&&"CIMLineSymbol"!==n.type?null:{geom:i,asFill:"CIMPolygonSymbol"===n.type}}case"sdf":return{geom:t.geom,asFill:t.asFill}}return null},t.getSDFMetrics=function(e,t,r,i,n){const[o,a,s,l]=e;if(s<o||l<a)return[0,0,0];const c=s-o,m=l-a,u=Math.floor(31.5),f=(128-2*(u+1))/Math.max(c,m),h=Math.round(c*f)+2*u,y=Math.round(m*f)+2*u;let p=1;t&&(p=y/f/(t.ymax-t.ymin));let g=0,d=0;if(i)if(n){if(t&&r&&t.ymax-t.ymin>0){const e=(t.xmax-t.xmin)/(t.ymax-t.ymin);g=i.x/(r*e),d=i.y/r}}else g=i.x,d=i.y;return g=.5*(t.xmax+t.xmin)+g*(t.xmax-t.xmin),d=.5*(t.ymax+t.ymin)+d*(t.ymax-t.ymin),g-=o,d-=a,g*=f,d*=f,g+=u,d+=u,[p,g/h-.5,-(d/y-.5)]},t.getSDFSymbol=function(e){const t=e.markerGraphics;if(!t||1!==t.length)return null;const r=t[0];if(!r)return null;const i=r.symbol;return!i||"CIMPolygonSymbol"!==i.type&&"CIMLineSymbol"!==i.type?null:i},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=n)},22355:(e,t,r)=>{var i,n;i=[t,r(90920)],void 0===(n=function(e,r){"use strict";let i=function(){function e(){}var t=e.prototype;return t.rasterizeText=function(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const r=this._textRasterizationCanvas,i=r.getContext("2d");this.setFontProperties(i,t),this.parameters=t,this.textLines=e.split(/\r?\n/),this.lineHeight=this.computeLineHeight();const n=this.computeTextWidth(i,t),o=this.lineHeight*this.textLines.length;var a;r.width=n,r.height=o,this.renderedLineHeight=Math.round(this.lineHeight*t.pixelRatio),this.renderedHaloSize=t.halo.size*t.pixelRatio,this.renderedWidth=n*t.pixelRatio,this.renderedHeight=o*t.pixelRatio,this.fillStyle=`rgba(${(a=t.color).slice(0,3).toString()},${a[3]})`,this.haloStyle=function(e){return`rgb(${e.slice(0,3).toString()})`}(t.halo.color);const s=this.renderedLineHeight,l=this.renderedHaloSize;this.setFontProperties(i,t);const c=function(e,t){return"center"===e?.5*t:"right"===e?t:0}(i.textAlign,this.renderedWidth)+l,m=l;let u=0,f=0;l>0&&this.renderHalo(i,c,m,u,f,t),f+=m,u+=c;for(const e of this.textLines)i.globalCompositeOperation="destination-out",i.fillStyle="rgb(0, 0, 0)",i.fillText(e,u,f),i.globalCompositeOperation="source-over",i.fillStyle=this.fillStyle,i.fillText(e,u,f),f+=s;const h=i.getImageData(0,0,this.renderedWidth,this.renderedHeight),y=new Uint8Array(h.data);if(t.premultiplyColors){let e;for(let t=0;t<y.length;t+=4)e=y[t+3]/255,y[t]=y[t]*e,y[t+1]=y[t+1]*e,y[t+2]=y[t+2]*e}return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(y.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}},t.renderHalo=function(e,t,r,i,n,o){const a=this.renderedWidth,s=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=a,this._haloRasterizationCanvas.height=s;const l=this._haloRasterizationCanvas,c=l.getContext("2d");c.clearRect(0,0,a,s),this.setFontProperties(c,o),c.fillStyle=this.haloStyle,c.strokeStyle=this.haloStyle;const m=this.renderedHaloSize<3;c.lineJoin=m?"miter":"round",m?this.renderHaloEmulated(c,t,r):this.renderHaloNative(c,t,r),e.globalAlpha=this.parameters.halo.color[3],e.drawImage(l,0,0,a,s,i,n,a,s),e.globalAlpha=1},t.renderHaloEmulated=function(e,t,r){const i=this.renderedLineHeight,o=this.renderedHaloSize;for(const a of this.textLines){for(const[i,s]of n)e.fillText(a,t+o*i,r+o*s);r+=i}},t.renderHaloNative=function(e,t,r){const i=this.renderedLineHeight,n=this.renderedHaloSize;for(const o of this.textLines){const a=2*n,s=5,l=.1;for(let i=0;i<s;i++){const n=1-(s-1)*l+i*l;e.lineWidth=n*a,e.strokeText(o,t,r)}r+=i}},t.setFontProperties=function(e,t){const i=t.font,n=`${i.style} ${i.weight} ${r.pt2px(t.size*t.pixelRatio)}px ${i.family}, sans-serif`;let o;switch(e.font=n,e.textBaseline="top",t.horizontalAlignment){case"left":o="left";break;case"right":o="right";break;case"center":o="center";break;default:o="left"}e.textAlign=o},t.computeTextWidth=function(e,t){let r=0;for(const t of this.textLines)r=Math.max(r,e.measureText(t).width);const i=t.font;return("italic"===i.style||"oblique"===i.style||"string"==typeof i.weight&&("bold"===i.weight||"bolder"===i.weight)||"number"==typeof i.weight&&i.weight>600)&&(r+=.3*e.measureText("A").width),r+=2*this.parameters.halo.size,Math.round(r)},t.computeLineHeight=function(){const e=1.275*this.parameters.size;return Math.round(e+2*this.parameters.halo.size)},e}();const n=[];{const e=16;for(let t=0;t<360;t+=360/e)n.push([Math.cos(Math.PI*t/180),Math.sin(Math.PI*t/180)])}t.TextRasterizer=i,t.default=i,Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=n)},30453:(e,t,r)=>{var i,n;i=[t,r(73227),r(73462),r(9720),r(27006),r(46674),r(90920),r(80476),r(53391),r(51361),r(29305)],void 0===(n=function(e,r,i,n,o,a,s,l,c,m,u){"use strict";const f=i.getLogger("esri.symbols.cim.cimAnalyzer");function h(e){switch(e){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function y(e){switch(e){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function p(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function g(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function d(e,t,r,i){let n;e[t]?n=e[t]:(n={},e[t]=n),n[r]=i}function x(e){const t=e.markerPlacement;return t&&t.angleToLine?1:0}function C(e,t,i,n,o){const a=e.primitiveName,s=l.fromCIMColor(e.color),c=r.numericHash(JSON.stringify(e)).toString();o.push({type:"fill",templateHash:c,materialHash:0===i.length?c:()=>c,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:L(a,t,"Color",n,s,_),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e.effects})}function S(e,t,i,n,o){const a=e.primitiveName,s=e.tintColor?l.fromCIMColor(e.tintColor):{r:255,g:255,b:255,a:1},c=r.numericHash(JSON.stringify(e)).toString(),m=r.numericHash(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();o.push({type:"fill",templateHash:c,materialHash:0===i.length?m:()=>m,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:L(a,t,"TintColor",n,s,_),height:L(a,t,"Height",n,e.height),scaleX:L(a,t,"ScaleX",n,e.scaleX),angle:L(a,t,"Rotation",n,e.rotation),offsetX:L(a,t,"OffsetX",n,e.offsetX),offsetY:L(a,t,"OffsetY",n,e.offsetY)})}function M(e,t,i,n,o){const a=["Rotation","OffsetX","OffsetY"],s=i.filter((t=>t.primitiveName!==e.primitiveName&&-1===a.indexOf(t.propertyName))),l=e.primitiveName,c=r.numericHash(JSON.stringify(e)).toString(),m=r.numericHash(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();o.push({type:"fill",templateHash:c,materialHash:0===i.length?m:R(m,t,s,n),cim:e,materialOverrides:s,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:L(l,t,"Separation",n,e.separation),scaleX:1,angle:L(l,t,"Rotation",n,e.rotation),offsetX:L(l,t,"OffsetX",n,e.offsetX),offsetY:L(l,t,"OffsetY",n,e.offsetY)})}function v(e,t,i,n,o){const a=r.numericHash(JSON.stringify(e)).toString();o.push({type:"fill",templateHash:a,materialHash:0===i.length?a:R(a,t,i,n),cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function b(e,t,i,n,o,a,s){const c=r.numericHash(JSON.stringify(e)).toString(),m=e.primitiveName,u=l.fromCIMColor(e.color),f=void 0!==e.width?e.width:4,p=h(e.capStyle),g=y(e.joinStyle),d=e.miterLimit;o.push({type:"line",templateHash:c,materialHash:0===i.length?c:()=>c,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:L(m,t,"Color",n,u,_),width:L(m,t,"Width",n,f),cap:L(m,t,"CapStyle",n,p),join:L(m,t,"JoinStyle",n,g),miterLimit:L(m,t,"MiterLimit",n,d),referenceWidth:s,zOrder:F(e.name),isDashed:!1})}function I(e,t,i,n,o,a,s){const c=r.numericHash(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),m=e.primitiveName,u=l.fromCIMColor(e.tintColor),f=void 0!==e.width?e.width:4,p=h(e.capStyle),g=y(e.joinStyle),d=e.miterLimit,x=r.numericHash(JSON.stringify(e)).toString();o.push({type:"line",templateHash:x,materialHash:0===i.length?c:()=>c,cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:L(m,t,"TintColor",n,u,_),width:L(m,t,"Width",n,f),cap:L(m,t,"CapStyle",n,p),join:L(m,t,"JoinStyle",n,g),miterLimit:L(m,t,"MiterLimit",n,d),referenceWidth:s,zOrder:F(e.name),isDashed:!1})}function z(e,t,i,n,o,a,s){const l=e.primitiveName,c=void 0!==e.width?e.width:4,m=h(e.capStyle),u=y(e.joinStyle),f=e.miterLimit,p=r.numericHash(JSON.stringify(e)).toString();o.push({type:"line",templateHash:p,materialHash:0===i.length?p:R(p,t,i,n),cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},width:L(l,t,"Width",n,c),cap:L(l,t,"CapStyle",n,m),join:L(l,t,"JoinStyle",n,u),miterLimit:L(l,t,"MiterLimit",n,f),referenceWidth:s,zOrder:F(e.name),isDashed:!1})}function P(e,t,i,n,o){const a=e.markerPlacement;if(!a||"CIMMarkerPlacementInsidePolygon"!==a.type)return!1;const s=a,l=["Rotation","OffsetX","OffsetY"],c=i.filter((t=>t.primitiveName!==e.primitiveName&&-1===l.indexOf(t.propertyName))),m=r.numericHash(JSON.stringify(e)).toString();return o.push({type:"fill",templateHash:m,materialHash:0===i.length?m:R(m,t,c,n),cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:L(s.primitiveName,t,"StepY",n,s.stepY),scaleX:1,angle:L(s.primitiveName,t,"GridAngle",n,s.gridAngle),offsetX:L(s.primitiveName,t,"OffsetX",n,s.offsetX),offsetY:L(s.primitiveName,t,"OffsetY",n,s.offsetY)}),!0}function k(e,t,i,n,o,a,s){const c=e.primitiveName,m=e.size,u=e.scaleX,f=e.rotation,h=e.offsetX,y=e.offsetY,p=l.fromCIMColor(e.tintColor),g=r.numericHash(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();let d=!1,x="";for(const e of i)e.primitiveName===c&&(void 0!==e.value?x+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(d=!0));o.push({type:"marker",templateHash:r.numericHash(JSON.stringify(e)+x).toString(),materialHash:d?()=>g:g,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:!1,alignment:a,size:L(c,t,"Size",n,m),scaleX:L(c,t,"ScaleX",n,u),rotation:L(c,t,"Rotation",n,f),offsetX:L(c,t,"OffsetX",n,h),offsetY:L(c,t,"OffsetY",n,y),color:L(c,t,"TintColor",n,p,_),anchorPoint:e.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:s,sizeRatio:1,markerPlacement:e.markerPlacement})}function w(e,t,r,i,n,o,a,s){const l=e.markerGraphics;if(!l)return;let c=0;if(e.scaleSymbolsProportionally){const t=e.frame;t&&(c=t.ymax-t.ymin)}for(const m of l)if(m){const l=m.symbol;if(!l)continue;switch(l.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":N(e,m,r,t,i,n,o,a,c,s);break;case"CIMTextSymbol":O(e,m,t,r,i,n,o,a,c)}}}function O(e,t,i,n,o,a,s,c,u){m.OverrideHelper.findApplicableOverrides(t,n,[]);const f=t.geometry;if(!("x"in f)||!("y"in f))return;const h=t.symbol,y=(d=h).underline?"underline":d.strikethrough?"line-through":"none";var d;const x=function(e){let t="normal",r="normal";if(e){const i=e.toLowerCase();-1!==i.indexOf("italic")?t="italic":-1!==i.indexOf("oblique")&&(t="oblique"),-1!==i.indexOf("bold")?r="bold":-1!==i.indexOf("light")&&(r="lighter")}return{style:t,weight:r}}(h.fontStyleName);h.font={family:h.fontFamilyName,decoration:y,...x};const C=e.frame,S=f.x-.5*(C.xmin+C.xmax),M=f.y-.5*(C.ymin+C.ymax),v=e.size/u,b=e.primitiveName,I=(h.height||0)*v,z=h.angle||0,P=((h.offsetX||0)+S)*v,k=((h.offsetY||0)+M)*v,w=l.fromCIMColor(m.CIMSymbolHelper.getFillColor(h));let O=l.fromCIMColor(m.CIMSymbolHelper.getStrokeColor(h)),N=m.CIMSymbolHelper.getStrokeWidth(h);N||(O=l.fromCIMColor(m.CIMSymbolHelper.getFillColor(h.haloSymbol)),N=h.haloSize*v);let H="";for(const e of n)e.primitiveName===b&&void 0!==e.value&&(H+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`);const F=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),_=r.numericHash(JSON.stringify(t)+F+H).toString();a.push({type:"text",templateHash:_,materialHash:()=>r.numericHash(JSON.stringify(h.font)).toString(),cim:h,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,alignment:s,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:h.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:L(b,i,"Size",o,I),angle:L(b,i,"Rotation",o,z),offsetX:L(b,i,"OffsetX",o,P),offsetY:L(b,i,"OffsetY",o,k),horizontalAlignment:p(h.horizontalAlignment),verticalAlignment:g(h.verticalAlignment),text:L(t.primitiveName,i,"TextString",o,t.textString,l._adjustTextCase,h.textCase),color:w,outlineColor:O,outlineSize:N,referenceSize:c,sizeRatio:1,markerPlacement:e.markerPlacement})}function N(e,t,i,n,o,a,s,c,f,h){const y=t.symbol,p=t.geometry;if(!p)return;const g=y.symbolLayers;if(!g)return;if(h)return void H(e,t,n,i,o,a,s,c,f);let d=g.length;for(;d--;){const h=g[d];if(h&&!1!==h.enable)switch(h.type){case"CIMSolidFill":case"CIMSolidStroke":{const y=u.getExtent(p);if(!y)continue;const[g,d,x]=u.getSDFMetrics(y,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),C="CIMSolidFill"===h.type,S={type:"sdf",geom:p,asFill:C},M=e.primitiveName,v=e.size,b=e.rotation||0,I=e.offsetX,z=e.offsetY,P=h.primitiveName,k=C?l.fromCIMColor(m.CIMSymbolHelper.getFillColor(h)):l.fromCIMColor(m.CIMSymbolHelper.getStrokeColor(h)),w=C?{r:0,g:0,b:0,a:0}:l.fromCIMColor(m.CIMSymbolHelper.getStrokeColor(h)),O=m.CIMSymbolHelper.getStrokeWidth(h);if(!C&&!O)break;let N=!1,H="";for(const e of i)e.primitiveName!==P&&e.primitiveName!==M||(void 0!==e.value?H+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(N=!0));const F=JSON.stringify({...e,markerGraphics:null}),R=r.numericHash(JSON.stringify(S)).toString(),A={type:"marker",templateHash:r.numericHash(JSON.stringify(t)+JSON.stringify(h)+F+H).toString(),materialHash:N?()=>R:R,cim:S,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:s,anchorPoint:{x:d,y:x},isAbsoluteAnchorPoint:!1,size:L(e.primitiveName,n,"Size",o,v),rotation:L(e.primitiveName,n,"Rotation",o,b),offsetX:L(e.primitiveName,n,"OffsetX",o,I),offsetY:L(e.primitiveName,n,"OffsetY",o,z),scaleX:1,frameHeight:f,rotateClockwise:e.rotateClockwise,referenceSize:c,sizeRatio:g,color:L(P,n,"Color",o,k,_),outlineColor:L(P,n,"Color",o,w,_),outlineWidth:L(P,n,"Width",o,O),markerPlacement:e.markerPlacement};a.push(A);break}default:H(e,t,n,i,o,a,s,c,f)}}}function H(e,t,i,n,o,a,l,c,u){const f=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath,effects:e.effects}}(e,t);let h=[];const y=["Rotation","OffsetX","OffsetY"];h=n.filter((t=>t.primitiveName!==e.primitiveName||-1===y.indexOf(t.propertyName)));let p="";for(const e of n)void 0!==e.value&&(p+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`);const[g,d,x]=m.CIMSymbolHelper.getTextureAnchor(f),C=e.primitiveName,S=e.rotation||0,M=e.offsetX||0,v=e.offsetY||0,b=r.numericHash(JSON.stringify(f)+p).toString(),I={type:"marker",templateHash:b,materialHash:0===h.length?b:R(b,i,h,o),cim:f,materialOverrides:h,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:g,y:d},isAbsoluteAnchorPoint:!1,size:e.size,rotation:L(C,i,"Rotation",o,S),offsetX:L(C,i,"OffsetX",o,M),offsetY:L(C,i,"OffsetY",o,v),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:u,rotateClockwise:e.rotateClockwise,referenceSize:c,sizeRatio:x/s.pt2px(e.size),markerPlacement:e.markerPlacement};a.push(I)}function F(e){if(e&&0===e.indexOf("Level_")){const t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function _(e){if(!e||0===e.length)return null;const t=new a(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function L(e,t,r,i,n,a,s){const l=t[e];if(l){const e=l[r];if("string"==typeof e||"number"==typeof e||e instanceof Array)return a?a.call(null,e,s):e;if(null!=e&&e instanceof o.ArcadeExpression)return(t,r,o)=>{let l=c(e,t,{$view:o},i.geometryType,r);return null!==l&&a&&(l=a.call(null,l,s)),null!==l?l:n}}return n}function R(e,t,i,n){for(const e of i)if(e.valueExpressionInfo){const r=t[e.primitiveName]&&t[e.primitiveName][e.propertyName];r instanceof o.ArcadeExpression&&(e.fn=(e,t,i)=>c(r,e,{$view:i},n.geometryType,t))}return(t,n,o)=>{for(const e of i)e.fn&&(e.value=e.fn(t,n,o));return r.numericHash(e+m.OverrideHelper.buildOverrideKey(i)).toString()}}t.analyzeCIMResource=function(e,t){if(!t||0===t.length)return e;const r=JSON.parse(JSON.stringify(e));return m.OverrideHelper.applyOverrides(r,t),r},t.analyzeCIMSymbol=async function(e,t,r,i){const a=r||[];if(!e)return a;let s,l;const c={};if("CIMSymbolReference"!==e.type)return f.error("Expect cim type to be 'CIMSymbolReference'"),a;if(s=e.symbol,l=e.primitiveOverrides,l){const e=[];for(const r of l){const i=r.valueExpressionInfo;if(i&&t){const n=i.expression,a=o.createRendererExpression(n,t.spatialReference,t.fields).then((e=>{e&&d(c,r.primitiveName,r.propertyName,e)}));e.push(a)}else null!=r.value&&d(c,r.primitiveName,r.propertyName,r.value)}await n.all(e)}switch(s.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(e,t,r,i,n,o){if(!e)return;const a=e.symbolLayers;if(!a)return;let s;const l=m.CIMSymbolHelper.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(s=1);let c=a.length;for(;c--;){const u=a[c];if(!u||!1===u.enable)continue;const h=[];switch(m.OverrideHelper.findApplicableOverrides(u,t,h),u.type){case"CIMSolidFill":C(u,r,h,i,n);break;case"CIMPictureFill":S(u,r,h,i,n);break;case"CIMHatchFill":M(u,r,h,i,n);break;case"CIMGradientFill":v(u,r,h,i,n);break;case"CIMSolidStroke":b(u,r,h,i,n,"CIMPolygonSymbol"===e.type,l);break;case"CIMPictureStroke":I(u,r,h,i,n,"CIMPolygonSymbol"===e.type,l);break;case"CIMGradientStroke":z(u,r,h,i,n,"CIMPolygonSymbol"===e.type,l);break;case"CIMCharacterMarker":if(P(u,r,h,i,n))break;break;case"CIMPictureMarker":if(P(u,r,h,i,n))break;"CIMLineSymbol"===e.type&&(s=x(u)),k(u,r,h,i,n,s,l);break;case"CIMVectorMarker":if(P(u,r,h,i,n))break;"CIMLineSymbol"===e.type&&(s=x(u)),w(u,r,h,i,n,s,l,o);break;default:f.error("Cannot analyze CIM layer",u.type)}}}(s,l,c,t,a,i)}return a},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=n)},63115:(e,t,r)=>{var i,n;i=[t,r(90920),r(99141),r(89341)],void 0===(n=function(e,r,i,n){"use strict";const o=new n.CIMSymbolRasterizer(null,!0);t.previewCIMSymbol=async function(e,t={}){const{size:n,maxSize:a,feature:s,fieldMap:l,geometryType:c,style:m,node:u,opacity:f}=t,h=i.getCIMSymbolSize(e),y=Math.min(null!=n?n:h,null!=a?a:r.px2pt(120));y!==h&&(e=e.clone(),i.scaleCIMSymbolTo(e,y,{preserveOutlineWidth:!0}));let p=3;e&&e.data&&e.data.symbol&&"CIMPointSymbol"!==e.data.symbol.type&&(p=1);const g=await o.rasterizeCIMSymbolAsync(e,s,l,c,{scaleFactor:p,style:m}),d=document.createElement("canvas");d.width=g.imageData.width,d.height=g.imageData.height,d.getContext("2d").putImageData(g.imageData,0,0);let x=d.width/p,C=d.height/p;if(null!=n&&(null==(null==t?void 0:t.scale)||(null==t?void 0:t.scale))){const e=x/C;x=e<=1?Math.ceil(y*e):y,C=e<=1?y:Math.ceil(y/e)}const S=new Image(x,C);return S.src=d.toDataURL(),null!=f&&(S.style.opacity=`${f}`),u&&u.appendChild(S),S},Object.defineProperty(e,"__esModule",{value:!0})}.apply(t,i))||(e.exports=n)},53391:(e,t,r)=>{var i,n;i=[r(73462),r(49359),r(5999)],void 0===(n=function(e,t,r){"use strict";const i=new Map;return function(n,o,a,s,l){const c=n.referencesGeometry()&&l?function(n,o,a){const{transform:s,hasZ:l,hasM:c}=a;i.has(o)||i.set(o,function(i){const n={};switch(i){case"esriGeometryPoint":return(e,t,i,o)=>r.unquantizePoint(t,n,e,i,o);case"esriGeometryPolygon":return(e,t,i,o)=>r.unquantizePolygon(t,n,e,i,o);case"esriGeometryPolyline":return(e,t,i,o)=>r.unquantizePolyline(t,n,e,i,o);case"esriGeometryMultipoint":return(e,t,i,o)=>r.unquantizeMultipoint(t,n,e,i,o);default:return e.getLogger("esri.views.2d.support.arcadeOnDemand").error(new t("mapview-arcade",`Unable to handle geometryType: ${i}`)),e=>e}}(o));const m=i.get(o)(n.geometry,s,l,c);return{...n,geometry:m}}(o,s,l):o,m=n.repurposeFeature(c);try{return n.evaluate({...a,$feature:m})}catch(t){return e.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",t),null}}}.apply(t,i))||(e.exports=n)}}]);